
Documentazione CyberTronic 500 

Version: 9.6.46  (.) 

AvvComandi
APButtonCmdVari
APButtonCmdVari
APButtonCmdVari
APButtonCmdVari
APButtonCmdVari
APButtonCmdVari
APButtonCmdVari
APButtonCmdVari
APButtonCmdVari
APButtonCmdVari
APButtonCmdVari
APButtonCmdVari
APButtonCmdVari
APButtonCmdVari
APButtonCmdVari
APButtonCmdVari
APButtonCmdVari
APButtonCmdVari
APButtonCmdVari
APButtonCmdVari
APButtonCmdVari
APButtonCmdVari
APButtonCmdVari
APButtonCmdVari
APButtonCmdVari
APButtonCmdVari
APButtonCmdVari
APButtonCmdVari
APButtonCmdVari
APButtonCmdVari
APButtonCmdVari_Click
AvvComandi
CmdEsci_Click
CmdHelp_Click
Form_Activate
Form_Load
Form_MouseMove
FrameSupp
FrameSupp
FrameSupp
FrameSupp
FrameSupp
FrameSupp
FrameSupp
FrameSupp
FrameSupp
FrameSupp
FrameSupp
FrameSupp
FrameSupp
FrameSupp
FrameSupp
FrameSupp
FrameSupp
FrameSupp
FrameSupp
FrameSupp
FrameSupp
FrameSupp
FrameSupp
FrameSupp
FrameSupp
FrameSupp
FrameSupp
FrameSupp
FrameSupp
FrameSupp
imgPulsanteForm
imgPulsanteForm
imgPulsanteForm_Click
imgPulsanteForm_MouseDown
imgPulsanteForm_MouseMove
imgPulsanteForm_MouseUp
LblCmdVari
LblCmdVari
LblCmdVari
LblCmdVari
LblCmdVari
LblCmdVari
LblCmdVari
LblCmdVari
LblCmdVari
LblCmdVari
LblCmdVari
LblCmdVari
LblCmdVari
LblCmdVari
LblCmdVari
LblCmdVari
LblCmdVari
LblCmdVari
LblCmdVari
LblCmdVari
LblCmdVari
LblCmdVari
LblCmdVari
LblCmdVari
LblCmdVari
LblCmdVari
LblCmdVari
LblCmdVari
LblCmdVari
LblCmdVari
LblTempoRimastoVibrCaricoFApp
LblTempoRimastoVibrCaricoFApp2
LoadImmaginiPulsantePlus
NumeroFrameVisibili
PlusImageList
PosizionaFrameSupp
PulsanteUpd
PulsanteUpdForm
selectedButtonIndex
TopBarButtonEnum
TxtTempoVibrCaricoFApp
TxtTempoVibrCaricoFApp_Change
TxtTempoVibrCaricoFApp2
TxtTempoVibrCaricoFApp2_Change
UpdatePulsantiForm

 AvvMotori 
 BrucAuto 
 BusSytem 
 CodaCircolare 
 Configuration 
 Configurazione 
 ControlliVari 
 ControlloDatiInseriti 
 CP240 
 FormAquablack 
 FormAvvRidotto 
 FormPIDBruc 
 FormProgRiscaldamentiCaldaie 
 FrmCalcolaImpasti 
 FrmCalibBilCamion 
 FrmComandiCisterne 
 FrmGestioneTimer 
 FrmInversionePCL 
 FrmNetti 
 FrmNewValue 
 FrmSchiumatura 
 FrmSiloGenerale 
 FrmSiwarexPara 
 FrmStatoPredosatori 
 FrmTaraBilancePN 
 FrmTestPredosatori 
 GestioneAdditivi 
 GestioneAllarmi 
 GestioneAmperometri 
 GestioneAquablack 
 GestioneBit 
 GestioneBruciatore 
 GestioneCaldaie 
 GestioneCaratteri 
 GestioneCisterneCommon 
 GestioneCisternePLC 
 GestioneCisterneSingole 
 GestioneCodaMateriale 
 GestioneComandiVari 
 GestioneDataBase 
 GestioneDosaggio 
 GestioneFile 
 GestioneFiltro
AbilitaControlloAriaFredda
AbilitaPuliziaFiltro
AbortFillerizzazione
AllarmeDepressioneFiltro
AltaTemperaturaFiltro
AltaTemperaturaFiltro_change
ArrayLettureDepressioneBruciatore
ArrayLettureDepressioneFiltroIN
AttesaFiltrofreddoFlipFlop
AumentoAspirazFiltro
AutomaticoAriaFreddaFiltro
AutomaticoFiltroManiche
AutomaticoModulatoreFumiTamburo
CamereFiltroInPulizia
contatoreFillerizzazione
ConversioneTemperatura
DeltaAriaFredda
DepressioneFiltro
DepressioneFiltro_change
DepressioneFiltroAllarme
DepressioneFiltroIN
DepressioneFiltroIN_change
DepressioneFiltroRegolazione
ErroreLivelloAltoFiller
EsclusioneMessaggioAllarmeTemperaturaBassaFiltro
FiltroInPulizia
FondoscalaDeltaDepressione
GestioneArrestoLivelliTSF
GestioneAspirazioneFiltro
GestioneAspirazioneFiltroInPreventilazione
GestioneFillerizzazione
GestioneLivelliFiltroDMR
Inclusione3LivDMR
IsteresiDepMinFillerizzazione
ManualeAriaFreddaFiltro
ManualeFillerizzazione
ManualeFiltroManiche
ManualeModulAriaFredda
ManualeModulatoreFumiTamburo
ManualeModulFiltro
MinDepressFiltro
ModoFunzFiltro
NormalizzazioneA100
NormalizzazioneA100Dbl
NumeroCamereFiltro
NumeroLetturaDepressioneFiltroIN
NumeroLettureDepressione
PersistAllMaxFiltroLivContinui
PosizioneModulatoreAriaFredda
PosizioneModulatoreAriaFreddaDigitale
PredosaggioArrestoLivelliTSF
PressioneCompressoreFillerizOK
RegolazioneAriaAspiratore_cntr
RegolazioneMinMax
ResettaTimerGestioneFiltro
RitardoSpegnimentoCompressoreF1F2
SelezioneFillerizzazioneF1F2
SetManualeFillerizzazione
SicurezzaTemperaturaFiltro
SiloFillerEstrazione
SiloFillerLivello
SogliaDepMinFillerizzazione
SogliaPartenzaFillerizzazione
Sonda_mA
Sonda_mA_Dbl
SondaDbl_mA
SpeedManualeFillerizzazione
StartManualeFillerizzazione
StartMotoreFillerizzazioneF1F2
StepRegolazioneAspDuranteAccFiltro
StopFillerizzazione
TemperaturaFiltroFreddo
TempoAttesaFiltro
TempoCampAriaFredda
TempoCorrAriaFredda
TempoLavoro1Filtro
TempoLavoro2Filtro
TempoPausaFiltro
TempoRegolazioneAspDuranteAccFiltro
TimeoutArrestoLivelliTSF
TmrArrestoLivelliAltiTSF
ValoreLettoModulatoreAspFiltroNN
ValoreMaxAriaFredda
ValoreMinAriaFredda
ValoreTempLavoroFiltro
ValoreTempMaxFiltro
ValoreTempoOffRegolazioneAspirazioneFiltro
ValoreTempoOnRegolazioneAspirazioneFiltro
ValvolaPreseparatoreAnelloRitorno_change
ValvolaPreseparatoreRitorno_change
VelocitaFillerizzazione
VisualizzaPuliziaFiltro

 GestioneGrafica 
 GestioneHelp 
 GestioneJob 
 GestioneLCPC 
 GestioneLingue 
 GestioneLivelliSiliFillerVaglio 
 GestioneLog 
 GestioneMessaggistica 
 GestioneMotori 
 GestioneOreLavoro 
 GestionePredNastriC 
 GestionePredosatori 
 GestioneRiciclato 
 GestioneSiloGenerale 
 GestioneSiloS7 
 GestioneSiwarex 
 GestioneTrend 
 GestioneViatop 
 ImpastiManuali 
 MD5 
 MessageBox 
 ModPID 
 ModuleShowForm 
 NetWork 
 Parameter 
 ParaTab 
 ParaTabAdd 
 ParaTabAmp 
 ParaTabAquablack 
 ParaTabBruc 
 ParaTabCist 
 ParaTabComandi 
 ParaTabDebug 
 ParaTabDos 
 ParaTabGeneral 
 ParaTabLeg 
 ParaTabMotor 
 ParaTabPred 
 ParaTabSchiumato 
 ParaTabSilo 
 ParaTabTrend 
 ParaTabVarie 
 Registro 
 Security 
 Stampante 
 Stampe 
 XmlJobs 
 XmlManager
Form "AvvComandi"

Public:


Methods:
 Public Sub UpdatePulsantiForm ( )
Private:


Types:
 Private Enum TopBarButtonEnum 
Properties:
 Private NumeroFrameVisibili As Integer
 Private PulsanteUpd ( 0 To ( TopBarButtonEnum. TBB_LAST - 1 ) )
 Private PulsanteUpdForm As Boolean
 Private selectedButtonIndex As Integer 
Methods:
 Private Sub APButtonCmdVari_Click ( Index As Integer )
 Private Sub CmdEsci_Click ( )
 Private Sub CmdHelp_Click ( )
 Private Sub Form_Activate ( )
 Private Sub Form_Load ( )
 Private Sub Form_MouseMove ( Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgPulsanteForm_Click ( Index As Integer )
 Private Sub imgPulsanteForm_MouseDown ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgPulsanteForm_MouseMove ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgPulsanteForm_MouseUp ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub LoadImmaginiPulsantePlus ( Index As Integer,  stato As StatoPulsantePlus )
 Private Sub PosizionaFrameSupp ( )
 Private Sub TxtTempoVibrCaricoFApp_Change ( )
 Private Sub TxtTempoVibrCaricoFApp2_Change ( )
Documentation:

Form "AvvMotori"


Cambio Modalità: nel caso di più coclee rec/presep le rendo cliccabili solo in forcing Public Sub CambioMod(Index As MotorManagementEnum) If (ListaMotori(MotoreCoclea123_2).presente Or ListaMotori(MotoreCoclea123_3).presente Or ListaMotori(MotoreCoclea123_4).presente Or ListaMotori(MotoreCoclea123_5).presente) Then If (ListaMotori(MotoreCocleaPreseparatrice_2).presente Or ListaMotori(MotoreCocleaPreseparatrice_3).presente Or ListaMotori(MotoreCocleaPreseparatrice_4).presente Or ListaMotori(MotoreCocleaPreseparatrice_5).presente) Then Select Case Index Case MotorManagementEnum.AutomaticMotor FrameAvvMotori(MotoreCoclea123_2).enabled = False APButtonStartStopMotore(MotoreCoclea123_2 - 1).enabled = False FrameAvvMotori(MotoreCoclea123_3).enabled = False APButtonStartStopMotore(MotoreCoclea123_3 - 1).enabled = False FrameAvvMotori(MotoreCoclea123_4).enabled = False APButtonStartStopMotore(MotoreCoclea123_4 - 1).enabled = False FrameAvvMotori(MotoreCoclea123_5).enabled = False APButtonStartStopMotore(MotoreCoclea123_5 - 1).enabled = False FrameAvvMotori(MotoreCocleaPreseparatrice_2).enabled = False APButtonStartStopMotore(MotoreCocleaPreseparatrice_2 - 1).enabled = False FrameAvvMotori(MotoreCocleaPreseparatrice_3).enabled = False APButtonStartStopMotore(MotoreCocleaPreseparatrice_3 - 1).enabled = False FrameAvvMotori(MotoreCocleaPreseparatrice_4).enabled = False APButtonStartStopMotore(MotoreCocleaPreseparatrice_4 - 1).enabled = False FrameAvvMotori(MotoreCocleaPreseparatrice_5).enabled = False APButtonStartStopMotore(MotoreCocleaPreseparatrice_5 - 1).enabled = False Case MotorManagementEnum.SemiAutomaticMotor FrameAvvMotori(MotoreCoclea123_2).enabled = False APButtonStartStopMotore(MotoreCoclea123_2 - 1).enabled = False FrameAvvMotori(MotoreCoclea123_3).enabled = False APButtonStartStopMotore(MotoreCoclea123_3 - 1).enabled = False FrameAvvMotori(MotoreCoclea123_4).enabled = False APButtonStartStopMotore(MotoreCoclea123_4 - 1).enabled = False FrameAvvMotori(MotoreCoclea123_5).enabled = False APButtonStartStopMotore(MotoreCoclea123_5 - 1).enabled = False FrameAvvMotori(MotoreCocleaPreseparatrice_2).enabled = False APButtonStartStopMotore(MotoreCocleaPreseparatrice_2 - 1).enabled = False FrameAvvMotori(MotoreCocleaPreseparatrice_3).enabled = False APButtonStartStopMotore(MotoreCocleaPreseparatrice_3 - 1).enabled = False FrameAvvMotori(MotoreCocleaPreseparatrice_4).enabled = False APButtonStartStopMotore(MotoreCocleaPreseparatrice_4 - 1).enabled = False FrameAvvMotori(MotoreCocleaPreseparatrice_5).enabled = False APButtonStartStopMotore(MotoreCocleaPreseparatrice_5 - 1).enabled = False Case MotorManagementEnum.ForcingMotor FrameAvvMotori(MotoreCoclea123_2).enabled = True APButtonStartStopMotore(MotoreCoclea123_2 - 1).enabled = True FrameAvvMotori(MotoreCoclea123_3).enabled = True APButtonStartStopMotore(MotoreCoclea123_3 - 1).enabled = True FrameAvvMotori(MotoreCoclea123_4).enabled = True APButtonStartStopMotore(MotoreCoclea123_4 - 1).enabled = True FrameAvvMotori(MotoreCoclea123_5).enabled = True APButtonStartStopMotore(MotoreCoclea123_5 - 1).enabled = True FrameAvvMotori(MotoreCocleaPreseparatrice_2).enabled = True APButtonStartStopMotore(MotoreCocleaPreseparatrice_2 - 1).enabled = True FrameAvvMotori(MotoreCocleaPreseparatrice_3).enabled = True APButtonStartStopMotore(MotoreCocleaPreseparatrice_3 - 1).enabled = True FrameAvvMotori(MotoreCocleaPreseparatrice_4).enabled = True APButtonStartStopMotore(MotoreCocleaPreseparatrice_4 - 1).enabled = True FrameAvvMotori(MotoreCocleaPreseparatrice_5).enabled = True APButtonStartStopMotore(MotoreCocleaPreseparatrice_5 - 1).enabled = True End Select End If End If End Sub
Public:


Methods:
 Public Sub AggiornaOreMotori ( )
 Public Sub CambioMod ( )
 Public Sub DebugMotore ( motore As Integer )
 Public Sub ForzPLC ( motore As Integer,  valore As Boolean )
 Public Sub ShowMe ( ByRef parente As Form )
 Public Sub UpdateManagement ( managemode As MotorManagementEnum )
 Public Sub UpdatePulsantiForm ( )
 Public Sub VisualizzaMotoreAcceso ( motore As Integer )
Private:


Types:
 Private Enum TopBarButtonEnum 
Properties:
 Private MotoriEranoInAutomaticoAperturaForm As Boolean
 Private PulsanteUpd ( 0 To ( TopBarButtonEnum. TBB_LAST - 1 ) )
 Private PulsanteUpdForm As Boolean
 Private selectedButtonIndex As Integer 
Methods:
 Private Sub APButtonStartStopMotore_Click ( Index As Integer )
 Private Sub ChkAvvForzatoPCL_Click ( )
 Private Sub CmdPassword_Click ( )
 Private Sub Form_Activate ( )
 Private Sub Form_Load ( )
 Private Sub Form_MouseMove ( Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgPulsanteForm_Click ( Index As Integer )
 Private Sub imgPulsanteForm_MouseDown ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgPulsanteForm_MouseMove ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgPulsanteForm_MouseUp ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub LblOreParz_DblClick ( Index As Integer )
 Private Sub LblOreTot_DblClick ( Index As Integer )
 Private Sub LoadImmaginiPulsantePlus ( Index As Integer,  stato As StatoPulsantePlus )
 Private Sub MergeAvvMotori ( )
 Private Sub PasswordLevel ( )
 Private Sub StatusBar1_PanelClick ( ByVal Panel As MSComctlLib. Panel )
 Private Sub txtVelMot_DblClick ( Index As Integer )
Documentation:

Module "BrucAuto"

Public:


Properties:
 Public LimiteCorrDownRaggiunto ( 0 To 1 ) As Boolean
 Public LimiteCorrUpRaggiunto ( 0 To 1 ) As Boolean 
Methods:
 Public Sub AttivaUscitePerRegolazioneEss ( verso As Integer,  smSec As Long,  tamburo As Integer )
 Public Sub GestRegolazioneBruciatore ( tamburo As Integer )
 Public Sub GestSetRegBruciatore2 ( )
Private:


Methods:
 Private Sub GestSetRegBruciatore ( )
 Private Sub GestTotRegBruciatore ( tamburo As Integer )
 Private Sub TableShift ( ByRef lista ( ) As Double,  listaDim As Integer,  verso As Integer )
Documentation:

Module "BusSytem"

Public:


Types:
 Public Type PlcRack
 Public Enum PlcRackEnum 
Properties:
 Public ListaPlcRack ( PlcRackEnum. R1 To PlcRackEnum. R6 ) As PlcRack
 Public ListaPlcRackLetta As Boolean
Private:


Methods:
 Private Sub RackModificato ( ByRef Rack As PlcRack,  configuratoTag As Integer,  offlineTag As Integer,  faultTag As Integer,  ByRef daAggiornare As Boolean )
Documentation:

Module "CodaCircolare"

Public:


Constants:
 Public Const MAXFIFO = 720 
Types:
 Public Type CqType
 Public Type FifoMaterialeType 
Properties:
 Public CodaInerti As CqType
 Public CodaTamburoParallelo As CqType 
Methods:
 Public Function CqAdd ( ByRef cq As CqType,  ByRef materiale As FifoMaterialeType ) As Boolean
 Public Function CqAmount ( ByRef cq As CqType ) As Double
 Public Function CqEmpty ( ByRef cq As CqType ) As Boolean
 Public Function CqInit ( ByRef cq As CqType,  maxItems As Integer ) As Boolean
 Public Function CqRemove ( ByRef cq As CqType,  ByRef materiale As FifoMaterialeType ) As Boolean
 Public Function CqRemoveIf ( ByRef cq As CqType,  ByRef materiale As FifoMaterialeType ) As Boolean
Private:

Documentation:

Class "Configuration"

Public:


Methods:
 Public Sub FileReload ( )
 Public Function GetParameterValue ( Section As String,  Paragraph As String,  SubParagraph As String,  Param As String,  Optional defaultValue As String ) As String
 Public Function SetParameterValue ( Section As String,  Paragraph As String,  SubParagraph As String,  Param As String,  Value As Variant ) As Boolean
Private:


Properties:
 Private m_xmlManager As XmlManager 
Methods:
 Private Sub Class_Initialize ( )
Documentation:

Module "Configurazione"

Public:


Constants:
 Public Const BUILDNUMBER As Integer = 0
 Public Const ERROR_ALREADY_EXISTS = 183 &
 Public Const LOCALE_ILZERO = &H12
 Public Const LOCALE_SDECIMAL = &HE
 Public Const LOCALE_SSHORTDATE = &H1F
 Public Const LOCALE_STHOUSAND = &HF
 Public Const LOCALE_STIME = &H1E
 Public Const LOCALE_STIMEFORMAT = &H1003
 Public Const LOCALE_USER_DEFAULT = &H400 
Types:
 Public Type BilanciaExtType
 Public Type BilanciaStatusType
 Public Type BilanciaType
 Public Type BilanciaViatopScarMixerType
 Public Enum EnumGestioneFiller
 Public Enum ScaleID
 Public Enum ScambioTuboPienoEnum
 Public Enum UsersEnum 
Properties:
 Public AbilitaBindicatorFillerEsterni As Boolean
 Public AbilitaConsumoEnergia As Boolean
 Public AbilitaInverterSpruzzaturaLegante As Boolean
 Public AbilitaManutenzioni As Boolean
 Public AbilitaPredosatoreVuotoComune As Boolean
 Public AbilitaSelettoreBitume1 As Boolean
 Public AbilitaSelettoreBitume2 As Boolean
 Public AbilitaSicurezzaGalleggianteB2 As Boolean
 Public AbilitaSicurezzaGalleggianteB3 As Boolean
 Public AbilitaSondaAggiuntivaUscitaTamburo As Boolean
 Public AbilitaTemperaturaIngressoTamburo As Boolean
 Public AbilitaTemperaturaMixer As Boolean
 Public AbilitaTermicaComune As Boolean
 Public ActiveUser As UsersEnum
 Public BilanciaAggregati As BilanciaType
 Public BilanciaFiller As BilanciaType
 Public BilanciaLegante As BilanciaType
 Public BilanciaPesaCamion As BilanciaExtType
 Public BilanciaRAP As BilanciaType
 Public BilanciaRAPSiwa As BilanciaType
 Public BilanciaStatus ( 0 To MaxScaleID - 1 ) As BilanciaStatusType
 Public BilanciaTamponeRiciclato As BilanciaType
 Public BilanciaViatop As BilanciaType
 Public BilanciaViatopScarMixer1 As BilanciaViatopScarMixerType
 Public BilanciaViatopScarMixer2 As BilanciaViatopScarMixerType
 Public CaptionStart As String
 Public CAPTIONSTARTSIMPLE As String
 Public CharSetSelezionato As Integer
 Public CicliStopPred As Long
 Public CmdStartDosaggioLock As Boolean
 Public Commessa As String
 Public DEBUGGING As Boolean
 Public DEMO_VERSION As Boolean
 Public DensAddMixer As Double
 Public DimensioneImpastoKg As Long
 Public EnableControlloComunicazione As Boolean
 Public EsclusioneGestioneBruciatore As Boolean
 Public EsclusioneGestioneFiltro As Boolean
 Public EsclusioneSpegniVaglio As Boolean
 Public F2SuElevatoreF2 As Boolean
 Public F3SuElevatoreF2 As Boolean
 Public FrmComandiCisterneVisibile As Boolean
 Public GestioneFiller2 As EnumGestioneFiller
 Public GestioneFiller3 As EnumGestioneFiller
 Public GestionePesoSacchi As Boolean
 Public GestioneScambioTuboTroppoPieno As ScambioTuboPienoEnum
 Public GraphicPath As String
 Public GSetBSoft As Integer
 Public HardKeyRemoved As Boolean
 Public ImpastoNonVagliato As Integer
 Public ImpastoVagliato As Integer
 Public InclMinFlussoAddBacinella As Boolean
 Public InclusioneAcqua As Boolean
 Public InclusioneAddBacinella As Boolean
 Public InclusioneAddContalitri As Boolean
 Public InclusioneAddFlomac As Boolean
 Public InclusioneAddMescolatore As Boolean
 Public InclusioneAddSacchi As Boolean
 Public InclusioneF2 As Boolean
 Public InclusioneF3 As Boolean
 Public InclusioneTemperaturaLineaCaricoBitume As Boolean
 Public InstallationPath As String
 Public InstallDataPath As String
 Public LogPath As String
 Public MaggiorazionePesataBitume As Integer
 Public MassimoAriaFredda As Integer
 Public MassimoFSDeprimometroFiltroIN As Integer
 Public MassimoModulatoreBruciatoreTamburo2 As Integer
 Public MassimoModulatoreRAP As Integer
 Public MassimoPosAspPLC As Integer
 Public MassimoPosModulatorePLC As Integer
 Public MinimoAriaFredda As Integer
 Public MinimoModulatoreBruciatoreTamburo2 As Integer
 Public MinimoModulatoreRAP As Integer
 Public MinimoPosAspPLC As Integer
 Public MinimoPosModulatorePLC As Integer
 Public NLivelliA As Integer
 Public NomePortina ( 0 To 7 ) As String
 Public NTramoggeA As Integer
 Public PercConsensoAcqua As Integer
 Public PercConsensoFiller As Integer
 Public Plus2Monitor As Boolean
 Public PortataAcqua As Double
 Public PortataAddBacinella As Double
 Public PortataAddMescolatore As Double
 Public PresenzaRompiSacchiF2 As Boolean
 Public RackVersione82x As Boolean
 Public RiduzioneImpasto As Integer
 Public RiduzioneImpastoDefault As Integer
 Public RiduzioneProduzione As Integer
 Public RiduzioneProduzioneDefault As Integer
 Public SelezioneRegPid1 As Boolean
 Public SelezioneRegPid2 As Boolean
 Public SicurezzaBitumeSoft As Integer
 Public StartTroppoPienoNV As Long
 Public TaraBitumeSoft As Double
 Public TempMinimaBitume As Integer
 Public TempMinimaEmulsione As Integer
 Public TempoMinFlussoAddBacinella As Long
 Public TimeoutAllarmeFiltroAltaTempIN As Long
 Public TimeOutTroppoPienoNV As Long
 Public TimeOutTroppoPienoRifiuti As Long
 Public TipoLivelliA As Integer
 Public TonOrarieAttualiImpianto As Long
 Public TonOrarieImpianto As Long
 Public TramoggeLivelliDigitaliMinimo As Boolean
 Public TramoggeLivelloMassimo As Integer
 Public TramoggeLivelloMinimo As Integer
 Public TramoggeVisualizzaLivelloMinimo As Boolean
 Public UserDataPath As String
 Public VoltPompaLegante As Integer 
Methods:
 Public Sub PlcInviaParametri ( )
 Public Sub VisualizzaBarraPulsantiCP240 ( Ena As Boolean ) 
Declarations:
 Public Declare Function CloseHandle Lib "kernel32" ( ByVal hObject As Long ) As Long
 Public Declare Function CreateMutex Lib "kernel32" Alias "CreateMutexA" ( lpMutexAttributes As Any,  ByVal bInitialOwner As Long,  ByVal lpName As String ) As Long
 Public Declare Function ReleaseMutex Lib "kernel32" ( ByVal hMutex As Long ) As Long
 Public Declare Function SetLocaleInfo & Lib "kernel32" Alias "SetLocaleInfoA" ( ByVal Locale As Long,  ByVal LCType As Long,  ByVal lpLCData As String )
 Public Declare Function ShellExecute Lib "SHELL32.DLL" Alias "ShellExecuteA" ( ByVal hWnd As Long,  ByVal lpOperation As String,  ByVal lpFile As String,  ByVal lpParameters As String,  ByVal lpDirectory As String,  ByVal nShowCmd As Long ) As Long
Private:


Properties:
 Private primoinvioparametriplc As Boolean
Documentation:

Module "ControlliVari"

Public:


Constants:
 Public Const cstIndiceImmagineValvola3VieBitumeEsterno = 21 
Types:
 Type RecordAllarmi
 Type TemperaturaType
 Public Enum TemperatureEnum
 Public Type TemporizzatoreStandardType
 Type TipoTemporizzatoreStandard
 Public Type ValvolaAutoManRitardata 
Properties:
 Public AbilitaPressioneAriaImpianto As Boolean
 Public AbilitaTemperaturaLeganteBacinella As Boolean
 Public Allarmi ( ) As RecordAllarmi
 Public AppoggioTempoValvolaPresep As Single
 Public AppoggioTempoValvolaPreseparatoreAnello As Single
 Public BassaTemperaturaBitume ( 0 To 3 ) As Boolean
 Public BitumeDaCircuitoEsterno As Boolean
 Public BitumeDaCircuitoMarini As Boolean
 Public ContalitriErroreTimeOutArresto As Boolean
 Public ContalitriErroreTimeOutAvvio As Boolean
 Public DataStartCyb500 As Date
 Public ErroreDatoParametri As Boolean
 Public FrmInversionePCLVisibile As Boolean
 Public FrmTestPredosatoriVisible As Boolean
 Public GrandezzaImpasto ( 2 ) As Long
 Public InclusioneBitumeEsterno As Boolean
 Public ListaTemperature ( 0 To TempMax - 1 ) As TemperaturaType
 Public MaxScalaPressioneAriaImpianto As Long
 Public MemoriaGestioneValvolaPreseparatore As Boolean
 Public MemoriaGestioneValvolaPreseparatoreAnello As Boolean
 Public MemWatchdogCS As Boolean
 Public MescolatoreAperto As Boolean
 Public MescolatoreChiuso As Boolean
 Public MinScalaPressioneAriaImpianto As Long
 Public NumTraduzioni As Long
 Public PressioneAriaImpianto As Double
 Public StatoValvolaManCircuitoBitume As enumStatoValvolaBitumeEsterno
 Public TipoAllarmi ( ) As RecordAllarmi
 Public Traduzioni ( ) As String
 Public ValvolaPreseparatore As ValvolaAutoManRitardata
 Public ValvolaPreseparatoreAnello As ValvolaAutoManRitardata 
Methods:
 Public Sub AttivazioneSirena ( attiva As Boolean )
 Public Function BassaTempBitume ( runTimeStop As Boolean ) As Boolean
 Public Function Binary2Integer ( s As String ) As Integer
 Public Function Bit2Long ( valore As String ) As Long
 Public Function BooleanModificato ( ByRef valore As Boolean,  ByVal nuovoValore As Boolean,  ByVal fatto As Boolean ) As Boolean
 Public Function BoolToCheck ( Value As Boolean ) As Integer
 Public Function ByteModificato ( ByRef valore As Byte,  ByVal nuovoValore As Byte,  ByVal fatto As Boolean ) As Boolean
 Public Function CheckLabelDato ( oggetto As Object,  minimo As Variant,  massimo As Variant,  default As Variant ) As Boolean
 Public Function ControlloChiaveHL ( ) As Boolean
 Public Function ConvertiTempoMilliSECtoS7 ( MilliSec As Long ) As String
 Public Function ConvertiTempoS7toSEC ( valore As String ) As Long
 Public Function ConvertiTempoSECtoS7 ( ByVal valore As Long,  Optional MilliSec As Long ) As String
 Public Function ConvertiTimer ( ) As Long
 Public Sub CP240StatusBar_Change ( Panel As StatusBarPanel,  statologico As Variant )
 Public Sub CreatePath ( ByVal path As String )
 Public Function DatoCorretto ( Dato As String,  decimali As Integer,  min As Double,  max As Double,  predefinito As Double,  Optional lost As Integer ) As Variant
 Function DlookUp ( ByVal NomeCampo As String,  ByVal Tabella As String,  ByVal CriterioConfronto As String,  Optional NomeCampo2 As String,  Optional CriterioConfronto2 As String ) As Variant
 Function DlookUpExt ( ByVal NomeCampo As String,  ByVal Tabella As String,  ByVal CriterioConfronto As String,  ByVal NomeCampo2 As String ) As Variant
 Public Function DoubleModificato ( ByRef valore As Double,  ByVal nuovoValore As Double,  ByVal fatto As Boolean ) As Boolean
 Public Sub EvacuazioneFiltroDMR_change ( )
 Public Function FileExist ( FileName As String ) As Boolean
 Public Sub GestioneValvolaPreseparatore ( )
 Public Sub GestioneValvolaPreseparatoreAnello ( )
 Public Sub InitPbarNettoPesata ( componentestart As ComponenteGraficaEnum,  componentelast As ComponenteGraficaEnum )
 Public Function Integer2Binary ( n As Integer ) As String
 Public Function IntegerModificato ( ByRef valore As Integer,  ByVal nuovoValore As Integer,  ByVal fatto As Boolean ) As Boolean
 Public Sub Lampeggio ( ByRef oggetto As Object,  ColoreOff,  ColoreOn,  enable As Boolean )
 Public Function LimitaValore ( valore As Long,  min As Long,  max As Long ) As Long
 Public Function LimitaValoreDbl ( valore As Double,  min As Double,  max As Double ) As Double
 Public Function LimitaValoreSng ( valore As Single,  min As Single,  max As Single ) As Single
 Public Function LogaritmoBASE ( numero As Double,  Base As Double )
 Public Function Long2Bit ( numero As Long ) As String
 Public Function Long2BitChar ( numero As Long,  Caratteri As Integer ) As String
 Public Function LongModificato ( ByRef valore As Long,  ByVal nuovoValore As Long,  ByVal fatto As Boolean ) As Boolean
 Public Function Null2Qualcosa ( valore )
 Public Function Null2String ( valore ) As String
 Public Function Null2zero ( valore As String ) As Double
 Public Function ParteDecimale ( numero As Double,  NumeroCifre As Integer )
 Public Function PathExist ( path As String ) As Boolean
 Public Sub PbarNettoPesata ( ByRef componente As ComponenteType,  valorebilancia As Double,  Optional valorediretto As Double,  Optional manuale As Boolean )
 Public Function Pixel2Twips ( pixel As Integer ) As Integer
 Public Sub PressioneAriaImpianto_change ( )
 Public Sub RefreshPbarNettoPesate ( )
 Public Function RicavaWhere ( s As String ) As String
 Public Function ScalaturaUnitaAnalogIN ( Unita As Long,  LimiteScalaMax As Long,  LimiteScalaMin As Long ) As Long
 Public Function ScalaturaUnitaAnalogIN_Double ( Unita As Long,  LimiteScalaMax As Long,  LimiteScalaMin As Long ) As Double
 Public Function ScalaturaUnitaAnalogINConNegativi ( Unita As Long,  LimiteScalaMax As Long,  LimiteScalaMin As Long ) As Long
 Public Sub ScriviOra ( )
 Public Sub SetStartUpPosition ( ByRef Form As Form,  Optional monitor As Integer )
 Public Function String2Bool ( Value As String ) As Boolean
 Public Function String2Double ( valore As String ) As Double
 Public Function String2Int ( Value As String ) As Integer
 Public Function String2Long ( Value As String ) As Long
 Public Sub Temporizzatore2Tempi ( TempoLavoro As Long,  TempoSosta As Long,  AppTempo As Single,  LavoroExec As Boolean,  SostaExec As Boolean,  uscita As Boolean,  Abilitazione As Boolean,  ErrTimer As Boolean )
 Public Sub TemporizzatoreStandard ( ScalaTempo As Integer,  Tempo As Long,  AppTempo As Single,  TempoExec As Boolean,  uscita As Boolean,  Abilitazione As Boolean,  ErrTimer As Boolean )
 Public Function TimeToMillisecond ( ) As String
 Public Sub VerificaEvacuazioneFiltroDMR ( )
 Public Sub VerificaEvacuazioneSiloFiller ( )
 Public Function VerificaTextEdit ( txtControl As TextBox,  decimali As Integer,  min As Double,  max As Double,  predefinito As Double,  lost As Boolean ) As Boolean 
Declarations:
 Declare Function GetUserName Lib "ADVAPI32.dll" Alias "GetUserNameA" ( ByVal lpbuffer As String,  nSize As Long ) As Long
 Public Declare Function GetWindowText Lib "User32" Alias "GetWindowTextA" ( ByVal hWnd As Long,  ByVal lpString As String,  ByVal cch As Long ) As Long
 Public Declare Function NextWindow Lib "User32" Alias "GetWindow" ( ByVal hWnd As Long,  ByVal wCmd As Long ) As Long
 Public Declare Function RecupHandleBureau Lib "User32" Alias "GetDesktopWindow" ( ) As Long
Private:


Types:
 Private Type SYSTEMTIME 
Properties:
 Private LastDateTime As Date 
Declarations:
 Private Declare Sub GetSystemTime Lib "Kernel32" ( lpSystemTime As SYSTEMTIME )
Documentation:

Module "ControlloDatiInseriti"

Public:


Methods:
 Public Sub DatoInteger ( ByRef Dato As Object,  ByVal numeroCaratteri As Integer,  ByVal negativo As Boolean )
 Public Sub DatoNomeRicetta ( ByRef Dato As Object )
 Public Sub DatoVirgola ( ByRef Dato As Object,  ByVal numeroCaratteri As Integer,  ByVal NumeroDecimali As Integer,  ByVal negativo As Boolean )
 Public Function RoundNumber ( numero As Variant,  NumeroDecimali As Integer ) As Variant
Private:

Documentation:

Form "CP240"

Public:


Types:
 Public Enum StatusBarPanel
 Public Enum TopBarButtonEnum
 Public Enum TopBarButtonSecondaryEnum 
Methods:
 Public Sub AbilitaCalibrazione ( )
 Public Sub AbilitaDosaggioManuale ( refreshInvPCL As Boolean )
 Public Sub AbilitaInversionePCL ( )
 Public Sub AggiustaMonitor ( )
 Public Sub AnalogicheGestioneFumiTamburo ( perc_mod As Long,  dep_vaglio As Long )
 Public Sub AnalogicheGestioneVelTamburo ( perc_mod As Long )
 Public Sub AssegnaTraduzioni ( )
 Public Sub ComandiGestioneFumiTamburo ( cmd_down As Boolean,  cmd_up As Boolean )
 Public Sub ComandiGestioneVelTamburo ( cmd_down As Boolean,  cmd_up As Boolean )
 Public Sub EnableCliente ( visibility As Boolean )
 Public Sub GestioneDirezioneJolly ( )
 Public Sub ManageTopBarButton ( Button As Integer )
 Public Sub RefreshBenna ( )
 Public Sub SetDownBruciatore ( tamburo As Integer )
 Public Sub SetUpBruciatore ( tamburo As Integer )
 Public Sub ShowBenna ( carica As Boolean )
 Public Sub UpdatePulsantiForm ( )
 Public Sub uscita ( )
 Public Sub VisualizzaErroreComunicazione ( Stato As Boolean )
 Public Sub VisualizzaStatoComunicazione ( )
Private:


Constants:
 Private Const CCM_FIRST = &H2000
 Private Const CCM_SETBKCOLOR = ( CCM_FIRST + 1 )
 Private Const SB_SETBKCOLOR = CCM_SETBKCOLOR 
Types:
 Private Type POINTAPI 
Properties:
 Private ChiusuraApplicazione As Boolean
 Private cmbTargaCamionCurrValue As String
 Private fatto As Boolean
 Private Frame1_2_Visible As Boolean
 Private Frame1_20_Visible As Boolean
 Private Frame1_24_Visible As Boolean
 Private Frame1_3_Visible As Boolean
 Private Frame1_36_Visible As Boolean
 Private Frame1_39_Visible As Boolean
 Private Frame1_43_Visible As Boolean
 Private nextButtonIndex As Integer
 Private PulsanteUpd ( 0 To ( TopBarButtonSecondaryEnum. TBB_SECONDARYLAST - 1 ) )
 Private PulsanteUpdForm As Boolean
 Private selectedButtonIndex As Integer
 Private StatoConnessionePlcAquablack As Boolean
 Private StatoConnessionePlcCisterne As Boolean
 Private StatoConnessionePlcPrincipale As Boolean
 Private StatoConnessionePlcSchiumato As Boolean
 Private VisualizzazioneConnessionePlcGiaFatta As Boolean 
Methods:
 Private Sub AdoComboClientiCamion_Change ( )
 Private Sub adoComboDosaggio_KeyDown ( KeyCode As Integer,  Shift As Integer )
 Private Sub adoComboDosaggio_MouseUp ( Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub adoComboPredosaggio_Change ( )
 Private Sub adoComboPredosaggio_KeyDown ( KeyCode As Integer,  Shift As Integer )
 Private Sub adoComboPredosaggio_MouseDown ( Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub adoDBMatCist_KeyDown ( Index As Integer,  KeyCode As Integer,  Shift As Integer )
 Private Sub adoDBMatCist_MouseUp ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub adoDBMatCombust_Change ( )
 Private Sub AdoDosaggio_MoveComplete ( ByVal adReason As adodb. EventReasonEnum,  ByVal pError As adodb. Error,  adStatus As adodb. EventStatusEnum,  ByVal pRecordset As adodb. Recordset )
 Private Sub AdoDosaggio_WillChangeRecord ( ByVal adReason As adodb. EventReasonEnum,  ByVal cRecords As Long,  adStatus As adodb. EventStatusEnum,  ByVal pRecordset As adodb. Recordset )
 Private Sub AniPButtonAspFresato_Click ( )
 Private Sub AniPushButtonDeflettore_Click ( Index As Integer )
 Private Sub AniPushGenerico_Click ( Index As Integer )
 Private Sub Client_DataArrival ( ByVal bytesTotal As Long )
 Private Sub Client_Error ( ByVal Number As Integer,  description As String,  ByVal Scode As Long,  ByVal Source As String,  ByVal HelpFile As String,  ByVal HelpContext As Long,  CancelDisplay As Boolean )
 Private Sub cmbGestioneCisterne_Click ( Index As Integer )
 Private Sub cmbTargaCamion_Click ( )
 Private Sub CmdAddPesa_LostFocus ( Index As Integer )
 Private Sub CmdAddPesa_MouseDown ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub CmdAddPesa_MouseUp ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub CmdAutoManSiloS7_MouseDown ( Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub CmdAutPred_Click ( )
 Private Sub CmdAvviamentoBruciatoreCaldo_Click ( Index As Integer )
 Private Sub CmdAvvMotori_Click ( Index As Integer )
 Private Sub CmdAvvPredPrimaDopoBruc_Click ( )
 Private Sub CmdCaldaiaOn_Click ( indice As Integer )
 Private Sub CmdCamion_Click ( Index As Integer )
 Private Sub CmdCircOlio_Click ( indice As Integer )
 Private Sub CmdClienti_Click ( )
 Private Sub CmdComprViatop_MouseDown ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub CmdComprViatop_MouseUp ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub CmdDosaggioJob_Click ( Index As Integer )
 Private Sub CmdLeganteFuoriToll_Click ( )
 Private Sub CmdManPred_Click ( )
 Private Sub CmdManualeStartMotori_Click ( )
 Private Sub CmdNettiSiloStoricoSommaSalva_Click ( Index As Integer )
 Private Sub CmdPesaEXT_LostFocus ( Index As Integer )
 Private Sub CmdPesaEXT_MouseDown ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub CmdPesaEXT_MouseUp ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub CmdPID_Click ( Index As Integer )
 Private Sub CmdPred_Click ( Index As Integer )
 Private Sub CmdProgRisc_Click ( )
 Private Sub CmdResetAllarme_Click ( )
 Private Sub CmdResetAllarme_MouseDown ( Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub CmdResetAllarme_MouseUp ( Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub CmdResetConsumi_Click ( Index As Integer )
 Private Sub cmdResetLitriComb_Click ( Index As Integer )
 Private Sub CmdResetProdotto_Click ( Index As Integer )
 Private Sub CmdResetScomparto_Click ( Index As Integer )
 Private Sub CmdRicPred_Click ( )
 Private Sub CmdScarica_LostFocus ( Index As Integer )
 Private Sub CmdScarica_MouseDown ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub CmdScarica_MouseUp ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub CmdSchiumatura_Click ( )
 Private Sub CmdSelezioneSilo_Click ( Index As Integer )
 Private Sub CmdStartBruc_Click ( Index As Integer )
 Private Sub CmdStartDosaggio_Click ( )
 Private Sub CmdStartPred_Click ( )
 Private Sub CmdStartPumpAuxCald_Click ( indice As Integer )
 Private Sub CmdStartSiloS7_Click ( )
 Private Sub CmdStartStopGenerale_Click ( Index As Integer )
 Private Sub CmdStopBruc_Click ( Index As Integer )
 Private Sub CmdStopDosaggio_Click ( )
 Private Sub CmdStopPred_Click ( )
 Private Sub CmdStopSiloS7_MouseDown ( Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub CmdSyncroBennaAsse_Click ( Index As Integer )
 Private Sub CmdTipoPesate_MouseDown ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub CmdTipoPesate_MouseUp ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub CmdTrPesa_LostFocus ( Index As Integer )
 Private Sub CmdTrPesa_MouseDown ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub CmdTrPesa_MouseUp ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub CmdUpDownAriaFiltro_LostFocus ( Index As Integer )
 Private Sub CmdUpDownAriaFiltro_MouseDown ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub CmdUpDownAriaFiltro_MouseUp ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub CmdUpDownBruc_LostFocus ( Index As Integer )
 Private Sub CmdUpDownBruc_MouseDown ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub CmdUpDownBruc_MouseUp ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub CmdUpDownModDeflAnello_KeyDown ( Index As Integer,  KeyCode As Integer,  Shift As Integer )
 Private Sub CmdUpDownModDeflAnello_KeyUp ( Index As Integer,  KeyCode As Integer,  Shift As Integer )
 Private Sub CmdUpDownModDeflAnello_LostFocus ( Index As Integer )
 Private Sub CmdUpDownModDeflAnello_MouseDown ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub CmdUpDownModDeflAnello_MouseUp ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub DebugVerificaAllarmi ( )
 Private Sub Form_KeyPress ( KeyAscii As Integer )
 Private Sub Form_Load ( )
 Private Sub Form_MouseMove ( Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub Form_Unload ( Cancel As Integer )
 Private Sub Frame1_MouseMove ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub Image1_Click ( Index As Integer )
 Private Sub Image1_DblClick ( Index As Integer )
 Private Sub ImgAdditivo_Click ( Index As Integer )
 Private Sub ImgDeflettore_Click ( Index As Integer )
 Private Sub ImgMotor_Click ( Index As Integer )
 Private Sub ImgPred_Click ( Index As Integer )
 Private Sub ImgPredRic_Click ( Index As Integer )
 Private Sub imgPulsanteForm_Click ( Index As Integer )
 Private Sub imgPulsanteForm_MouseDown ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgPulsanteForm_MouseMove ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgPulsanteForm_MouseUp ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgSfondoTopBar_MouseMove ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub ImgTr_Click ( Index As Integer )
 Private Sub imgValvolaCisterne_Click ( Index As Integer )
 Private Sub LblAdd_MouseDown ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub LblAdd_MouseUp ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub LblCaldTempSet_Click ( Index As Integer )
 Private Sub LblCistMateriale_DblClick ( Index As Integer )
 Private Sub LblCistTempSet_DblClick ( Index As Integer )
 Private Sub Lbletichetta_Change ( Index As Integer )
 Private Sub LblPesoSilo_DblClick ( Index As Integer )
 Private Sub LblPredBil_DblClick ( Index As Integer )
 Private Sub LblPredRicBil_DblClick ( Index As Integer )
 Private Sub LblProdDos_Change ( )
 Private Sub LblProdDos_DblClick ( )
 Private Sub LblProdPredos_Change ( )
 Private Sub LblRamseyInerti_DblClick ( )
 Private Sub LblRamseyRic_Change ( Index As Integer )
 Private Sub LblRamseyRic_DblClick ( Index As Integer )
 Private Sub LblTipoMaterialeS_DblClick ( Index As Integer )
 Private Sub LblTrLivTeorico_DblClick ( Index As Integer )
 Private Sub LblTrNet_DblClick ( Index As Integer )
 Private Sub LblTrSetPeso_DblClick ( Index As Integer )
 Private Sub LoadImmaginiPulsantePlus ( Index As Integer,  Stato As StatoPulsantePlus )
 Private Sub opcData_OnDataChanged ( ByVal bOkay As Integer,  ByVal ChangedItems As OPCDataItems )
 Private Sub OPCData_OnDisconnect ( )
 Private Sub OPCData_OnError ( Error As Long,  description As String )
 Private Sub OPCDataAquablack_OnDataChanged ( ByVal bOkay As Integer,  ByVal ChangedItems As SoftingAxCCtl. OPCDataItems )
 Private Sub OPCDataCisterne_OnDataChanged ( ByVal bOkay As Integer,  ByVal ChangedItems As SoftingAxCCtl. OPCDataItems )
 Private Sub OPCDataSchiumato_OnDataChanged ( ByVal bOkay As Integer,  ByVal ChangedItems As SoftingAxCCtl. OPCDataItems )
 Private Sub OPCDataSchiumato_OnError ( Error As Long,  description As String )
 Private Sub pctCamionPesa_DblClick ( )
 Private Sub PesataExtAbilita ( )
 Private Sub PesataExtComando ( Index As Integer,  pesata As Boolean )
 Private Sub Server_ConnectionRequest ( ByVal requestID As Long )
 Private Sub Server_DataArrival ( ByVal bytesTotal As Long )
 Private Sub Server_Error ( ByVal Number As Integer,  description As String,  ByVal Scode As Long,  ByVal Source As String,  ByVal HelpFile As String,  ByVal HelpContext As Long,  CancelDisplay As Boolean )
 Private Sub SetBackColor ( objObject As Object,  ByVal BackColor As Long )
 Private Sub StatoConnessionePlcAquablack_change ( )
 Private Sub StatoConnessionePlcCisterne_change ( )
 Private Sub StatoConnessionePlcPrincipale_change ( )
 Private Sub StatoConnessionePlcSchiumato_change ( )
 Private Sub TextTempiRitardoSc_DblClick ( Index As Integer )
 Private Sub TimerAvvMotoreMescolatore_Timer ( )
 Private Sub TimerChiamataPID_Timer ( )
 Private Sub TimerChiamataPID2_Timer ( )
 Private Sub TimerChkPrinter_Timer ( )
 Private Sub TimerFunzionamentoMotori_Timer ( Index As Integer )
 Private Sub TimerImpulsoCorr_Timer ( )
 Private Sub TimerResetCmdSilo_Timer ( )
 Private Sub tmrAqResetComandi_Timer ( )
 Private Sub tmrRicTrasNET_Timer ( Index As Integer )
 Private Sub TxtCicloDos_Change ( )
 Private Sub TxtCicloDos_LostFocus ( )
 Private Sub TxtImpastoRidotto_DblClick ( Index As Integer )
 Private Sub TxtMaggiorazioneBitume_DblClick ( )
 Private Sub TxtPredRicSet_DblClick ( Index As Integer )
 Private Sub TxtPredSet_DblClick ( Index As Integer )
 Private Sub TxtStopPredosatori_Change ( )
 Private Sub TxtStopPredosatori_LostFocus ( )
 Private Sub TxtTemperaturaBruciatoreAutomatico_DblClick ( Index As Integer )
 Private Sub UpDownCicli_Change ( )
 Private Sub UpDownProdDos_LostFocus ( )
 Private Sub UpDownProdDos_MouseDown ( Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub UpDownProdDos_MouseUp ( Button As Integer,  Shift As Integer,  x As Single,  Y As Single ) 
Declarations:
 Private Declare Function SendMessage Lib "user32.dll" Alias "SendMessageA" ( ByVal hWnd As Long,  ByVal msg As Long,  wParam As Any,  lParam As Any ) As Long
Documentation:

Form "FormAquablack"

Public:


Types:
 Public Enum AqStatusBar
 Public Enum AqTopBarButtonEnum 
Methods:
 Public Sub UpdatePulsantiForm ( )
Private:


Properties:
 Private PulsanteUpd ( 0 To ( TopBarButtonEnum. TBB_LAST - 1 ) )
 Private PulsanteUpdForm As Boolean
 Private selectedButtonIndex As Integer 
Methods:
 Private Sub APButton_cmdH2OPump_Click ( )
 Private Sub APButton_cmdH2OValve_Click ( )
 Private Sub APButton_cmdPurgeValve_Click ( )
 Private Sub APButton_cmdTrikleValve_Click ( )
 Private Sub Form_Activate ( )
 Private Sub Form_Load ( )
 Private Sub Form_MouseMove ( Button As Integer,  Shift As Integer,  X As Single,  Y As Single )
 Private Sub Form_Terminate ( )
 Private Sub imgPulsanteForm_Click ( Index As Integer )
 Private Sub imgPulsanteForm_MouseDown ( Index As Integer,  Button As Integer,  Shift As Integer,  X As Single,  Y As Single )
 Private Sub imgPulsanteForm_MouseMove ( Index As Integer,  Button As Integer,  Shift As Integer,  X As Single,  Y As Single )
 Private Sub imgPulsanteForm_MouseUp ( Index As Integer,  Button As Integer,  Shift As Integer,  X As Single,  Y As Single )
 Private Sub lblSetSpeedH2OPump_DblClick ( )
 Private Sub LoadImmaginiPulsantePlus ( Index As Integer,  Stato As StatoPulsantePlus )
Documentation:

Form "FormAvvRidotto"

Public:


Methods:
 Public Sub UpdatePulsantiForm ( )
Private:


Types:
 Private Enum TopBarButtonEnum 
Properties:
 Private PulsanteUpd ( 0 To ( TopBarButtonEnum. TBB_LAST - 1 ) )
 Private PulsanteUpdForm As Boolean
 Private selectedButtonIndex As Integer 
Methods:
 Private Sub Form_Load ( )
 Private Sub Form_MouseMove ( Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgPulsanteForm_Click ( Index As Integer )
 Private Sub imgPulsanteForm_MouseDown ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgPulsanteForm_MouseMove ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgPulsanteForm_MouseUp ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub LoadImmaginiPulsantePlus ( Index As Integer,  stato As StatoPulsantePlus )
Documentation:

Form "FormPIDBruc"


salvo i parametri momentaneamente per vedere le differenze di comportamento del PID. Per salvarlidefinitivamente devo spingere il pulsante salva
FattoreDiCorrezioneKp = String2Long(TextParPID(0).text) FattoreDiCorrezioneKi = String2Double(TextParPID(1).text) FattoreDiCorrezioneKd = String2Double(TextParPID(2).text) TInterventoCampionamento = String2Long(TextParPID(3).text) * 1000

TextParPID(0).text = FattoreDiCorrezioneKp TextParPID(1).text = FattoreDiCorrezioneKi TextParPID(2).text = FattoreDiCorrezioneKd TextParPID(3).text = CStr(TInterventoCampionamento / 1000)

Call FormPIDBruc_IsModified

End Sub

Private Sub RipristinaParIniz()

FattoreDiCorrezioneKp = KpPrec FattoreDiCorrezioneKi = KiPrec FattoreDiCorrezioneKd = KdPrec TInterventoCampionamento = TcPrec

End Sub

Public:


Methods:
 Public Sub SetLblDebug ( Index As Integer,  str As String )
 Public Sub UpdatePulsantiForm ( )
Private:


Types:
 Private Enum TopBarButtonEnum 
Properties:
 Private FormHeightMin As Long
 Private GraphMod ( 100 ) As Integer
 Private GraphTemp ( 100 ) As Integer
 Private PixMod As Double
 Private PixTemp As Double
 Private primaVolta As Boolean
 Private PulsanteUpd ( 0 To ( TopBarButtonEnum. TBB_LAST - 1 ) )
 Private PulsanteUpdForm As Boolean
 Private selectedButtonIndex As Integer
 Private TmrLblDebug ( 0 To 9 ) As Long
 Private TrendSample As Integer
 Private x As Integer 
Methods:
 Private Sub AggiornaGraficaBruciatore ( )
 Private Sub apbStartStopTrend_Click ( )
 Private Sub Form_Load ( )
 Private Sub Form_MouseMove ( Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgPulsanteForm_Click ( Index As Integer )
 Private Sub imgPulsanteForm_MouseDown ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgPulsanteForm_MouseMove ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgPulsanteForm_MouseUp ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub InitParamGraf ( )
 Private Sub InitTrend ( )
 Private Sub LoadImmaginiPulsantePlus ( Index As Integer,  Stato As StatoPulsantePlus )
 Private Sub PasswordLevel ( )
 Private Sub RefreshGraph ( )
 Private Sub RefreshGraphParam ( )
 Private Sub TextTempBrucSet_Dblclick ( )
 Private Sub TimerGraficoBruciatore_Timer ( )
 Private Sub txtCorrManSetPosMod_DblClick ( )
Documentation:

Form "FormProgRiscaldamentiCaldaie"

Public:


Methods:
 Public Sub AggiornaGraficaProgrammazione ( )
 Public Sub UpdatePulsantiForm ( )
Private:


Types:
 Private Enum TopBarButtonEnum 
Properties:
 Private PulsanteUpd ( 0 To ( TopBarButtonEnum. TBB_LAST - 1 ) )
 Private PulsanteUpdForm As Boolean
 Private selectedButtonIndex As Integer 
Methods:
 Private Sub APButtonInclusioneProg_Click ( )
 Private Sub ComboTipoProg_Click ( )
 Private Sub Form_Load ( )
 Private Sub Form_MouseMove ( Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgPulsanteForm_Click ( Index As Integer )
 Private Sub imgPulsanteForm_MouseDown ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgPulsanteForm_MouseMove ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgPulsanteForm_MouseUp ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub LoadImmaginiPulsantePlus ( Index As Integer,  stato As StatoPulsantePlus )
 Private Sub TextMinOFF_Change ( Index As Integer )
 Private Sub TextMinON_LostFocus ( Index As Integer )
 Private Sub TextOraOFF_LostFocus ( Index As Integer )
 Private Sub TextOraON_LostFocus ( Index As Integer )
 Private Sub TextSecOFF_Change ( Index As Integer )
 Private Sub TextSecON_LostFocus ( Index As Integer )
Documentation:

Form "FrmCalcolaImpasti"

Public:


Methods:
 Public Sub UpdatePulsantiForm ( )
Private:


Types:
 Private Enum TopBarButtonEnum 
Properties:
 Dim AperturaForm As Boolean
 Dim ImpastoPrecedente As Integer
 Private PulsanteUpd ( 0 To ( TopBarButtonEnum. TBB_LAST - 1 ) )
 Private PulsanteUpdForm As Boolean
 Private selectedButtonIndex As Integer 
Methods:
 Private Sub Form_Load ( )
 Private Sub Form_MouseMove ( Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgPulsanteForm_Click ( Index As Integer )
 Private Sub imgPulsanteForm_MouseDown ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgPulsanteForm_MouseMove ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgPulsanteForm_MouseUp ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub LoadImmaginiPulsantePlus ( Index As Integer,  stato As StatoPulsantePlus )
 Private Function NumeroImpastiCalcolato ( totale As Double,  Impasto As Integer ) As Double
 Private Sub TxtCalcolo_Change ( Index As Integer )
 Private Sub TxtCalcolo_DblClick ( Index As Integer )
 Private Sub TxtCalcolo_LostFocus ( Index As Integer )
Documentation:

Form "FrmCalibBilCamion"

Public:


Methods:
 Public Sub UpdatePulsantiForm ( )
Private:


Types:
 Private Enum TopBarButtonEnum 
Properties:
 Private PulsanteUpd ( 0 To ( TopBarButtonEnum. TBB_LAST - 1 ) )
 Private PulsanteUpdForm As Boolean
 Private selectedButtonIndex As Integer 
Methods:
 Private Sub AggiornaDatiForm ( )
 Private Sub chk420ma_Click ( )
 Private Sub cmdCalibrazione_Click ( Index As Integer )
 Private Sub Form_Load ( )
 Private Sub Form_MouseMove ( Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgPulsanteForm_Click ( Index As Integer )
 Private Sub imgPulsanteForm_MouseDown ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgPulsanteForm_MouseMove ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgPulsanteForm_MouseUp ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub LoadImmaginiPulsantePlus ( Index As Integer,  stato As StatoPulsantePlus )
 Private Sub SalvaParametri ( )
 Private Sub txtAnalogMax_Change ( )
 Private Sub txtAnalogMax_LostFocus ( )
 Private Sub txtAnalogMin_Change ( )
 Private Sub txtAnalogMin_LostFocus ( )
 Private Sub txtKgMin_Change ( )
 Private Sub txtKgMin_LostFocus ( )
 Private Sub txtValueX_Change ( Index As Integer )
 Private Sub txtValueX_LostFocus ( Index As Integer )
 Private Sub txtValueY_Change ( Index As Integer )
 Private Sub txtValueY_LostFocus ( Index As Integer )
Documentation:

Form "FrmComandiCisterne"

Public:


Methods:
 Public Sub UpdatePulsantiForm ( )
Private:


Constants:
 Private Const NUMCOMANDI As Integer = 13
 Private Const TimeOut As Integer = 3 
Types:
 Private Enum TopBarButtonEnum 
Properties:
 Private PulsanteUpd ( 0 To ( TopBarButtonEnum. TBB_LAST - 1 ) )
 Private PulsanteUpdForm As Boolean
 Private selectedButtonIndex As Integer
 Private TempoComando ( 0 To NUMCOMANDI - 1 ) As Long 
Methods:
 Private Sub APButtonAgitatore_Click ( Index As Integer )
 Private Sub APButtonCmd_Click ( indice As Integer )
 Private Sub CmdRefresh ( indice As Integer )
 Private Sub Form_Activate ( )
 Private Sub Form_Load ( )
 Private Sub Form_MouseMove ( Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgPulsanteForm_Click ( Index As Integer )
 Private Sub imgPulsanteForm_MouseDown ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgPulsanteForm_MouseMove ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgPulsanteForm_MouseUp ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub LoadImmaginiPulsantePlus ( Index As Integer,  stato As StatoPulsantePlus )
 Private Sub PosizionaFrameSupp ( )
 Private Sub TmrCmdOn_Timer ( )
 Private Sub TxtTempMesc_GotFocus ( )
 Private Sub TxtTempMesc_LostFocus ( )
Documentation:

Form "FrmGestioneTimer"

Public:

Private:


Methods:
 Private Sub AttesaSpegnimento_Timer ( )
 Private Sub DeodoranteSili_Timer ( )
 Private Sub EmergenzaMotori_Timer ( )
 Private Sub FiltraCmd_Timer ( )
 Private Sub PlusForcingStop_Timer ( )
 Private Sub RitardoRitrasmPar_Timer ( )
 Private Sub RitardoStartBruc_Timer ( )
 Private Sub TimerAbilitaControlloAllarmi_Timer ( )
 Private Sub TimerAbilitaSiliDeposito_Timer ( )
 Private Sub TimerAbortBatch_Timer ( )
 Private Sub TimerAckAllarmiDB61_Timer ( )
 Private Sub TimerAckAllarmiSiloS7_Timer ( )
 Private Sub TimerAggregatiMan_Timer ( )
 Private Sub TimerAltaTemperaturaScivolo_Timer ( Index As Integer )
 Private Sub timerApparecchiaturaLEC1_Timer ( )
 Private Sub TimerArrestoFilleriz_Timer ( )
 Private Sub TimerArrestoPredosatori_Timer ( )
 Private Sub TimerArrestoUrgenza_Timer ( )
 Private Sub TimerAttesaRegolazioneAriaFredda_Timer ( )
 Private Sub TimerAzzeraStartDosaggio_Timer ( )
 Private Sub TimerBassaTemperaturaScivolo_Timer ( Index As Integer )
 Private Sub TimerBennaPiena_Timer ( )
 Private Sub TimerBitumeMan_Timer ( )
 Private Sub TimerCompresFilleriz_Timer ( )
 Private Sub TimerComunicazionePLUS_Timer ( )
 Private Sub TimerDeflettoreBypassRap_Timer ( )
 Private Sub TimerDeflettoreRiciclato_Timer ( )
 Private Sub TimerErrMsgQuit_Timer ( )
 Private Sub TimerFillerMan_Timer ( )
 Private Sub TimerGestioneFiltro_Timer ( )
 Private Sub TimerImpulsoRegolazioneAriaFredda_Timer ( )
 Private Sub TimerLCPC_Timer ( )
 Private Sub TimerLCPC1sec_Timer ( )
 Private Sub TimerLCPC5sec_Timer ( )
 Private Sub TimerLivelloAltoSilo_Timer ( Index As Integer )
 Private Sub TimerMixerPieno_Timer ( )
 Private Sub TimerParametriDaPlc_Timer ( )
 Private Sub TimerResetTrasfVelDef_Timer ( )
 Private Sub TimerRiciclatoMan_Timer ( )
 Private Sub TimerRitardoChiusuraPortinaSIWA_Timer ( )
 Private Sub TimerRitardoSbloccoBruciatore_Timer ( )
 Private Sub TimerRitornoComandi_Timer ( Index As Integer )
 Private Sub TimerSiwa_Refresh_Timer ( Index As Integer )
 Private Sub TimerSpegniNastroAuxRiciclato_Timer ( )
 Private Sub TimerSpegniNC_Timer ( )
 Private Sub TimerStopDosaggioBatchManuale_Timer ( )
 Private Sub TimerTagCambioVolo_Timer ( )
 Private Sub TimerTaraturaSIWA_Timer ( )
 Private Sub TimerTrend_Timer ( )
 Private Sub TimerVariazioneGrandezzaDosaggio_Timer ( )
 Private Sub TimerViatopMan_Timer ( )
 Private Sub TimerViatopScarMixer1Man_Timer ( )
 Private Sub TimerViatopScarMixer2Man_Timer ( )
 Private Sub TimerVibrCaricoFApp_Timer ( )
 Private Sub TimerVibrCaricoFApp2_Timer ( )
 Private Sub TmoutSemaforoBenna_Timer ( )
 Private Sub TmoutSemaforoSili_Timer ( )
 Private Sub TmrAttesaFiltrofreddo_Timer ( )
 Private Sub TmrBindicatorApporto_Timer ( )
 Private Sub TmrBindicatorRecupero_Timer ( )
 Private Sub TmrCmdBruciatore_Timer ( )
 Private Sub TmrCodaMateriale_Timer ( )
 Private Sub tmrImpulsoRegBruc_Timer ( Index As Integer )
 Private Sub TmrKeyPressAndMouseMove_Timer ( )
 Private Sub TmrSchiumato_Timer ( )
 Private Sub TmrSetPredosatori_Timer ( )
 Private Sub TmrSoffioPredVuoto_Timer ( )
 Private Sub TmrSyncroCmdSiloS7_Timer ( )
 Private Sub TmrVibratorePredVuoto_Timer ( )
 Private Sub TrmNastroDeflettoreAnello_Timer ( )
Documentation:

Form "FrmInversionePCL"

Public:


Methods:
 Public Sub ControllaPCL ( Index )
 Public Sub ShowMe ( Modo As Integer,  ByRef parent As Form )
 Public Sub UpdatePulsantiForm ( )
Private:


Types:
 Private Enum TopBarButtonEnum 
Properties:
 Private OraStartPCL ( 1 To 5 ) As Long
 Private PulsanteUpd ( 0 To ( TopBarButtonEnum. TBB_LAST - 1 ) )
 Private PulsanteUpdForm As Boolean
 Private selectedButtonIndex As Integer 
Methods:
 Private Sub APButtonStartStopMotore_Click ( Index As Integer )
 Private Sub Form_Load ( )
 Private Sub Form_MouseMove ( Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgPulsanteForm_Click ( Index As Integer )
 Private Sub imgPulsanteForm_MouseDown ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgPulsanteForm_MouseMove ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgPulsanteForm_MouseUp ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub LoadImmaginiPulsantePlus ( Index As Integer,  stato As StatoPulsantePlus )
 Private Sub StartInversione ( Index As Integer,  start As Boolean )
 Private Sub TimerControllo_Timer ( )
 Private Sub TxtTempo_Change ( Index As Integer )
 Private Sub TxtTempo_LostFocus ( Index As Integer )
Documentation:

Form "FrmNetti"

Public:


Methods:
 Public Sub DatiStatusBil_Change ( )
 Public Sub RefreshTagDatiStatusBil ( )
 Public Sub UpdatePulsantiForm ( )
Private:


Types:
 Private Enum TopBarButtonEnum 
Properties:
 Private NumFrameStatusBilAttivi As Integer
 Private PulsanteUpd ( 0 To ( TopBarButtonEnum. TBB_LAST - 1 ) )
 Private PulsanteUpdForm As Boolean
 Private selectedButtonIndex As Integer 
Methods:
 Private Sub CmdResetContalitri_LostFocus ( )
 Private Sub CmdResetContalitri_MouseDown ( Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub CmdResetContalitri_MouseUp ( Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub DisponiFrameStatus ( )
 Private Sub ExportScaleStatus ( )
 Private Sub Form_Activate ( )
 Private Sub Form_Load ( )
 Private Sub Form_MouseMove ( Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgPulsanteForm_Click ( Index As Integer )
 Private Sub imgPulsanteForm_MouseDown ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgPulsanteForm_MouseMove ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgPulsanteForm_MouseUp ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub LoadImmaginiPulsantePlus ( Index As Integer,  stato As StatoPulsantePlus )
 Private Sub TimerManualeFiller1_Timer ( )
 Private Sub TimerManualeFiller2_Timer ( )
 Private Sub TimerManualeFiller3_Timer ( )
Documentation:

Form "FrmNewValue"

Public:


Methods:
 Public Function InputDoubleValue ( ByRef parent As Form,  oldValue As Double,  minValue As Double,  maxValue As Double ) As Double
 Public Function InputLongValue ( ByRef parent As Form,  oldValue As Long,  minValue As Long,  maxValue As Long ) As Long
 Public Function InputStringValue ( ByRef parent As Form,  oldValue As String ) As String
Private:


Types:
 Private Enum EditEnum 
Properties:
 Private EditType As EditEnum 
Methods:
 Private Sub CmdEsci_Click ( )
 Private Sub CmdOK_Click ( )
 Private Function ControlloOK ( newValue As Variant,  minValue As Variant,  maxValue As Variant ) As Boolean
 Private Sub Form_Load ( )
 Private Sub TxtNewValue_KeyPress ( KeyAscii As Integer )
Documentation:

Form "FrmSchiumatura"

Public:


Methods:
 Public Sub AggiornaStatoSchiumato ( )
 Public Sub ShowMe ( ByVal Modo As Integer,  ByRef parente As Form )
Private:


Methods:
 Private Sub AbilitaInterfaccia ( )
 Private Sub AniP_Automatico_Click ( )
 Private Sub ApbPompaAcqua_Click ( )
 Private Sub ApbPompaBitume_Click ( )
 Private Sub ApbPompaBitumeSoft_Click ( )
 Private Sub ApbValvAcqua_Click ( )
 Private Sub ApbValvBitume_Click ( )
 Private Sub ApbValvBitumeSoft_Click ( )
 Private Sub ApbValvImmissAcqua_Click ( )
 Private Sub ApbValvImmissBitume_Click ( )
 Private Sub ApbValvImmissBitumeSoft_Click ( )
 Private Sub ApbValvImmissSolvente_Click ( )
 Private Sub ApbValvImmissSolvente_LostFocus ( )
 Private Sub ApbValvImmissSolvente_MouseDown ( Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub ApbValvImmissSolvente_MouseUp ( Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub CmdEsci_Click ( )
 Private Sub CmdHelp_Click ( )
 Private Sub CmdVersoPompaBitume_Click ( )
 Private Sub CmdVersoPompaBitumeSoft_Click ( )
 Private Sub Form_Load ( )
 Private Sub TmrScansione_Timer ( )
 Private Sub UpDownH2O_Change ( )
 Private Sub UpDownHard_Change ( )
 Private Sub UpDownPercentoBitume_Change ( )
 Private Sub UpDownPercentoBitumeSoft_Change ( )
 Private Sub UpDownSoft_Change ( )
Documentation:

Form "FrmSiloGenerale"

Public:


Methods:
 Public Sub CmdStart_Click ( )
 Public Sub CmdStop_MouseDown ( Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Public Sub CmdSyncroBennaAsse_Click ( Index As Integer )
 Public Sub ColoraSilo ( silo As Integer,  siloAttivo As Boolean,  ritornoSilo As Boolean )
 Public Sub PasswordLevel ( )
 Public Sub PosizionaSili ( )
 Public Sub ShowMe ( ByRef parente As Form )
 Public Sub SiloS7VisualizzaPosSili ( )
 Public Sub UpdatePulsantiForm ( )
Private:


Constants:
 Private Const SEZIONE As String = "Sili" 
Types:
 Private Enum TopBarButtonEnum 
Properties:
 Private PulsanteUpd ( 0 To ( TopBarButtonEnum. TBB_LAST - 1 ) )
 Private PulsanteUpdForm As Boolean
 Private selectedButtonIndex As Integer 
Methods:
 Private Sub CmdApriBenna_Click ( )
 Private Sub CmdAutoMan_MouseDown ( Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub CmdChiudiBenna_Click ( )
 Private Sub CmdDX_Click ( )
 Private Sub CmdEnableJog_MouseDown ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub CmdGIU_Click ( )
 Private Sub CmdJogDX_LostFocus ( Index As Integer )
 Private Sub CmdJogDX_MouseDown ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub CmdJogDX_MouseUp ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub CmdJogSX_LostFocus ( Index As Integer )
 Private Sub CmdJogSX_Mousedown ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub CmdJogSX_MouseUp ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub CmdSiloS7SalvaPos_Click ( Index As Integer )
 Private Sub CmdSiloS7SalvaPosAd1_Click ( Index As Integer )
 Private Sub CmdSiloS7SalvaPosAd2_Click ( Index As Integer )
 Private Sub CmdSiloS7SalvaPosD_Click ( Index As Integer )
 Private Sub CmdSiloS7SalvaPosR_Click ( Index As Integer )
 Private Sub CmdSU_Click ( )
 Private Sub CmdSX_Click ( )
 Private Sub CopyValues ( )
 Private Sub Form_Activate ( )
 Private Sub Form_Load ( )
 Private Sub Form_MouseMove ( Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgPulsanteForm_Click ( Index As Integer )
 Private Sub imgPulsanteForm_MouseDown ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgPulsanteForm_MouseMove ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgPulsanteForm_MouseUp ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Function IsModified ( ) As Boolean
 Private Sub LoadImmaginiPulsantePlus ( Index As Integer,  stato As StatoPulsantePlus )
 Private Sub PosizionaElementiPosSiloS7 ( )
 Private Sub Salva_Dati ( )
 Private Sub TabSilo_Click ( PreviousTab As Integer )
 Private Sub TxtSiloS7Pos_Change ( Index As Integer )
 Private Sub TxtSiloS7Pos_LostFocus ( Index As Integer )
 Private Sub TxtSiloS7PosD_Change ( Index As Integer )
 Private Sub TxtSiloS7PosD_LostFocus ( Index As Integer )
 Private Sub TxtSiloS7PosizioneAntiadesivoAux_Change ( Index As Integer )
 Private Sub TxtSiloS7PosizioneAntiadesivoMain_Change ( Index As Integer )
 Private Sub TxtSiloS7PosR_Change ( Index As Integer )
 Private Sub TxtSiloS7PosR_LostFocus ( Index As Integer )
Documentation:

Form "FrmSiwarexPara"

Public:


Methods:
 Public Function BilanciaAttiva ( ) As Integer
 Public Sub PasswordLevel ( )
 Public Sub ShowMe ( Modo As Integer,  ByRef parent As Form,  bilancia As Integer )
 Public Sub TxtDR3_Change ( Index As Integer )
 Public Sub TxtDR3_LostFocus ( Index As Integer )
 Public Sub TxtDR5_Change ( Index As Integer )
 Public Sub TxtDR5_LostFocus ( Index As Integer )
 Public Sub UpdatePulsantiForm ( )
Private:


Constants:
 Private Const TempoAttesaRilettura As Integer = 3 
Types:
 Private Enum TopBarButtonEnum 
Properties:
 Private appoggio As Integer
 Private Calibrazione As Boolean
 Private ConteggioAttesa As Long
 Private indiceDR As Integer
 Private m_bilancia As SiwarexEnum
 Private OraAttuale As Long
 Private PulsanteUpd ( 0 To ( TopBarButtonEnum. TBB_LAST - 1 ) )
 Private PulsanteUpdForm As Boolean
 Private selectedButtonIndex As Integer
 Private StepDR03 As Integer
 Private StepDR30 As Integer
 Private StepDR33 As Integer
 Private StepEsciSiwa As Integer
 Private StepPesoCampione As Integer
 Private StepZero As Integer 
Methods:
 Private Sub CmbCellaSiwa_click ( )
 Private Sub CmbFiltroSiwa_Click ( )
 Private Sub CmdAutozero_Click ( )
 Private Sub CmdCommandInput_Click ( )
 Private Sub CmdErrorQuit_Click ( )
 Private Sub CmdInviaSiwa_Click ( )
 Private Sub CmdLeggiSiwa_Click ( )
 Private Sub CmdNastro_Click ( Index As Integer )
 Private Sub CmdPesoCampione_Click ( )
 Private Sub CmdResetTot_Click ( Index As Integer )
 Private Sub CmdSalva_Click ( )
 Private Sub CmdStampa_Click ( )
 Private Sub CmdZero_Click ( )
 Private Sub Form_Load ( )
 Private Sub Form_MouseMove ( Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub FormToStruct ( )
 Private Sub imgPulsanteForm_Click ( Index As Integer )
 Private Sub imgPulsanteForm_MouseDown ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgPulsanteForm_MouseMove ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgPulsanteForm_MouseUp ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Function IsModified ( ) As Boolean
 Private Sub LblTabPara_Click ( Index As Integer )
 Private Sub LoadImmaginiPulsantePlus ( Index As Integer,  stato As StatoPulsantePlus )
 Private Sub LogExportFile ( )
 Private Sub StructToForm ( )
 Private Sub TimerAttesaCambioDR_Timer ( )
 Private Sub TimerAttesaRilettura_Timer ( )
 Private Sub TimerDR03_Timer ( )
 Private Sub TimerDR30_Timer ( )
 Private Sub TimerEsciServiceMode_Timer ( )
 Private Sub TimerPesoCampione_Timer ( )
 Private Sub TimerProgrssBarInvia_Timer ( )
 Private Sub TimerProgrssBarLeggi_Timer ( )
 Private Sub TimerScriviDR3_Timer ( )
 Private Sub TimerScriviDR5_Timer ( )
 Private Sub TimerTotalizer_Timer ( )
 Private Sub TimerZero_Timer ( )
 Private Sub TxtCommandInput_Change ( )
 Private Sub TxtCommandInput_LostFocus ( )
Documentation:

Form "FrmStatoPredosatori"

Public:


Methods:
 Public Sub AggiornaVolumetricoPonderale ( )
 Public Sub ShowMe ( Modo As Integer,  ByRef parent As Form )
 Public Sub UpdatePulsantiForm ( )
Private:


Types:
 Private Enum TopBarButtonEnum 
Properties:
 Private FlashColorOn As Boolean
 Private FlashTime As Long
 Private PulsanteUpd ( 0 To ( TopBarButtonEnum. TBB_LAST - 1 ) )
 Private PulsanteUpdForm As Boolean
 Private selectedButtonIndex As Integer 
Methods:
 Private Sub CmdPonderale_Click ( Index As Integer )
 Private Sub CmdRitardato_Click ( Index As Integer )
 Private Sub cmdSoffio_Click ( Index As Integer )
 Private Sub cmdVibratore_Click ( Index As Integer )
 Private Sub Form_Load ( )
 Private Sub Form_MouseMove ( Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgPulsanteForm_Click ( Index As Integer )
 Private Sub imgPulsanteForm_MouseDown ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgPulsanteForm_MouseMove ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgPulsanteForm_MouseUp ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub LoadImmaginiPulsantePlus ( Index As Integer,  stato As StatoPulsantePlus )
 Private Sub PonderaleOnOff ( ByRef Pred As PredosatoreType )
 Private Sub Rinfresca ( )
 Private Sub RinfrescaPredosatore ( Pred As PredosatoreType )
 Private Sub RitardatoOnOff ( ByRef Pred As PredosatoreType )
 Private Sub SistemaFramePredosatori ( )
 Private Sub TmrRefresh_Timer ( )
 Private Sub VisualizzaPonderale ( ByRef Pred As PredosatoreType )
 Private Sub VisualizzaRitardato ( ByRef Pred As PredosatoreType )
 Private Sub VisualizzaSoffio ( ByRef Pred As PredosatoreType )
 Private Sub VisualizzaVibratore ( ByRef Pred As PredosatoreType )
Documentation:

Form "FrmTaraBilancePN"

Public:


Methods:
 Public Sub PasswordLevel ( )
 Public Sub SetVisibleReset ( ByVal newActiveUser As UsersEnum )
 Public Sub ShowMe ( Modo As Integer,  ByRef parent As Form )
 Public Sub UpdatePulsantiForm ( )
Private:


Types:
 Private Enum TopBarButtonEnum 
Properties:
 Private PulsanteUpd ( 0 To ( TopBarButtonEnum. TBB_LAST - 1 ) )
 Private PulsanteUpdForm As Boolean
 Private selectedButtonIndex As Integer 
Methods:
 Private Sub BtnReset_Click ( )
 Private Sub CaricaTraduzioniForm ( )
 Private Sub cmbListaBilance_Click ( )
 Private Sub CmdCalibrate_Click ( )
 Private Sub CmdTare_Click ( )
 Private Sub Command1_Click ( )
 Private Sub ConfigurazioneComboBil ( )
 Private Sub Form_Load ( )
 Private Sub Form_MouseMove ( Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgPulsanteForm_Click ( Index As Integer )
 Private Sub imgPulsanteForm_MouseDown ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgPulsanteForm_MouseMove ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgPulsanteForm_MouseUp ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub LoadImmaginiPulsantePlus ( Index As Integer,  Stato As StatoPulsantePlus )
 Private Sub TmrCmdRunning_Timer ( )
 Private Sub TxtSampleWeight_LostFocus ( )
Documentation:

Form "FrmTestPredosatori"


Controllo Accensione Vaglio,ElevCaldo,Tamburo Function Controllomotori() As Long Controllomotori = 0 20150309 If (Not ListaMotori(MotoreVaglio).ritorno And (PLCTAG_DI_TorVagliato And Not PLCTAG_DI_TorNonVagliato)) Then If (Not ListaMotori(MotoreVaglio).ritorno And (CP240.OPCData.items(PLCTAG_DI_TorVagliato).Value And Not CP240.OPCData.items(PLCTAG_DI_TorNonVagliato).Value)) Then
Controllomotori = 3 Exit Function End If If (Not ListaMotori(MotoreElevatoreCaldo).ritorno) Then Controllomotori = 4 Exit Function End If If (Not ListaMotori(MotoreRotazioneEssiccatore).ritorno) Then Controllomotori = 5 Exit Function End If

20160107 If (Not ListaMotori(MotoreNastroElevatoreFreddo).ritorno) Then Può essere acceso se non ho linversione del lanciatore/freddo If (AbilitaInversioneLanciatore And ListaMotori(MotoreNastroElevatoreFreddo).ritorno) Then Controllomotori = 6 Exit Function End If End Function

Public:


Methods:
 Public Sub AbilitaTest ( abilita As Boolean )
 Public Sub ControllaNastri ( motore As Integer )
 Public Sub ControlloMotoriDuranteTestPredosatori ( )
 Public Sub ControlloPredosatore ( start As Boolean )
 Public Sub MemorizzaValoriPredosatori ( )
 Public Sub RiportaValoriPredosatori ( )
 Public Sub ShowMe ( Modo As Integer,  ByRef parent As Form )
 Public Sub UpdatePulsantiForm ( )
Private:


Types:
 Private Enum TopBarButtonEnum 
Properties:
 Private almenounostart As Boolean
 Private ConteggioSecondiPredosatori As Long
 Private OraStartTestPredosatore As Long
 Private PulsanteUpd ( 0 To ( TopBarButtonEnum. TBB_LAST - 1 ) )
 Private PulsanteUpdForm As Boolean
 Private selectedButtonIndex As Integer
 Private ValPred ( 0 To MAXPREDOSATORI + MAXPREDOSATORIRICICLATO - 1 ) As Integer 
Methods:
 Private Sub CheckCollector ( )
 Private Sub CheckNEF_Click ( )
 Private Sub ChkInversioneRic_Click ( )
 Private Sub CmdSiwarex_Click ( Index As Integer )
 Private Function ControlliOK ( startMotor As Boolean ) As Long
 Private Sub Form_Activate ( )
 Private Sub Form_Load ( )
 Private Sub Form_MouseMove ( Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub ImgMotorTest_Click ( Index As Integer )
 Private Sub imgPulsanteForm_Click ( Index As Integer )
 Private Sub imgPulsanteForm_MouseDown ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgPulsanteForm_MouseMove ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub imgPulsanteForm_MouseUp ( Index As Integer,  Button As Integer,  Shift As Integer,  x As Single,  Y As Single )
 Private Sub LoadImmaginiPulsantePlus ( Index As Integer,  Stato As StatoPulsantePlus )
 Private Sub SSTabTara_Click ( PreviousTab As Integer )
 Private Sub Stop_Test ( )
 Private Sub TimerControlloMotori_Timer ( )
 Private Sub TimerProvaPredosatori_Timer ( )
 Private Sub TxtCalcolo_KeyPress ( Index As Integer,  KeyAscii As Integer )
 Private Sub TxtCalcolo_LostFocus ( Index As Integer )
 Private Sub TxtNumSecondi_LostFocus ( )
 Private Sub TxtSecRic_LostFocus ( )
 Private Sub TxtSet_LostFocus ( )
 Private Sub TxtSetRic_LostFocus ( )
 Private Sub UpdateCalcolo ( )
 Private Sub UpdateCalcoloTonH ( )
Documentation:

Module "GestioneAdditivi"

Public:


Properties:
 Public AbilitaInversioneAdditivoBacinella As Boolean
 Public AgitatoreBacinella As Boolean
 Public ContalitriImpulsiLitro As Double
 Public ContalitriTempoMaxSpruzzatura As Integer
 Public DensitaContalitri As Double
 Public InclusioneAgitatore As Boolean
 Public InclusioneAquablack As Boolean
 Public MaxValKgAquablack As Double
 Public VoltMaxContalitri As Integer
 Public VoltMinContalitri As Integer 
Methods:
 Public Sub AdditivoAcqua ( inMoto As Boolean )
 Public Sub AdditivoNellaBacinella ( inMoto As Boolean )
 Public Sub AdditivoNelMixer ( inMoto As Boolean )
 Public Sub AdditivoSacchi ( inMoto As Boolean )
 Public Sub AntiadesivoScivoloScaricoBilanciaRAP ( inMoto As Boolean )
 Public Sub AntiadesivoScivoloScaricoBilanciaRAP_change ( )
 Public Sub BilanciaViatopScarMixerPeso_change ( Index As Integer )
 Public Sub GestioneAdditivoSacchi ( )
 Public Sub GestioneImmagineCompressoreViatopScarMixer ( Index As Integer )
 Public Sub GestioneSicurezzaViatopScarMixer ( Index As Integer )
 Public Sub PesataViatopScarMixer_change ( Index As Integer )
 Public Sub ScaricoAcqua_change ( )
 Public Sub ScaricoAdditivo_change ( additivo As Integer )
 Public Sub ScaricoViatopScarMixer_change ( Index As Integer )
Private:

Documentation:

Module "GestioneAllarmi"

Public:


Constants:
 Public Const MAXNUMALLARMI = 3000 
Types:
 Public Type AllarmiDosaggioType
 Type CampiAllarmi 
Properties:
 Public AbilitaControlloAllarmi As Integer
 Public AllarmeCicalino As Boolean
 Public AllarmeTemporaneoGiaVisualizzato ( 500 ) As Boolean
 Public AllarmiDosaggio ( 20 ) As AllarmiDosaggioType
 Public BilanciaFillerPortinaChiusa As Boolean
 Public BilanciaInertiPortinaAperta As Boolean
 Public BilanciaInertiPortinaChiusa As Boolean
 Public BloccoSpruzzaturaAltaTemp As Boolean
 Public ComandoScaricoAggregati As Boolean
 Public ComandoScaricoBitume As Boolean
 Public ComandoScaricoFiller As Boolean
 Public ComandoScaricoMixer As Boolean
 Public CompressoreBruciatore2PressioneInsuff As Boolean
 Public CompressoreBruciatorePressioneInsuff As Boolean
 Public IngressoAllarme ( 0 To MAXNUMALLARMI - 1 ) As CampiAllarmi
 Public OraAllarmeDepressioneFiltro As Long
 Public OraAllarmeTemperaturaBitume As Long
 Public OraAllarmeTemperaturaIngressoFiltro As Long
 Public OraAltaTemperaturaScivolo As Long
 Public OraErroreDeflettoreVaglio As Long
 Public OraErrorePortinaAggregati As Long
 Public OraErrorePortinaFiller As Long
 Public OraErrorePortinaMixer As Long
 Public PressioneAriaInsufficente As Boolean
 Public ProgrammaAvviato As Boolean
 Public Sec10AltaScivolo As Boolean
 Public Sec10AltaScivolo2 As Boolean
 Public Sec10BassaScivolo As Boolean
 Public Sec10BassaScivolo2 As Boolean
 Public TempoPermanenza_AllarmeTemperaturaScivolo As Integer
 Public ValoreAltoTroppoPieno As Boolean 
Methods:
 Public Sub AllarmeTemporaneo ( Codice As String,  presente As Boolean )
 Public Sub AllarmeTemporaneoFull ( codiceNumerico As Integer,  Codice As String,  presente As Boolean,  controlla As Boolean )
 Public Sub AzzeraAllarmiSospesi ( )
 Public Sub BloccoSpruzzaturaAltaTemp_change ( )
 Public Sub ControllaIngressiAllarmi ( )
 Public Sub ControllaPortineAllarmi ( ByRef IdDescrizione As Integer,  ByRef IndirizzoPLC As String )
 Public Sub ControllaTemperatureAllarmi ( ByRef IdDescrizione As Integer,  ByRef IndirizzoPLC As String )
 Public Sub ControlloAllarmi ( )
 Public Sub DB61_GestioneAllarmi ( ByRef IdDescrizione As Integer,  ByRef IndirizzoPLC As String )
 Public Function FuncAllarmeSlittamentoMotore ( allsensore As Boolean,  ritmotore As Boolean,  ByRef orastartallarme As Long,  temporitallarme As Long ) As Boolean
 Public Sub GestioneSicurezzeBilance ( ByRef IdDescrizione As Integer,  ByRef IndirizzoPLC As String )
 Public Sub IngressoAllarmePresente ( indice As Integer,  valore As Boolean )
 Public Sub SetAllarmePresente ( Codice As String,  presente As Boolean )
 Public Function SogliaSuperata ( valore As Integer,  Soglia As Integer,  AoB As String ) As Integer
Private:


Methods:
 Private Function AllarmePompeCircolazioneLegante ( ) As Boolean
 Private Sub IngressoAllarme_change ( indice As Integer )
Documentation:

Module "GestioneAmperometri"

Public:


Types:
 Public Enum AmperometroEnum
 Public Type AmperometroType 
Properties:
 Public ListaAmperometri ( 0 To ( MAXAMPEROMETRI - 1 ) ) 
Methods:
 Public Function FiltroAmperometro ( amp As Integer,  Value As Integer ) As Integer
 Public Sub ValoreAmperometri_change ( amp As Integer )
 Public Sub ValoreAmperometriBar_change ( amp As Integer )
Private:


Constants:
 Private Const MAXFILTROAMPEROMETRI As Integer = 5
Documentation:

Module "GestioneAquablack"

Public:


Types:
 Public Type Aquablack_Digital_Type
 Public Type Aquablack_HMI_PLC_Type
 Public Type Aquablack_Recipe
 Public Type AquablackAlarmType
 Public Type AquablackParametersType
 Public Enum AquablackTuboContenuto
 Public Enum PlcAquablackType 
Properties:
 Public Aquablack_Digital As Aquablack_Digital_Type
 Public Aquablack_HMI_PLC As Aquablack_HMI_PLC_Type
 Public AquablackAlarm As AquablackAlarmType
 Public AquablackParameter As AquablackParametersType
 Public AquablackRecipeActual As Aquablack_Recipe
 Public AquablackRecipeNext As Aquablack_Recipe
 Public DosaggioAquablack_ChangeAtFlight_DosInStop As Boolean
 Public DosaggioAquablackNoStart As String
 Public tmrResetComandiAquablack As TemporizzatoreStandardType 
Methods:
 Public Sub AQ_Auto_Mode_Change ( )
 Public Sub AQ_Ciclo ( )
 Public Sub AQ_Gestione_StatoTubi ( )
 Public Sub AQ_Livello_Serbatoio_Change ( )
 Public Sub AQ_Manual_Mode_Change ( )
 Public Sub AQ_PLCConnection_Change ( )
 Public Sub AQ_Pompa_H2O_Change ( )
 Public Sub AQ_Reset_Comandi ( )
 Public Sub AQ_SchiumaturaAttiva_Change ( )
 Public Sub AQ_StatoPulsantiForm ( )
 Public Sub AQ_Valvola_H2O_Change ( )
 Public Sub AQ_Valvola_Purge_Change ( )
 Public Sub AQ_Valvola_Trickle_Change ( )
 Public Sub ControllaAquablackAllarmi ( ByRef IdDescrizione As Integer,  ByRef IndirizzoPLC As String )
 Public Sub LineaAquablack_Stato ( tubo As Line,  Stato As AquablackTuboContenuto )
 Public Sub PLCAquablack_InviaParametri ( )
 Public Sub PLCAquablack_LeggiTag ( )
 Public Sub PLCAquablack_ScriviTag ( )
 Public Function PlcAquablackConnessione ( connetti As Boolean ) As Boolean
 Public Function PlcAquablackConnesso ( ) As Boolean
 Public Sub PompaAquablack_Stato ( pompa As Image,  feedback As Boolean,  comando As Boolean,  Optional Errore As Boolean )
 Public Sub ValvolaAquablack_Stato ( valvola As Image,  feedback As Boolean,  comando As Boolean )
Private:


Properties:
 Private plcInAnalogici_Fatta As Boolean
 Private PlcInDigitali_Fatta As Boolean
Documentation:

Module "GestioneBit"

Public:


Methods:
 Public Function ClearBit ( InByte As Byte,  Bit As Byte ) As Byte
 Public Sub Init ( )
 Public Function IsBitSet ( InByte As Byte,  Bit As Byte ) As Boolean
 Public Function LShift ( ByVal lThis As Long,  ByVal lBits As Long ) As Long
 Public Function RShift ( ByVal lThis As Long,  ByVal lBits As Long ) As Long
 Public Function SetBit ( InByte As Byte,  Bit As Byte ) As Byte
 Public Function ToggleBit ( InByte As Byte,  Bit As Byte ) As Byte
Private:


Properties:
 Private m_lPower2 ( 0 To 31 ) As Long
Documentation:

Module "GestioneBruciatore"


20151108 Public Sub AggiornaGraficaValvolaCombustibile_Change()
CP240.Image1(49).Visible = Visibile If Not Visibile Then Exit Sub

If ValvolaDieselAperta Then CP240.Image1(49).Picture = LoadResPicture("IDB_VALVOLAON", vbResBitmap) Else CP240.Image1(49).Picture = LoadResPicture("IDB_VALVOLA", vbResBitmap) End If

End Sub

Public:


Constants:
 Public Const IndexGestioneFumiTamburo As Integer = 12 
Types:
 Public Enum CodiceColoriCasellaTemp
 Public Enum ModulatoreStatusEnum
 Public Type ModulatoreType
 Public Type TypeGestioneFumiTamburo
 Public Type TypeGestioneVelocitaTamburo 
Properties:
 Public avvCaldo_prenotazione As Boolean
 Public BrucAutoPreriscaldo As Boolean
 Public ChiusuraForzVelocitaTamburo As Boolean
 Public FormPIDBruc_Visible As Boolean
 Public GestioneFumiTamburo As TypeGestioneFumiTamburo
 Public GestioneVelocitaTamburo As TypeGestioneVelocitaTamburo
 Public ManualeAriaFredda As Boolean
 Public MaxTempEssicatore As Long
 Public MaxTempEssicatore2 As Long
 Public MinTempEssicatore As Long
 Public MinTempEssicatore2 As Long
 Public ModulatoreAriaFreddaFiltro As ModulatoreType
 Public ModulatoreAspirazioneFiltro As ModulatoreType
 Public NumeroLettureScivolo As Long
 Public OraStartPredosatori As Long
 Public OraStartPredosatoriRic As Long
 Public OraStopPredosatori As Long
 Public OraStopPredosatoriRic As Long
 Public StopFiammaDopoNastri As Boolean
 Public TamburoAssociatoAlPID As Integer
 Public TemperaturaLavoroFiltroOK As Boolean
 Public ValvolaDieselAperta As Boolean
 Public ValvolaDieselPresente As Boolean
 Public ValvolaOlioCombAperta As Boolean
 Public ValvolaOlioCombPresente As Boolean
 Public VisualizzaTempScambComb As Boolean 
Methods:
 Public Sub AbilitaAvvCaldo ( )
 Public Sub AggiornaGraficaValvolaCombustibile_Change ( )
 Public Sub AggiornaTemperaturaTorre ( )
 Public Sub AllarmeCombustibile ( tamburo As Integer,  inizializza As Boolean )
 Public Sub AllarmePerditaValvoleBruc_change ( tamburo As Integer )
 Public Sub AllarmePerditaValvoleBrucOC_change ( tamburo As Integer )
 Public Sub AllarmePressioneBrucAlta_change ( tamburo As Integer )
 Public Sub AltaTemperaturaFiltroSw ( )
 Public Sub AltaTemperaturaFumiTamburo ( tamburo As Integer )
 Public Sub AriaFreddaFiltroModulatore_change ( )
 Public Sub AriaTamburoModulatore_change ( tamburo As Integer,  apre As Boolean,  chiude As Boolean )
 Public Sub ArrestoBrucITT ( )
 Public Sub ArrestoBrucTempoX ( tamburo As Integer )
 Public Sub BloccoFiammaBruciatore_change ( tamburo As Integer )
 Public Sub BruciatoreInManuale ( tamburo As Integer )
 Public Sub BruciatoreModulatore_change ( tamburo As Integer )
 Public Sub BruciatorePosizioneAccensione_change ( tamburo As Integer )
 Public Function BrucInAccensione ( tamburo As Integer ) As Boolean
 Public Sub CompressoreBruciatorePressioneInsuff_change ( )
 Public Sub ConteggioTempoArrestoBruciatore ( tamburo As Integer )
 Public Sub ControlliFiammaBruciatore ( tamburo As Integer )
 Public Sub ControlloBloccoBruciatore ( tamburo As Integer )
 Public Sub ControlloCadutaTamburoFiamma ( tamburo As Integer )
 Public Sub DeflettoreAntincendioTamburo_change ( tamburo As Integer )
 Public Function DurataImpulsoAriaFredda ( DeltaTemperatura As Integer ) As Integer
 Public Sub FiammaBruciatorePresente_change ( tamburo As Integer )
 Public Sub FiltroModulatore_change ( )
 Public Sub GestioneFunzAutomaticoBruc ( tamburo As Integer )
 Public Sub GestioneModulatoreBruc ( tamburo As Integer )
 Public Sub ImpulsiContalitriCombustibile_change ( tamburo As Integer )
 Public Sub LetturaDepressioneBruciatore ( tamburo As Integer,  depressioneBruciatore As Long,  plcInAnalogici_Fatta As Boolean )
 Public Sub LetturaScivoloTamburo ( tamburo As Integer,  temperaturaScivolo As Long,  plcInAnalogici_Fatta As Boolean )
 Public Sub ModoRegolazioneDepressioneFiltroConDepressFiltroIN ( )
 Public Sub ModoRegolazioneDepressioneFiltroConDepressTamburo ( )
 Public Sub ModulatoreAspFiltro_change ( )
 Public Sub ModulatoreBruciatore_change ( tamburo As Integer )
 Public Sub ModulatoreFumiTamburo_change ( tamburo As Integer )
 Public Sub OlioCombInTemperatura_change ( tamburo As Integer )
 Public Sub PortaModASetAvvioCaldo ( tamburo As Integer )
 Public Function PortaModulatoreASet ( target As Long,  letturaposizione As Long,  Tolleranza As Integer,  ByRef fatto As Boolean ) As ModulatoreStatusEnum
 Public Sub PosizioneModulatoreAriaFredda_change ( )
 Public Sub PressioneInsufficienteOlioCombustibile_change ( tamburo As Integer )
 Public Sub RegolazioneAriaAspiratore ( )
 Public Sub RegolazioneAriaFredda ( )
 Public Sub RegolazioneImpulsoAriaFredda ( UpDown As Integer,  DeltaTemperatura As Integer )
 Public Sub SicurezzaTempOlioComb_change ( tamburo As Integer )
 Public Sub StartBruciatore ( tamburo As Integer )
 Public Sub StartBruciatoreDaPLC_change ( tamburo As Integer )
 Public Sub StopBruciatore ( tamburo As Integer )
 Public Sub StopBruciatoreTamburo ( tamburo As Integer )
 Public Sub TempEntrataFiltro_change ( )
 Public Sub TempFumiTamburo_change ( tamburo As Integer )
 Public Sub TempIngressoTamburo_change ( )
 Public Sub TempScambComb_change ( )
 Public Sub TempSondaAggiuntivaUscitaTamburo_change ( )
 Public Sub TempSottoMesc_change ( )
 Public Sub TempTorre_change ( Index As Integer,  temperatura As Long )
 Public Sub TempUscitaFiltro_change ( )
 Public Function ValoreForchetta ( valore As Double,  min As Double,  max As Double,  SoloPositivo As Boolean ) As Double
 Public Sub ValoreLettoDepressioneBruc_change ( tamburo As Integer )
 Public Sub ValoreLettoTempScivolo_change ( tamburo As Integer )
 Public Function VerificaCondizioniAvviamentoBruciatore ( tamburo As Integer,  aCaldo As Boolean ) As Long
Private:

Documentation:

Module "GestioneCaldaie"

Public:


Types:
 Public Type OggettoCaldaia
 Public Type OggettoPompaAuxCald
 Public Type ProgrammazioneRiscaldamentiGiornalieri 
Properties:
 Public Caldaia ( 0 To 1 ) As OggettoCaldaia
 Public InclusioneOrologio As Boolean
 Public InizializzazioneCaldaieFinita As Boolean
 Public NumeroCaldaiePresenti As Integer
 Public PompaAuxCald ( 0 To 2 ) As OggettoPompaAuxCald
 Public TimerProg ( 0 To 6 ) As ProgrammazioneRiscaldamentiGiornalieri
 Public TipoDiProgrammazioneRiscaldamenti As Byte 
Methods:
 Public Sub CaldAccettaErrore ( accetta As Boolean )
 Public Sub CaldaieCaricaImmagini ( )
 Public Sub CaldSetDeltaTemperatura ( )
 Public Sub CaldSetTemperatura ( Index As Integer )
 Public Sub CaldSetTimerPompa ( )
 Public Sub CaldVisualizzaCircOlio ( indice As Integer )
 Public Sub CaldVisualizzaErroriValvole ( indice As Integer,  ErroriIn As Boolean,  ErroriOut As Boolean )
 Public Sub CaldVisualizzaFiamma ( indice As Integer,  blocco As Boolean,  BruciatoreOn As Boolean,  SecondaFiammaOn As Boolean )
 Public Sub CaldVisualizzaPompaCirc ( indice As Integer,  PompaCircOn As Boolean,  PompaCircScattoTermica As Boolean )
 Public Sub CaldVisualizzaStart ( indice As Integer )
 Public Sub CaldVisualizzaStatoLED ( indice As Integer )
 Public Sub CaldVisualizzaTemperatura ( indice As Integer,  ByVal Value As Double )
 Public Sub CaldVisualizzaValvolaEntrata ( indice As Integer,  aperta As Boolean,  chiusa As Boolean,  allarme As Boolean )
 Public Sub CaldVisualizzaValvolaUscita ( indice As Integer,  aperta As Boolean,  chiusa As Boolean,  allarme As Boolean )
 Public Function ControllaCaldaieAllarmi ( ByRef IdDescrizione As Integer,  ByRef CodiceAllarme As String )
 Public Sub InizializzaCaldaie ( )
 Public Function IsModifiedRiscaldamenti ( ) As Boolean
 Public Sub LeggiDatiDaCaldaie ( )
 Public Sub LoopGraficaCaldaie ( )
 Public Sub ReadFileRiscaldamenti ( )
 Public Sub SalvaFileRiscaldamenti ( )
 Public Sub SetInclusioneOrologio ( )
 Public Sub SetProgrammazioneRiscaldamenti ( )
 Public Sub VisualizzaGraficaPumpAuxCAld ( indice As Integer,  ritorno As Boolean,  erroriPresenti As Integer )
 Public Sub VisualizzaSicurezzaTemperaturaOlio ( indice As Integer,  SicurezzaTemperaturaOlio As Boolean )
 Public Sub VisualizzaStarPumpAuxCAld ( indice As Integer )
 Public Sub WriteFileRiscaldamenti ( )
Private:


Properties:
 Private offset As Integer
 Private Offset2 As Integer
 Private Offset3 As Integer
 Private OffsetCaldAux As Integer
Documentation:

Module "GestioneCaratteri"

Public:


Methods:
 Public Sub CarattereOccidentale ( ByRef NomeForm As Object )
 Public Function DataInglese ( data As String ) As String
 Public Sub ImpostaCarattereOccidentale ( ByRef Nome As Object )
 Public Sub ImpostaCarattereOccidentaleControl ( ByRef controllo As Control )
 Public Sub ImpostaCarattereRusso ( ByRef Nome As Object )
 Public Sub ImpostaCarattereRussoControl ( ByRef controllo As Control )
 Public Sub ImpostaCharSet ( )
 Public Function SostituisciCaratteri ( S As String,  Char1 As String,  Char2 As String ) As String
Private:

Documentation:

Module "GestioneCisterneCommon"

Public:


Constants:
 Public Const CistRidTAG_CisternaBitume1 = CistRidTAG_Bitume_Cisterna1_TipoLivello
 Public Const CistRidTAG_CisternaBitume2 = CistRidTAG_Bitume_Cisterna2_TipoLivello
 Public Const CistTAG_CisternaBitume1 = CistTAG_Bitume_Cisterna1_TipoLivello
 Public Const CistTAG_CisternaBitume2 = CistTAG_Bitume_Cisterna2_TipoLivello
 Public Const CistTAG_CisternaCombustibile1 = CistTAG_Combustibile_Cisterna1_TipoLivello
 Public Const CistTAG_CisternaEmulsione1 = CistTAG_Emulsione_Cisterna1_TipoLivello
 Public Const CistTAG_SondaTuboCaricoBitume = CistTAG_SondaTuboCaricoBitume_UnitaLimiteInf
 Public Const MAX_Valvole_Bitume As Integer = ValvolaBitumeUltima - 1
 Public Const MAX_Valvole_Combustibile As Integer = ValvolaCombustibileUltima - 1
 Public Const MAX_Valvole_Emulsione As Integer = ValvolaEmulsioneUltima - 1
 Public Const NomeFileCisterneDB = "Cisterne.mdb"
 Public Const NumMaxCisterneImpianto = 30 
Types:
 Public Type ContalitriType
 Public Type GestioneCisterne
 Public Enum ListaOperazioniCircuito
 Public Type MotoreS7
 Public Type OggettoValvolaPLC
 Public Type PIDCisterne
 Public Enum PlcTagCisterneEnum
 Public Enum PlcTagCisterneRidottoEnum
 Public Enum StatoValvola
 Public Enum TipiGestioneCiterneEnum
 Public Enum ValvoleBitumeEnum
 Public Enum ValvoleCombustibileEnum
 Public Enum ValvoleEmulsioneEnum 
Properties:
 Public AckAllarmiCisterne As Boolean
 Public CistGestione As GestioneCisterne
 Public ComandiCisternaPid ( 0 To 0 ) As PIDCisterne
 Public InitFormCisterne As Boolean
 Public ListaCisterneValideDosaggioPCL1 As String
 Public ListaCisterneValideDosaggioPCL2 As String
 Public MaterialeDosaggioPCL1 As String
 Public MaterialeDosaggioPCL2 As String
 Public ParametriDBCisterneModificati As Boolean
 Public PompaAuxCisterne As MotoreS7
 Public SbloccoSelezioneCisternaRid As Boolean
 Public ValvolaCircuitoBitume ( 0 To MAX_Valvole_Bitume ) As OggettoValvolaPLC
 Public ValvolaCircuitoCombustibile ( 0 To MAX_Valvole_Combustibile ) As OggettoValvolaPLC
 Public ValvolaCircuitoEmulsione ( 0 To MAX_Valvole_Emulsione ) As OggettoValvolaPLC 
Methods:
 Public Sub AggiornaGrafPIDCisterne ( )
 Public Sub CistAccettaErrore ( accetta As Boolean )
 Public Sub CistAzzeramentoTara ( cisterna As Integer )
 Public Sub CistConnessionePLC ( )
 Public Sub CisterneCaricaImmagini ( )
 Public Sub CistGestioneLoop ( )
 Public Sub CistSetMateriale ( Index As Integer )
 Public Sub CistSetTemperatura ( Index As Integer )
 Public Sub CistShowMenu ( Index As Integer )
 Public Sub CompilaListaCistDosaggio ( )
 Public Sub CreaTagCisterneS7_Ver9 ( )
 Public Sub EnableComboMatCP240 ( visibility As Boolean )
 Public Sub GestioneMaterialeCisterneRidotto ( )
 Public Sub GestioneStatoCisterneRidotto ( )
 Public Sub InviaComandiAgitatori ( indice As Integer,  Stato As Boolean )
 Public Sub LeggiDatiComandiAuxCisterneOnOff ( ByVal indice As Integer,  ByRef uscita As Boolean,  ByRef termica As Boolean )
 Public Sub LeggiDatiPidComandiCisterne ( indice As Integer )
 Public Sub LeggiDatiRegolazioneTempCisterne ( )
 Public Sub ScriviDatiComandiAuxCisterneOnOff ( ByVal indice As Integer,  ByVal avvio As Boolean )
 Public Sub ScriviDatiPidComandiCisterne ( indice As Integer )
 Public Sub ScriviDatiRegolazioneTempCisterne ( )
 Public Function VerificaMaterialeCistDosaggio ( numcisternaselezionata As Integer,  listacisternevalidepcl As String ) As Boolean
Private:

Documentation:

Module "GestioneCisternePLC"

Public:


Constants:
 Public Const cstIndiceLabelTempTuboCaricoLegante = - 1 
Types:
 Public Type OggettoCisterna
 Public Type OggettoDBScambioDatiCisterne
 Public Type OggettoDBScambioDatiCisterneVecchiaStruttura
 Public Enum TipoValvolaEnum 
Properties:
 Public CisternaLegante ( 1 To NumMaxCisterneImpianto ) As OggettoCisterna
 Public ConsensoStartPCL3 As Boolean
 Public DBScambioDatiCisterneBitume As OggettoDBScambioDatiCisterne
 Public DBScambioDatiCisterneCombustibile As OggettoDBScambioDatiCisterneVecchiaStruttura
 Public DBScambioDatiCisterneEmulsione As OggettoDBScambioDatiCisterneVecchiaStruttura
 Public memoriaOperazioneParticolareRifiutata As Boolean
 Public memoriaOperazioneRifiutata As Boolean
 Public MemoriaStatoValvolaSeparazione As Boolean
 Public SondaTuboCaricoLegante As Single 
Methods:
 Public Sub AggiornaGraficaStatoCisterna ( cisterna As Integer )
 Public Sub AggiornaGraficaStatoCisternaCombust ( cisterna As Integer )
 Public Sub AggiornamentoGraficaOperazioniCisterne ( )
 Public Function CalcolaCodiceOperazioneCisterna ( OperazioneCircuito As Integer,  Selezione As Integer ) As Integer
 Public Sub CaricaParametriCisterne ( )
 Public Sub CisterneInviaParametri ( )
 Public Sub ControllaCisterneAllarmi ( ByRef IdDescrizione As Integer,  ByRef CodiceAllarme As String )
 Public Sub ControllaCisterneAllarmiRidotto ( ByRef IdDescrizione As Integer,  ByRef CodiceAllarme As String )
 Public Sub GestioneComboCisterne ( indice As Integer )
 Public Sub GestioneMDownComandiCisterne ( indice As Integer )
 Public Sub GestioneMUPComandiCisterne ( indice As Integer )
 Public Sub GraficaValvolaStandard_Change ( valvola As Integer,  ByRef immagine As Object,  TipoValvola As TipoValvolaEnum )
 Public Sub LeggiDatiPLCCisterneBitume ( )
 Public Sub LeggiDatiPLCCisterneBitumeRid ( )
 Public Sub LeggiDatiPLCCisterneCombustibile ( )
 Public Sub LeggiDatiPLCCisterneEmulsione ( )
 Public Sub PompaCircuitoLegante_Change ( ritorno As Boolean,  CodiceAllarme As Integer,  ByRef immagine As Object )
 Public Sub ScriviDatiPLCCisterne ( )
 Public Sub ScriviDatiPLCCisterneRid ( )
Private:


Properties:
 Private plcInAnalogici_Fatta As Boolean
 Private PlcInDigitali_Fatta As Boolean
 Private TempoRinfrescoValvoleVistaCisterne As Long 
Methods:
 Private Sub SingolaCisternaInviaParametri ( ByRef cisterna As OggettoCisterna,  cisternaOffset As Integer )
 Private Sub SingolaCisternaRidInviaParametri ( ByRef cisterna As OggettoCisterna,  cisternaOffset As Integer )
Documentation:

Module "GestioneCisterneSingole"

Public:


Methods:
 Public Sub CisterneLeggiDatiPLC ( )
 Public Sub CisterneScriviDatiPLC ( )
 Public Sub CistInizializza ( )
 Public Sub CistVisualizzaAttesa ( cisterna As Integer )
 Public Sub CistVisualizzaCarico ( cisterna As Integer )
 Public Sub CistVisualizzaErrore ( cisterna As Integer )
 Public Sub CistVisualizzaIdle ( cisterna As Integer )
 Public Sub CistVisualizzaLivello ( cisterna As Integer,  ByVal percento As Integer,  ByVal tons As Double )
 Public Sub CistVisualizzaRicircolo ( cisterna As Integer,  aperta As Boolean,  chiusa As Boolean,  allarme As Boolean )
 Public Sub CistVisualizzaSelezione ( cisterna As Integer )
 Public Sub CistVisualizzaTemperatura ( cisterna As Integer,  ByVal Value As Double )
 Public Sub CistVisualizzaTravaso ( cisternaSrc As Integer,  cisternaDst As Integer )
 Public Sub CistVisualizzaUscita ( cisterna As Integer )
 Public Sub CistVisualizzaValvolaEntrata1 ( cisterna As Integer,  aperta As Boolean,  chiusa As Boolean,  allarme As Boolean )
 Public Sub CistVisualizzaValvolaUscita1 ( cisterna As Integer,  aperta As Boolean,  chiusa As Boolean,  allarme As Boolean )
 Public Sub CistVisualizzaValvolaUscita2 ( cisterna As Integer,  aperta As Boolean,  chiusa As Boolean,  allarme As Boolean )
 Public Sub VisualizzaAgitatoreCisterne ( cisterna As Integer,  acceso As Boolean )
Private:

Documentation:

Module "GestioneCodaMateriale"

Public:


Types:
 Public Type Antiadesivo 
Properties:
 Public AbilitaCodaMateriale As Boolean
 Public AntiadesivoScivoloScarBilRAP As Antiadesivo
 Public ManualeArrestoPredosLivelloTramoggiaTamponeRAP As Boolean
 Public ManualeLivelloTramoggiaTamponeRAP As Boolean
 Public NrImpastiGestLivTramTamponeRAP As Integer
 Public OraTamburoParalleloCorrezionePortata As Long
 Public PercentualeFillerRecuperatoFiltro As Double
 Public TempoCodaInerti As Integer
 Public TempoPermApertFlapScivoloScarBilRAP As Integer 
Methods:
 Public Sub GcmCodaInerti_timer ( )
 Public Sub GcmCodaRiciclato_timer ( )
 Public Sub GcmCodaTamburoParallelo_timer ( )
Private:


Properties:
 Private m_codaInertiTime As Long
 Private m_codaRiciclatoTime As Long
 Private m_codaTamburoParalleloTime As Long
 Private OraStartPredosatoriRicFreddo As Long
Documentation:

Module "GestioneComandiVari"

Public:


Types:
 Public Enum ComandiVariEnum
 Public Type ComandoType 
Properties:
 Public AbilitaTempoVibrCaricoFApp As Boolean
 Public AbilitaTempoVibrCaricoFApp2 As Boolean
 Public ConteggioVibrCaricoFApp As Integer
 Public ConteggioVibrCaricoFApp2 As Integer
 Public ListaComandi ( 0 To NumComandiVari - 1 ) As ComandoType
 Public ProcediRidotto As Boolean
 Public SetVibrCaricoFApp As Integer
 Public SetVibrCaricoFApp2 As Integer 
Methods:
 Public Sub AutoOnVibratoriPredosatori ( )
 Public Sub AvvioAutomaticoComandiAux ( )
 Public Sub GestioneBottoniCmdVari ( ByVal Index As ComandiVariEnum,  alarmReset As Boolean )
 Public Sub GestioneVibratoriESoffi ( NumPred As Integer,  riciclato As Boolean )
 Public Sub RitornoComando_change ( comando As ComandiVariEnum )
 Public Sub RitornoOkComandi ( )
 Public Sub SetComandoRitorno ( comando As ComandiVariEnum,  ritorno As Boolean )
 Public Sub SetComandoUscita ( comando As ComandiVariEnum,  uscita As Boolean )
 Public Function VerificaComando ( comando As ComandiVariEnum ) As Boolean
 Public Sub VerificaTermicaComando ( comando As ComandiVariEnum,  valoretermica As Boolean )
Private:


Methods:
 Private Sub ComandoUscita_change ( comando As ComandiVariEnum )
Documentation:

Module "GestioneDataBase"

Public:


Properties:
 Public DBcon As New adodb. Connection
 Public Rs_Registrazioni_AddNew As New adodb. Recordset 
Methods:
 Public Sub EseguiSQL ( Stringa As String )
 Public Sub SqlServerApri ( )
 Public Function SqlServerCancellaTrendData ( dataInizio As Date ) As Boolean
 Public Sub SqlServerChiudi ( )
 Public Function SqlServerCompatta ( ) As Boolean
Private:


Methods:
 Private Function SqlServerComando ( comando As String,  Optional parametri As Boolean,  Optional dataInizio As Date ) As Boolean
Documentation:

Module "GestioneDosaggio"


Gestione della segnalazione di MESCOLAZIONE. Public Sub MescolazioneInCorso_change()
Dim Criterio As String Dim posizione As Integer

On Error GoTo Errore

If (MescolazioneInCorso) Then

Criterio = "DO011" posizione = DlookUpExt("IndirizzoPLC", "CodificaAllarmi", Criterio, "IdDescrizione") IngressoAllarmePresente posizione, False Criterio = "DO013" posizione = DlookUpExt("IndirizzoPLC", "CodificaAllarmi", Criterio, "IdDescrizione") IngressoAllarmePresente posizione, False

AssorbimentoMixer = ListaAmperometri(AmperometroMescolatore_1).valore Campiona anche nel trend Call TrendCampionamentoInserisciEvento(TrendAmperometroMixer, DateTime.Now, CDbl(AssorbimentoMixer))

CP240.LblMescolazione.Visible = True CP240.lblEtichetta(184).Visible = True

If BitumeGravita Then CP240.LblKgDosaggio(2).caption = CLng(SommaAggregati + SommaFiller + NettoViatopBuffer(0) + RoundNumber(CP240.OPCData.items(PLCTAG_GravitaNettoB1Kg).Value, 1) + RoundNumber(CP240.OPCData.items(PLCTAG_GravitaNettoB2Kg).Value, 1)) Else If CP240.AdoDosaggio.Recordset.Fields("SetBitumeHard").Value > 0 Then CP240.LblKgDosaggio(2).caption = CLng(SommaAggregati + SommaFiller + NettoViatopBuffer(0) + RoundNumber(CP240.OPCData.items(PLCTAG_NettoBitume1).Value, 1) + RoundNumber(CP240.OPCDataSchiumato.items(NettoBitumeSoft_idx).Value, 1) + RoundNumber(CP240.OPCDataSchiumato.items(NettoBitumeHard_idx).Value, 1)) Else CP240.LblKgDosaggio(2).caption = CLng(SommaAggregati + SommaFiller + NettoViatopBuffer(0) + RoundNumber(CP240.OPCData.items(PLCTAG_NettoBitume1).Value, 1)) End If End If

Aggiungo il peso del bitume contalitri e dal RAP_SIWAREX If InclusioneAddContalitri Then CP240.LblKgDosaggio(2).caption = CP240.LblKgDosaggio(2).caption + RoundNumber(CP240.OPCData.items(PLCTAG_ContalitriNettoKg).Value, 0) End If If AbilitaRAPSiwa Then CP240.LblKgDosaggio(2).caption = CP240.LblKgDosaggio(2).caption + RoundNumber(CP240.OPCData.items(PLCTAG_DB101_SIWA_BATCH_NETTO).Value, 0) NettoRAPSiwaBuffer = NettoRAPSiwa ComponentePesoOut DosaggioRAPSiwa, CDbl(NettoRAPSiwaBuffer) End If If AbilitaRAP Then CP240.LblKgDosaggio(2).caption = CP240.LblKgDosaggio(2).caption + NettoRAPBuffer ComponentePesoOut DosaggioRAP, CDbl(NettoRAPBuffer) End If

If InclusioneAcqua Then CP240.LblKgDosaggio(2).caption = CP240.LblKgDosaggio(2).caption + val(CP240.LblAdd(5).caption) End If

CP240.ImgMotor(0).Visible = True

20160729 If CP240.AdoDosaggio.Recordset.Fields("AquablackSet") > 0 Then Aquablack_HMI_PLC.FROM_HMI_Start = True Else Aquablack_HMI_PLC.FROM_HMI_Stop = True End If

Else CP240.LblMescolazione.Visible = False CP240.lblEtichetta(184).Visible = False End If

Exit Sub Errore: LogInserisci True, "DOS-012", CStr(Err.Number) + " [" + Err.description + "]" End Sub

Public:


Constants:
 Public Const MassimoArrayAgg As Integer = 9
 Public Const OffsetPesViatopScarMixer As Integer = 11
 Public Const OffsetScarViatopScarMixer As Integer = 23 
Types:
 Public Enum AdditiviEnum
 Public Enum BilancePnCommandEnum
 Public Enum BilancePnTypeEnum
 Public Type BilanciaPnComboType
 Public Type ComponenteContalitriType
 Public Enum ComponenteEnum
 Public Enum ComponenteGraficaEnum
 Public Type ComponenteType
 Public Enum enumStatoValvolaBitumeEsterno
 Public Type RicettaTramogge
 Public Enum ScarichiEnum
 Public Enum StatusDosaggio
 Public Type TypeRicettaS7 
Properties:
 Public AbilitaAllarmeCicalino As Boolean
 Public AbilitaCambioRicetta As Boolean
 Public AbilitaControlloPressostatoFiltro As Boolean
 Public AbilitaFineCorsaIntermedioAggregati As Boolean
 Public AbilitaInversionePCL As Boolean
 Public AbilitaRAP As Boolean
 Public AbilitaSirenaAvvioImpianto As Boolean
 Public AbilitaTuboTroppoPienoF1 As Boolean
 Public AbilitaValv3VieSpruzzatriceBitume As Boolean
 Public AbilitaValvolaBitumeEmulsione As Integer
 Public AbilitaValvolaConsensoBitumeNeutro As Boolean
 Public AbilitaValvolaTroppoPienoF1 As Boolean
 Public AbilitaVoloDinamicoFlusso As Boolean
 Public AdditivoBacinella As ComponenteContalitriType
 Public AggregatoForzato ( 0 To 7 ) As Boolean
 Public AnticipoPesataFineFiller1 As Integer
 Public AnticipoPesataFineFiller2 As Integer
 Public AnticipoPesataFineFiller3 As Integer
 Public ArrestoUrgenza As Boolean
 Public BennaPiena As Boolean
 Public BilanciaPnAttiva As BilancePnTypeEnum
 Public BilanciaPnCmdRun As Boolean
 Public BilanciaPnCombo As BilanciaPnComboType
 Public BilanciaPnCommand As BilancePnCommandEnum
 Public BilanciaPnErrore As Boolean
 Public BilanciaPnSampleWeight As Double
 Public BitSpruzzato As Double
 Public Bitume2InBlending As Boolean
 Public BitumeGravita As Boolean
 Public BitumeInSpruzzatura As Boolean
 Public BitumeKgFinali As Integer
 Public BloccoBenna As Boolean
 Public BloccoScaricoMescolatore As Boolean
 Public BufferAbilitaCicloRC ( 1 To 2 ) As Boolean
 Public BufferAddBacNet ( 1 To 2 ) As Double
 Public BufferAddBacSet ( 1 To 2 ) As Double
 Public BufferAddKgSacchi ( 1 To 3 ) As Integer
 Public BufferAddSacchi ( 1 To 3 ) As Integer
 Public BufferKgAddBac ( 1 To 3 ) As Double
 Public BufferKgAddMesc ( 1 To 3 ) As Integer
 Public BufferKgAggregati ( 0 To 8 ) As Double
 Public BufferKgBitume ( 0 To 2 ) As Double
 Public BufferKgFiller ( 0 To 2 ) As Double
 Public BufferKgViatop As Double
 Public BufferKgViatopScarMixer1 As Double
 Public BufferKgViatopScarMixer2 As Double
 Public BufferMatCistLegPCL1 As String
 Public BufferMatCistLegPCL2 As String
 Public BufferRitardoViatopScarMixer1 As Double
 Public BufferRitardoViatopScarMixer2 As Double
 Public BufferSelezCistLegPCL1 As Integer
 Public BufferSelezCistLegPCL2 As Integer
 Public BufferVoloAggregati ( 0 To 8 ) As Long
 Public BufferVoloBitume ( 0 To 4 ) As Double
 Public BufferVoloFiller ( 0 To 2 ) As Double
 Public BufferVoloViatop As Double
 Public BufferVoloViatopScarMixer1 As Double
 Public BufferVoloViatopScarMixer2 As Double
 Public CambioPercentualeDosaggio As Boolean
 Public CambioRicettaPerPlc As Boolean
 Public CambioRicettaPerScarico As Boolean
 Public CambioRicettaPrenotato As Boolean
 Public cambioVoloTempiAggRic As Boolean
 Public CaricoSpruzzatriceBitume As Boolean
 Public CicliDosaggioDaEseguire As Long
 Public CicliDosaggioEseguiti As Long
 Public CicloFreddoSenzaAggregati As Boolean
 Public CicloRicCaldoSenzaAggregati As Boolean
 Public CoeffCommutaPesataFineAggregati ( 1 To 8 ) As Double
 Public CoeffVoloPesataFineAggregati ( 1 To 8 ) As Double
 Public CoeffVoloPesataUnicaAggregati ( 1 To 8 ) As Double
 Public ComandoEvacuazioneSiloFiller As Boolean
 Public ComandoPesataFiller ( 0 To 2 ) As Boolean
 Public ConsensoScaricoBilance As Boolean
 Public DeflettoreNonPassa As Boolean
 Public DeflettoreSuVagliato As Boolean
 Public DeflTramScivScarBilRicAperto As Boolean
 Public DeflTramScivScarBilRicChiuso As Boolean
 Public DoppioClickOnLblProdDos As Boolean
 Public DosaggioAggregati ( 0 To 7 ) As ComponenteType
 Public DosaggioFiller ( 0 To 2 ) As ComponenteType
 Public DosaggioInCorso As Boolean
 Public DosaggioInCorsoApp As Boolean
 Public DosaggioLeganti ( 0 To 4 ) As ComponenteType
 Public DosaggioRAP As ComponenteType
 Public DosaggioRAPSiwa As ComponenteType
 Public DosaggioViatop As ComponenteType
 Public DosaggioViatopScarMixer1 As ComponenteType
 Public DosaggioViatopScarMixer2 As ComponenteType
 Public EvacuazioneFiltroDMR As Boolean
 Public EvacuazioneForzataFiltroDMR As Boolean
 Public FCNonPassaGrosso As Boolean
 Public FCNonPassaRifiuti As Boolean
 Public FillerForzato ( 0 To 2 ) As Boolean
 Public FuoriTollContalitri As Boolean
 Public FuoriTolleranzaBitumeSegnalato As Boolean
 Public GestioneManualeScambioVaglio As Boolean
 Public InclusioneAriaFredda As Boolean
 Public InclusioneBacinella2 As Boolean
 Public InclusioneBitume2 As Boolean
 Public InclusioneBitume3 As Boolean
 Public InclusioneDeflettoreNonPassa As Boolean
 Public InclusioneDMR As Boolean
 Public InclusioneDoppiaPesataAgg As Boolean
 Public InclusioneLegante100 As Boolean
 Public InclusioneSiloFillerRecuperoDMR As Boolean
 Public InclusioneTemperaturaTramogge As Boolean
 Public InversioneAdditivi ( 0 To 3 ) As Boolean
 Public InviaStopDosaggio As Boolean
 Public ManualeAdditivi ( 0 To 3 ) As Boolean
 Public ManualeDeflTramScivScarBilRic As Boolean
 Public ManualePesaturaComponenti As Integer
 Public ManualeScaricoComponenti As ScarichiEnum
 Public MaxTempSpruzzatura As Long
 Public MemImpastoAutoScaricatoMan As Boolean
 Public MemoriaPesataExtComando As Boolean
 Public MemoriaVelocitaInverterCocleaFiller1 As Integer
 Public MemoriaVelocitaInverterCocleaFiller2 As Integer
 Public MemoriaVelocitaInverterCocleaFiller3 As Integer
 Public MemoriaVelocitaInverterCocleaFiltro As Integer
 Public MemStatoDosaggio As Integer
 Public MescolazioneInCorso As Boolean
 Public MixerCaricoPerBenna As Boolean
 Public NettoAgg ( 0 To MassimoArrayAgg - 1 ) As Long
 Public NettoAggregatiBuffer ( 0 To MassimoArrayAgg - 1 ) As Long
 Public NettoBitumeBuffer ( 0 To 4 ) As Double
 Public NettoFiller ( 0 To 2 ) As Double
 Public NettoFillerBuffer ( 0 To 2 ) As Double
 Public NettoRAP As Long
 Public NettoRAPBuffer As Long
 Public NettoRAPSiwa As Long
 Public NettoRAPSiwaBuffer As Long
 Public NettoViatopScarMixer1 As Double
 Public NettoViatopScarMixer1Buffer As Double
 Public NettoViatopScarMixer2 As Double
 Public NettoViatopScarMixer2Buffer As Double
 Public NumeroCampionamentiCalcoloFlusso As Integer
 Public NumeroTramoggiaScAgg ( 0 To 7 ) As RicettaTramogge
 Public NvInManuale As Integer
 Public OraErroreScambioFillerRecuperoInApporto As Long
 Public OraErroreScambioTuboTroppoPienoF1F2 As Long
 Public OraStartEvacuazioneSiloFiller As Long
 Public PacchettoMixer As String
 Public ParamCheckBitumenDosage As Boolean
 Public Pcl1AutoOn As Boolean
 Public Pcl1Inverter As Boolean
 Public Pcl2AutoOn As Boolean
 Public Pcl2Inverter As Boolean
 Public PesataExtAttiva As Boolean
 Public PesataFineAggregatiKg ( 1 To 8 ) As Integer
 Public PesaturaManuale As Boolean
 Public PesaturaRiciclatoAggregato7 As Boolean
 Public PesoMinimoPesataVeloce As Integer
 Public PortataMassimaFiller1 As Integer
 Public PortataMassimaFiller2 As Integer
 Public PortataMassimaFiller3 As Integer
 Public PortinaAgg ( 0 To 6 ) As Boolean
 Public PortinaNV As Boolean
 Public PulsantieraPesate ( 1 ) As Long
 Public QuantitaImpastoProdotto As Double
 Public QuantitaImpastoProdottoReset As Double
 Public RAPInPesata As Boolean
 Public RAPInScarico As Boolean
 Public RapportoFlussoCocleaPesataF1_CocleaFiltro As Integer
 Public RapportoFlussoCocleaPesataF3_CocleaPesataF2 As Integer
 Public RAPSiwaInPesata As Boolean
 Public RAPSiwaInScarico As Boolean
 Public RAPSiwaPortinaAperta As Boolean
 Public RAPSiwaPortinaChiusa As Boolean
 Public RAPSiwaStartSemiAuto As Boolean
 Public RicettaInUsoModificata As Boolean
 Public RicettaS7 ( 0 To 7 ) As TypeRicettaS7
 Public RiduzioneVelocitaPesataFineFiller1 As Integer
 Public RiduzioneVelocitaPesataFineFiller2 As Integer
 Public RiduzioneVelocitaPesataFineFiller3 As Integer
 Public RitornoEvacuazioneFiltroDMR As Boolean
 Public RitornoEvacuazioneSiloFiller As Boolean
 Public RitornoPesataFiller ( 0 To 2 ) As Boolean
 Public RitornoTuboTroppoPienoNonSuF2 As Boolean
 Public ScambioBitume2 As Integer
 Public ScambioFillerRecuperoInApporto As Boolean
 Public ScambioFillerRecuperoInApporto_CH As Boolean
 Public ScambioTuboTroppoPienoF1F2 As Boolean
 Public ScaricoAcqua As Boolean
 Public ScaricoAdditivo ( 0 To 1 ) As Boolean
 Public ScaricoAddSacchi As Boolean
 Public ScaricoMescolatoreForzato As Boolean
 Public SelettoreBitume123 As Integer
 Public SelezioneCircuitoBitume2 As Boolean
 Public SelezioneRicettaDosaggioCambiata As Boolean
 Public SetPcl1 As Integer
 Public SetPcl2 As Integer
 Public SommaAggregati As Long
 Public SommaFiller As Double
 Public SospensionePesatura As Boolean
 Public SQL_FROM_VistaStoricoImpasti As String
 Public StoricoImpastoDaAggiornare As Boolean
 Public TamburoParallelo_PredosasatoriCorrezionePercentuale As Integer
 Public TamburoParallelo_TempoCoda As Integer
 Public TamburoParallelo_TramoggiaTamponeCapacita As Integer
 Public TamburoParallelo_TramoggiaTamponeLivelloTeoricoSogliaAllarmePercentuale As Integer
 Public TamburoParallelo_TramoggiaTamponeLivelloTeoricoSogliaCriticaPercentuale As Integer
 Public TempoAllarmeScaricoAggregati As Double
 Public TempoAllarmeScaricoContalitri As Double
 Public TempoAllarmeScaricoFiller As Double
 Public TempoAllarmeScaricoLegante As Double
 Public TempoAllarmeScaricoLeganteGR As Double
 Public TempoAllarmeScaricoMixer As Double
 Public TempoAllarmeScaricoRiciclato As Double
 Public TempoAllarmeScaricoViatop As Double
 Public TempoAttesaRiavvioSirena As Integer
 Public TempoControlloRitornoPesataFiller ( 0 To 2 ) As Long
 Public TempoMassimoPesataFiller As Integer
 Public TempoMescolazione As Long
 Public TempoOffSirena As Integer
 Public TempoOnSirena As Integer
 Public TempoPermanenzaScaricoAggregati As Double
 Public TempoPermanenzaScaricoFiller As Double
 Public TempoPermanenzaScaricoLeganteGR As Double
 Public TempoPermanenzaScaricoRiciclato As Double
 Public TempoRitardoAllarmeScaricoMixer As Double
 Public TimeoutEvacuazioneFiller As Integer
 Public TonnellateImpostate As Double
 Public TotaleImpastoProgressivo As Double
 Public TotaleProdotto As Double
 Public Trasf_dati_PLC_scarico As Boolean
 Public TrasfDatiPLCCarico As Boolean
 Public UltimaBennata As Boolean
 Public UltimoImpastoCompletato As Boolean
 Public ValorePortinaBitume ( 0 To 4 ) As Boolean
 Public ValoreTempoInizioCiclo As Long
 Public Valv3VieSpruzzatriceVersoTorre As Boolean
 Public ValvolaBitumeEmulsioneSelezioneEmulsione As Boolean
 Public ValvolaBitumeEmulsioneVersoBitume As Boolean
 Public ValvolaBitumeEmulsioneVersoEmulsione As Boolean
 Public VelocitaMinimaInverterCocleaFiller1 As Integer
 Public VelocitaMinimaInverterCocleaFiller2 As Integer
 Public VelocitaMinimaInverterCocleaFiller3 As Integer
 Public VelocitaMinimaInverterCocleaFiltro As Integer
 Public VoloAggregati ( 0 To 8 ) As Long
 Public VoloBitume ( 0 To 4 ) As Double
 Public VoloFiller ( 0 To 2 ) As Double
 Public VoloRiciclato As Double
 Public VoloRiciclatoSiwa As Double
 Public VoloViatop As Double
 Public VoloViatopScarMixer1 As Double
 Public VoloViatopScarMixer2 As Double 
Methods:
 Public Sub AbilitazioneCambioRicetta ( abilita As Boolean )
 Public Function AdditivoFlomacInserito ( ) As Boolean
 Public Sub AggiornaGraficaFlomac_Change ( )
 Public Sub AggiornaGraficaScaricoMescolatore ( )
 Public Sub AggiornaOrdinePesateForzato ( )
 Public Sub AggiornaSetKgCP240 ( )
 Public Sub AggiornaVelocitaInvertPesateFiller ( KgF1 As Double,  KgF2 As Double,  KgF3 As Double )
 Public Sub ArrestoEmergenzaDosaggio ( )
 Public Sub ArrestoPCLInDosaggio ( )
 Public Sub AzzeraBufferViatopScarMixer ( )
 Public Sub AzzeramentoDatiTrasRic ( )
 Public Sub BilAdditivoBacCNT_change ( )
 Public Sub BilAgg_change ( )
 Public Sub BilanciaFillerPortinaChiusa_change ( )
 Public Sub BilanciaInertiPortinaAperta_change ( )
 Public Sub BilanciaInertiPortinaChiusa_change ( )
 Public Sub BilBit_change ( )
 Public Sub BilFiller_change ( )
 Public Sub BilRAP_Change ( )
 Public Sub BilRAPSiwa_change ( )
 Public Sub BilTamponeRiciclato_change ( )
 Public Sub BitSpruzzato_change ( )
 Public Sub BitumeDaCircuitoEsterno_change ( )
 Public Sub BitumeDaCircuitoMarini_change ( )
 Public Sub BitumeInSpruzzatura_change ( )
 Public Sub CalcolaTempoCiclo ( )
 Public Sub CalcolaVelocitaInvertPesateFillerManuale ( )
 Public Sub CalcoloProgressImpasto ( )
 Public Function CalcoloTotaleImpasto ( ) As Double
 Public Sub CambioRicettaPrenotato_change ( )
 Public Sub CfgPortineScaricoAgg ( )
 Public Sub CicliDosaggioEseguiti_change ( )
 Public Sub ComandoScaricoMixer_change ( )
 Public Sub ComponenteInit ( ByRef componente As ComponenteType,  progessivo As Integer,  esiste As Boolean,  Nome As String,  temperatura As Boolean,  Livello As Boolean,  livelloTeorico As Boolean,  pesaExt As Boolean )
 Public Sub ComponenteInPesata ( ByRef componente As ComponenteType,  Value As Boolean )
 Public Sub ComponenteLivello ( ByRef componente As ComponenteType,  Value As Integer )
 Public Sub ComponentePesoOut ( ByRef componente As ComponenteType,  Value As Double )
 Public Sub ComponenteSet ( ByRef componente As ComponenteType,  Value As Double )
 Public Sub ComponenteSetCalcolato ( ByRef componente As ComponenteType,  Value As Double )
 Public Sub ComponenteSetDisplay ( ByRef componente As ComponenteType,  Optional decimalDigit As Integer )
 Public Sub ComponenteTemperatura ( ByRef componente As ComponenteType,  Value As Double )
 Public Sub ConsensoScaricoBilance_change ( )
 Public Sub ContalitriErroreTimeOutArresto_change ( )
 Public Sub ContalitriErroreTimeOutAvvio_change ( )
 Public Function ControlloCondizioniStartDosaggio ( ) As Boolean
 Public Sub ControlloLivelliAltiTramogge ( )
 Public Sub DatiResiduiNetti ( )
 Public Sub DeflettoreNonPassa_change ( )
 Public Sub DeflTramScivScarBilRic_change ( )
 Public Sub DosaggioAutoMan ( auto As Boolean )
 Public Sub DosaggioInCorso_change ( )
 Public Sub ForzaSetAggregati ( Index As Integer )
 Public Sub ForzaSetFiller ( Index As Integer )
 Public Sub ForzaSetTempi ( Optional soloagg_ric As Boolean )
 Public Sub FuoriTollAggregati_change ( )
 Public Sub FuoriTollBitume_change ( )
 Public Sub FuoriTollContalitri_change ( )
 Public Sub FuoriTollFiller_change ( )
 Public Sub FuoriTollRiciclato_change ( )
 Public Sub FuoriTollViatop_change ( )
 Public Sub GestioneBitumeGravita ( )
 Public Sub GestioneCambioRicettaDosaggio ( )
 Public Sub GestioneDeflettoreByPassTamburoParallelo ( )
 Public Sub GestioneDosaggioBitumeEsterno ( )
 Public Sub GestioneStatoDosaggio ( )
 Public Sub Grafica_DeflTramScivScarBilRic ( )
 Public Sub GraficaTempoMescolazione ( )
 Public Function GrandezzaImpastoPLC ( ) As Integer
 Public Function ImpastoPeso ( ) As Long
 Public Sub InizializzaComponenti ( )
 Public Sub InvioFormulaDosaggio ( )
 Public Sub LeggiNettiParziali ( )
 Public Sub LeggiNettiResiduiCP240 ( )
 Public Sub LetturaPesoMescolatore ( )
 Public Sub LivelloTeoricoIn ( ByRef componente As ComponenteType,  Value As Double )
 Public Sub LivelloTeoricoOut ( ByRef componente As ComponenteType,  Value As Double )
 Public Sub MescolatoreAperto_change ( )
 Public Sub MescolatoreChiuso_change ( )
 Public Sub MescolazioneInCorso_change ( )
 Public Sub PesataRAP_Change ( )
 Public Sub PortinaAgg_change ( portina As Integer )
 Public Sub PortinaNV_change ( )
 Public Sub PosizionaAdditivi ( )
 Public Sub PosizionaBitume123 ( )
 Public Sub PosizionaDeflettoreByPassTamburoParallelo ( )
 Public Sub PosizionaDeflettoreVaglio ( )
 Public Sub PressioneAriaInsufficente_change ( )
 Public Sub PulsanteControlloPortineManuale ( Optional automatico As Boolean )
 Public Sub PulsanteStopCicliDosaggio ( )
 Public Sub RAPSiwaInPesata_change ( )
 Public Sub RefillTargheCamion ( )
 Public Sub RefreshDatiFormNetti ( )
 Public Function RicalcolaSetRicetta ( SetOLD As Double,  KgImpasto As Long,  PercBitume As Double,  KgNew As Long ) As Double
 Public Sub RichiamoRicettaDos ( )
 Public Function RiduzioneImpastoCasoSacchi ( ByRef min As Integer,  ByRef passo As Integer ) As Boolean
 Public Sub RiempiBufferAggregatiFiller ( )
 Public Sub RiempiBufferKgVoli ( )
 Public Sub RiempiBufferViatopScarMixer ( )
 Public Sub RiempieBufferPortine ( rs As adodb. Recordset,  ByRef arrayPortine ( ) As RicettaTramogge )
 Public Sub RinfrescaNomeRicDosaggio ( )
 Public Sub RinfrescaOrigineDatiClienti ( NomeCliente As String )
 Public Sub RinfrescaOrigineDatiClientiCamion ( NomeCliente As String )
 Public Sub RinfrescaOrigineDatiDosaggio ( NomeRicDosSel As String )
 Public Sub ScambiaPompaCircLegante ( )
 Public Sub ScambioFillerRecuperoInApporto_Change ( )
 Public Sub ScambioTuboTroppoPieno_Change ( )
 Public Sub ScaricoAggregati_change ( )
 Public Sub ScaricoBitume_change ( gravita As Boolean )
 Public Sub ScaricoFiller_change ( )
 Public Sub ScritturaPesoMescolatore ( )
 Public Sub SegnalaCambioRicettaAlPlc ( )
 Public Sub SelectClienteByCS ( IdCliente As Long )
 Public Sub SelectDosingRecipeByCS ( IdRecipe As Long )
 Public Sub SelezionaRicettaDosaggio ( )
 Public Sub SetCicliDosaggioDaEseguire ( ByVal cicli As Long )
 Public Sub SetDimensioneImpastoKg ( nuovaDimensione As Long )
 Public Sub SetDosaggioScarico ( )
 Public Sub SetRiduzioneImpasto ( nuovaRiduzione As Integer )
 Public Sub SetSelezioneCircuitoBitume2 ( bitume2 As Boolean )
 Public Sub SommaComponenti ( )
 Public Sub StartDosaggio ( )
 Public Sub StatoAccoppiataDisplay ( ByRef componente As ComponenteType,  Stato As Boolean )
 Public Sub StatusCalibrazioneBilPN ( )
 Public Sub TemperaturaLegante_change ( indiceEtichetta As Integer,  temperatura As Long )
 Public Sub TempoMescolazione_change ( )
 Public Sub TimeOutDosaggio ( )
 Public Sub TrasformaRicettaS7 ( )
 Public Sub VagliatoNonVagliato_change ( )
 Public Sub ValorePortinaBitume_change ( portinaBitume As Integer )
 Public Sub Valv3VieBitume2Emulsione_Change ( )
 Public Sub Valv3VieSpruzzatriceVersoTorre_Change ( )
 Public Function VerificaRiduzioneImpastoCasoSacchi ( ByRef riduzione As Integer,  inIncremento As Boolean ) As Boolean
 Public Sub VerificaRitornoPesataFiller ( componente As Integer,  comando As Boolean,  ritorno As Boolean )
 Public Function VerificaSetSicurezzeBilance ( ) As Boolean
Private:


Constants:
 Private Const SQL_Ordinamento_Storico = "ORDER BY DataOra DESC;"
 Private Const SQL_Storico_Parte1 = "SELECT * From Vista_StoricoImpasti "
 Private Const SQL_Storico_Parte1_100 = "SELECT * From Vista_StoricoImpasti_100 " 
Methods:
 Private Sub CalcolaVelocitaInvertPesateFiller ( KgF1 As Double,  KgF2 As Double,  KgF3 As Double )
 Private Sub RefreshRicettaAquablack ( )
 Private Sub RicettaParametriBitumeGravita ( )
Documentation:

 Public Function ControlloCondizioniStartDosaggio ( ) As Boolean
20150513 Dim MaterialeokPCL1 As Boolean Dim MaterialeokPCL2 As Boolean

Dim rstStoricoImpasto As New adodb.Recordset

On Error GoTo Errore

ControlloCondizioniStartDosaggio = False

Controllo che il filler sia in tara If BilanciaFiller.Peso > BilanciaFiller.Tara Then AllarmeCicalino = True Call ShowMsgBox(LoadXLSString(180), vbOKOnly, vbExclamation, -1, -1, True) AllarmeCicalino = False Exit Function End If

Controllo che gli aggregati siano in tara If BilanciaAggregati.Peso > BilanciaAggregati.Tara Then AllarmeCicalino = True Call ShowMsgBox(LoadXLSString(179), vbOKOnly, vbExclamation, -1, -1, True) AllarmeCicalino = False Exit Function End If

Controllo che il riciclato sia in tara If BilanciaRAP.Peso > BilanciaRAP.Tara Then AllarmeCicalino = True Call ShowMsgBox(LoadXLSString(1469), vbOKOnly, vbExclamation, -1, -1, True) AllarmeCicalino = False Exit Function End If

Controllo che il viatop sia in tara If BilanciaViatop.Peso > BilanciaViatop.Tara Then AllarmeCicalino = True Call ShowMsgBox(LoadXLSString(582), vbOKOnly, vbExclamation, -1, -1, True) AllarmeCicalino = False Exit Function End If

Controllo che il compressore sia acceso If Not ListaMotori(MotoreCompressore).ritorno Then AllarmeCicalino = True Call ShowMsgBox(LoadXLSString(580), vbOKOnly, vbExclamation, -1, -1, True) AllarmeCicalino = False Exit Function End If

Controllo destinazione silo inserita If (DestinazioneSilo = 0) Then AllarmeCicalino = True Call ShowMsgBox(LoadXLSString(181), vbOKOnly, vbExclamation, -1, -1, True) AllarmeCicalino = False Exit Function End If

Controllo motore mixer If (Not ListaMotori(MotoreMescolatore).ritorno) Then AllarmeCicalino = True Call ShowMsgBox(LoadXLSString(182), vbOKOnly, vbExclamation, -1, -1, True) AllarmeCicalino = False Exit Function End If

Controllo che con il viatop in ricetta il ciclone non contenga materiale If (Not CicloneMinViatop And CP240.OPCData.items(PLCTAG_SetViatop1).Value <> 0) Then AllarmeCicalino = True Call ShowMsgBox(LoadXLSString(829), vbOKOnly, vbExclamation, -1, -1, True) AllarmeCicalino = False Exit Function End If

Controllo bitume esterno If InclusioneBitumeEsterno Then If (Not Pcl1AutoOn And Not ListaMotori(MotorePCL).ritorno And Not StatoValvolaManCircuitoBitume = CircuitoMarini) Then If val(CP240.AdoDosaggioScarico.Recordset.Fields("Bitume1").Value) + val(CP240.AdoDosaggioScarico.Recordset.Fields("Bitume2").Value) > 0 Then AllarmeCicalino = True Call ShowMsgBox(MotPCLNoOk, vbOKOnly, vbExclamation, -1, -1, True) AllarmeCicalino = False Exit Function End If End If If StatoValvolaManCircuitoBitume = Indefinito Or StatoValvolaManCircuitoBitume = Errore Then AllarmeCicalino = True Call ShowMsgBox(LoadXLSString(1048), vbOKOnly, vbExclamation, -1, -1, True) AllarmeCicalino = False Exit Function End If Else If val(CP240.AdoDosaggioScarico.Recordset.Fields("Bitume1").Value) + val(CP240.AdoDosaggioScarico.Recordset.Fields("Bitume2").Value) > 0 Then Ricetta con bitume If (Not Pcl1AutoOn And (val(CP240.AdoDosaggioScarico.Recordset.Fields("Bitume1").Value) > 0) And Not ValvolaBitumeEmulsioneSelezioneEmulsione And Not ListaMotori(MotorePCL).ritorno) Or (Not Pcl2AutoOn And (val(CP240.AdoDosaggioScarico.Recordset.Fields("Bitume2").Value) > 0) And Not ValvolaBitumeEmulsioneSelezioneEmulsione And Not ListaMotori(MotorePCL2).ritorno) Or ((val(CP240.AdoDosaggioScarico.Recordset.Fields("Bitume1").Value) > 0) And ValvolaBitumeEmulsioneSelezioneEmulsione And Not ListaMotori(MotorePompaEmulsione).ritorno) Or ((val(CP240.AdoDosaggioScarico.Recordset.Fields("Bitume2").Value) > 0) And ValvolaBitumeEmulsioneSelezioneEmulsione And Not ListaMotori(MotorePompaEmulsione).ritorno) Then PCL non è in moto AllarmeCicalino = True Call ShowMsgBox(MotPCLNoOk, vbOKOnly, vbExclamation, -1, -1, True) AllarmeCicalino = False Exit Function End If 20150704 If (val(CP240.AdoDosaggioScarico.Recordset.Fields("Bitume1").Value) And BassaTemperaturaBitume(0)) Or (val(CP240.AdoDosaggioScarico.Recordset.Fields("Bitume2").Value) And BassaTemperaturaBitume(1)) Then AllarmeCicalino = True Call ShowMsgBox(LoadXLSString(384), vbOKOnly, vbExclamation, -1, -1, True) AllarmeCicalino = False Exit Function End If

End If End If

If InclusioneBitume3 And (CP240.AdoDosaggio.Recordset.Fields("SetBitumeSoft").Value > 0) Then 20160606 If Not ListaMotori(MotorePCL3).uscita Then If ListaMotori(MotorePCL3).presente And Not ListaMotori(MotorePCL3).ComandoManuale Then

If Not ListaMotori(MotorePCL3).ritorno Then PCL non è in moto AllarmeCicalino = True Call ShowMsgBox(MotPCLNoOk, vbOKOnly, vbExclamation, -1, -1, True) AllarmeCicalino = False Exit Function End If End If End If

20150513 controllo selezione bitume coerente If (CistGestione.Gestione = GestioneSemplificata) Then MaterialeokPCL1 = (VerificaMaterialeCistDosaggio(DBScambioDatiCisterneBitume.RidottoSelezioneAttualeCisternaBitumePCL1, ListaCisterneValideDosaggioPCL1)) MaterialeokPCL2 = (VerificaMaterialeCistDosaggio(DBScambioDatiCisterneBitume.RidottoSelezioneAttualeCisternaBitumePCL2, ListaCisterneValideDosaggioPCL2))

If ((Not MaterialeokPCL1) And (MaterialeDosaggioPCL1 <> "")) Or ((Not MaterialeokPCL2) And (MaterialeDosaggioPCL2 <> "")) Then AllarmeCicalino = True Call ShowMsgBox(LoadXLSString(1510), vbOKOnly, vbExclamation, -1, -1, True) AllarmeCicalino = False Exit Function End If End If

Controllo pressione aria If (PressioneAriaInsufficente) Then AllarmeCicalino = True Call ShowMsgBox(NoAria, vbOKOnly, vbExclamation, -1, -1, True) AllarmeCicalino = False Exit Function End If

Controllo assorbimento del mescolatore 20161212 If (ListaAmperometri(0).Inclusione And ListaAmperometri(0).valore > ListaAmperometri(0).sogliaMin) Then If ( ListaAmperometri(AmperometroMescolatore_1).inclusione And ListaAmperometri(AmperometroMescolatore_1).valore > ListaAmperometri(AmperometroMescolatore_1).sogliaMin ) Then AllarmeCicalino = True Call ShowMsgBox(LoadXLSString(616) & " " & ListaMotori(MotoreMescolatore).Descrizione, vbOKOnly, vbExclamation, -1, -1, True) AllarmeCicalino = False Exit Function End If

Controllo la selezione del Bitume1 o Bitume2 come da ricetta If Not BitumeGravita And AbilitaSelettoreBitume1 Then If DosaggioLeganti(0).set <> 0 Then If ScambioBitume2 = 1 Then AllarmeCicalino = True Call ShowMsgBox(LoadXLSString(613), vbOKOnly, vbExclamation, -1, -1, True) AllarmeCicalino = False Exit Function End If End If If DosaggioLeganti(1).set <> 0 Then If ScambioBitume2 = 0 Then AllarmeCicalino = True Call ShowMsgBox(LoadXLSString(613), vbOKOnly, vbExclamation, -1, -1, True) AllarmeCicalino = False Exit Function End If End If End If

Call ScambiaPompaCircLegante

Controllo ricetta inserita If CP240.adoComboDosaggio.text = "" Then AllarmeCicalino = True Call ShowMsgBox(InsRicettaDos, vbOKOnly, vbExclamation, -1, -1, True) AllarmeCicalino = False Exit Function End If

Controllo inserimento numero cicli If (CicliDosaggioDaEseguire = 0) Then AllarmeCicalino = True Call ShowMsgBox(InsNumeroCicli, vbOKOnly, vbExclamation, -1, -1, True) AllarmeCicalino = False Exit Function End If

20160729 If Not CP240.AdoDosaggioNext.Recordset.EOF Then If ((Not PlcAquablackConnesso And (CP240.AdoDosaggioNext.Recordset.Fields("AquablackSet").Value > 0)) Or Aquablack_Digital.AquablackStatoManuale) And InclusioneAquablack Then AllarmeCicalino = True Call ShowMsgBox(LoadXLSString(1527), vbOKOnly, vbExclamation, -1, -1, True) AllarmeCicalino = False Exit Function End If End If

If Not VerificaSetSicurezzeBilance Then Exit Function End If

STAMPA CONTINUA If (InclusioneStampaOgniDosaggio And IsPrinterReady(StampaOgniDosaggioNomeStampante)) Then

Set Printer = StampanteContinua 20150706

imposta handler di stampa valido per tutto il job If lhPrinter = 0 Then lReturn = OpenPrinter(StrPtr(StampaOgniDosaggioNomeStampante), lhPrinter, 0) End If

MyDocInfo.pDocName = "batch_record" MyDocInfo.pOutputFile = vbNullString MyDocInfo.pDatatype = vbNullString 20150707 lDoc = StartDocPrinter(lhPrinter, 1, MyDocInfo) Call StartPagePrinter(lhPrinter)

StampaOgniDosaggioRicetta = "" StampaOgniDosaggioRicetta = CP240.AdoDosaggio.Recordset.Fields("Descrizione").Value

End If

ControlloCondizioniStartDosaggio = True Exit Function

Errore:

AllarmeCicalino = True Call ShowMsgBox(ControllareRiprovare, vbOKOnly, vbExclamation, -1, -1, True) AllarmeCicalino = False

End Function

Returns Boolean -


module| index| back| top
Module "GestioneFile"

Public:


Constants:
 Public Const PI_GRAPHICPATH As String = "GraphicPath"
 Public Const PI_INSTALLDATAPATH As String = "InstallDataPath"
 Public Const PI_LOGPATH As String = "LogPath"
 Public Const PI_PARAMETERTOSAVE As String = "ParameterToSave"
 Public Const PI_USERDATAPATH As String = "UserDataPath" 
Types:
 Public Enum mceIDLPaths 
Methods:
 Public Function FileGetValue ( FileName As String,  sectionName As String,  keyName As String,  defaultValue As String ) As String
 Public Sub FileSetValue ( FileName As String,  sectionName As String,  keyName As String,  ByVal Value As String )
 Public Function GetPlantInfoNumber ( info As String,  default As Long ) As Long
 Public Function GetPlantInfoString ( info As String,  default As String ) As String
 Public Function GetSystemFolder ( ByVal systemFolder As mceIDLPaths ) As String
 Public Sub SetPlantInfoNumber ( info As String,  Value As Long )
 Public Sub SetPlantInfoString ( info As String,  Value As String )
Private:


Constants:
 Private Const PLANTINFOFILE As String = "CYB500N.ini"
 Private Const PLANTINFOSEZIONE As String = "CYB500N" 
Declarations:
 Private Declare Function GetPrivateProfileStringA Lib "kernel32" ( ByVal sectionName As String,  ByVal keyName As String,  ByVal defaultValue As String,  ByVal Value As String,  ByVal valueSize As Long,  ByVal FileName As String ) As Long
 Private Declare Function SHGetSpecialFolderPath Lib "SHELL32.DLL" Alias "SHGetSpecialFolderPathA" ( ByVal hWnd As Long,  ByVal lpszPath As String,  ByVal nFolder As Integer,  ByVal fCreate As Boolean ) As Boolean
 Private Declare Function WritePrivateProfileStringA Lib "kernel32" ( ByVal sectionName As String,  ByVal keyName As String,  ByVal Value As String,  ByVal FileName As String ) As Long
Documentation:

Module "GestioneFiltro"

Public:


Types:
 Public Type RegolazioneMinMax 
Properties:
 Public AbilitaControlloAriaFredda As Boolean
 Public AbilitaPuliziaFiltro As Boolean
 Public AllarmeDepressioneFiltro As Integer
 Public AltaTemperaturaFiltro As Boolean
 Public ArrayLettureDepressioneBruciatore ( 0 To 1,  1 To 30 ) As Long
 Public ArrayLettureDepressioneFiltroIN ( 1 To 30 ) As Integer
 Public AttesaFiltrofreddoFlipFlop As Boolean
 Public CamereFiltroInPulizia ( 0 To 31 ) As Boolean
 Public contatoreFillerizzazione As Integer
 Public DeltaAriaFredda As Integer
 Public DepressioneFiltro As Integer
 Public DepressioneFiltroIN As Integer
 Public DepressioneFiltroRegolazione As RegolazioneMinMax
 Public EsclusioneMessaggioAllarmeTemperaturaBassaFiltro As Boolean
 Public FiltroInPulizia As Boolean
 Public FondoscalaDeltaDepressione As Integer
 Public GestioneArrestoLivelliTSF As Integer
 Public Inclusione3LivDMR As Boolean
 Public IsteresiDepMinFillerizzazione As Integer
 Public ManualeFillerizzazione As Boolean
 Public ManualeModulAriaFredda As Boolean
 Public ManualeModulFiltro As Boolean
 Public MinDepressFiltro As Integer
 Public ModoFunzFiltro As Integer
 Public NumeroCamereFiltro As Integer
 Public NumeroLetturaDepressioneFiltroIN As Integer
 Public NumeroLettureDepressione As Long
 Public PersistAllMaxFiltroLivContinui ( 1 To 3 ) As TipoTemporizzatoreStandard
 Public PosizioneModulatoreAriaFredda As Long
 Public PosizioneModulatoreAriaFreddaDigitale As Boolean
 Public PredosaggioArrestoLivelliTSF As Boolean
 Public PressioneCompressoreFillerizOK As Boolean
 Public RegolazioneAriaAspiratore_cntr As Integer
 Public RitardoSpegnimentoCompressoreF1F2 As Integer
 Public SelezioneFillerizzazioneF1F2 As Integer
 Public SicurezzaTemperaturaFiltro As Boolean
 Public SogliaDepMinFillerizzazione As Integer
 Public SogliaPartenzaFillerizzazione As Integer
 Public SpeedManualeFillerizzazione As Integer
 Public StartManualeFillerizzazione As Boolean
 Public StepRegolazioneAspDuranteAccFiltro As Integer
 Public TemperaturaFiltroFreddo As Integer
 Public TempoAttesaFiltro As Boolean
 Public TempoCampAriaFredda As Integer
 Public TempoCorrAriaFredda As Integer
 Public TempoLavoro1Filtro As Integer
 Public TempoLavoro2Filtro As Integer
 Public TempoPausaFiltro As Integer
 Public TempoRegolazioneAspDuranteAccFiltro As Long
 Public TimeoutArrestoLivelliTSF As Long
 Public TmrArrestoLivelliAltiTSF As Long
 Public ValoreLettoModulatoreAspFiltroNN As Integer
 Public ValoreMaxAriaFredda As Long
 Public ValoreMinAriaFredda As Long
 Public ValoreTempLavoroFiltro As Integer
 Public ValoreTempMaxFiltro As Long
 Public ValoreTempoOffRegolazioneAspirazioneFiltro As Integer
 Public ValoreTempoOnRegolazioneAspirazioneFiltro As Integer
 Public VelocitaFillerizzazione As Integer 
Methods:
 Public Sub AbortFillerizzazione ( )
 Public Sub AltaTemperaturaFiltro_change ( )
 Public Sub AutomaticoAriaFreddaFiltro ( )
 Public Sub AutomaticoFiltroManiche ( )
 Public Sub AutomaticoModulatoreFumiTamburo ( tamburo As Integer )
 Public Function ConversioneTemperatura ( ValorePLC As Long,  ByVal Temp As TemperatureEnum,  ByVal fatto As Boolean ) As Boolean
 Public Sub DepressioneFiltro_change ( )
 Public Sub DepressioneFiltroIN_change ( )
 Public Sub ErroreLivelloAltoFiller ( )
 Public Function GestioneAspirazioneFiltro ( )
 Public Sub GestioneAspirazioneFiltroInPreventilazione ( )
 Public Sub GestioneFillerizzazione ( )
 Public Sub GestioneLivelliFiltroDMR ( )
 Public Sub ManualeAriaFreddaFiltro ( )
 Public Sub ManualeFiltroManiche ( )
 Public Sub ManualeModulatoreFumiTamburo ( tamburo As Integer )
 Public Function NormalizzazioneA100 ( valoreLetto As Integer,  MassimoScala As Integer,  MinimoScala As Integer,  MassimoPLC As Integer,  MinimoPLC As Integer ) As Integer
 Public Function NormalizzazioneA100Dbl ( valoreLetto As Double,  MassimoScala As Double,  MinimoScala As Double,  MassimoPLC As Double,  MinimoPLC As Double ) As Double
 Public Sub ResettaTimerGestioneFiltro ( )
 Public Sub SetManualeFillerizzazione ( manuale As Boolean )
 Public Sub SiloFillerEstrazione ( silo As Integer,  Value As Boolean )
 Public Sub SiloFillerLivello ( silo As Integer,  Value As Long )
 Public Function Sonda_mA ( valore As Long,  max As Long,  min As Long,  mA_4_20 As Boolean ) As Long
 Public Function Sonda_mA_Dbl ( valore As Long,  max As Long,  min As Long,  mA_4_20 As Boolean ) As Double
 Public Function SondaDbl_mA ( valore As Double,  max As Double,  min As Double,  mA_4_20 As Boolean ) As Double
 Public Sub StartMotoreFillerizzazioneF1F2 ( VelocitaPercento As Integer )
 Public Sub StopFillerizzazione ( )
 Public Sub ValvolaPreseparatoreAnelloRitorno_change ( )
 Public Sub ValvolaPreseparatoreRitorno_change ( )
 Public Sub VisualizzaPuliziaFiltro ( )
Private:


Methods:
 Private Sub AumentoAspirazFiltro ( )
 Private Sub DepressioneFiltroAllarme ( )
Documentation:

Module "GestioneGrafica"

Public:


Types:
 Enum IconaPulsAutoManErr
 Public Enum StatoPulsantePlus 
Methods:
 Public Sub ColoreCasellaTemperatura ( ByRef oggetto As Object,  codicecolori As Integer )
 Public Sub DisponiPulsantiPlusForm ( Form As Object,  idStart As Integer,  idEnd As Integer,  PulsTwip As Boolean,  FormTwip As Boolean,  Optional align As Integer )
 Public Sub IconaStatoManAutoErr ( ByRef oggetto As Object,  stato As IconaPulsAutoManErr )
 Public Function PlusSuffissoFileImgPulsanteForm ( stato As StatoPulsantePlus ) As String
Private:

Documentation:

Module "GestioneHelp"

Public:


Constants:
 Public Const HH_ADD_BUTTON = &HB
 Public Const HH_ADD_NAV_UI = &HA
 Public Const HH_ALINK_LOOKUP = &H13
 Public Const HH_CLOSE_ALL = &H12
 Public Const HH_DISPLAY_INDEX = &H2
 Public Const HH_DISPLAY_SEARCH = &H3
 Public Const HH_DISPLAY_TEXT_POPUP = &HE
 Public Const HH_DISPLAY_TOC = &H1
 Public Const HH_DISPLAY_TOPIC = &H0
 Public Const HH_GET_WIN_HANDLE = &H6
 Public Const HH_GET_WIN_TYPE = &H5
 Public Const HH_GETBROWSER_APP = &HC
 Public Const HH_HELP_CONTEXT = &HF
 Public Const HH_KEYWORD_LOOKUP = &HD
 Public Const HH_MAX_TABS = 19
 Public Const HH_SET_GUID = &H1A
 Public Const HH_SET_WIN_TYPE = &H4
 Public Const HH_SYNC = &H9
 Public Const HHWIN_BUTTON_BACK = &H4
 Public Const HHWIN_BUTTON_BOOKMARKS = &H20000
 Public Const HHWIN_BUTTON_BROWSE_BCK = &H100
 Public Const HHWIN_BUTTON_BROWSE_FWD = &H80
 Public Const HHWIN_BUTTON_CONTENTS = &H400
 Public Const HHWIN_BUTTON_EXPAND = &H2
 Public Const HHWIN_BUTTON_FORWARD = &H8
 Public Const HHWIN_BUTTON_HISTORY = &H10000
 Public Const HHWIN_BUTTON_HOME = &H40
 Public Const HHWIN_BUTTON_INDEX = &H4000
 Public Const HHWIN_BUTTON_JUMP1 = &H40000
 Public Const HHWIN_BUTTON_JUMP2 = &H80000
 Public Const HHWIN_BUTTON_NOTES = &H200
 Public Const HHWIN_BUTTON_OPTIONS = &H1000
 Public Const HHWIN_BUTTON_PRINT = &H2000
 Public Const HHWIN_BUTTON_REFRESH = &H20
 Public Const HHWIN_BUTTON_SEARCH = &H8000
 Public Const HHWIN_BUTTON_STOP = &H10
 Public Const HHWIN_BUTTON_SYNC = &H800
 Public Const HHWIN_BUTTON_TOC_NEXT = &H200000
 Public Const HHWIN_BUTTON_TOC_PREV = &H400000
 Public Const HHWIN_BUTTON_ZOOM = &H100000
 Public Const HHWIN_DEF_BUTTONS = ( HHWIN_BUTTON_EXPAND Or HHWIN_BUTTON_BACK Or HHWIN_BUTTON_OPTIONS Or HHWIN_BUTTON_PRINT )
 Public Const HHWIN_PARAM_CUR_TAB = &H2000
 Public Const HHWIN_PARAM_EXPANSION = &H200
 Public Const HHWIN_PARAM_EXSTYLES = &H8
 Public Const HHWIN_PARAM_HISTORY_COUNT = &H1000
 Public Const HHWIN_PARAM_INFOTYPES = &H80
 Public Const HHWIN_PARAM_NAV_WIDTH = &H20
 Public Const HHWIN_PARAM_PROPERTIES = &H2
 Public Const HHWIN_PARAM_RECT = &H10
 Public Const HHWIN_PARAM_SHOWSTATE = &H40
 Public Const HHWIN_PARAM_STYLES = &H4
 Public Const HHWIN_PARAM_TABORDER = &H800
 Public Const HHWIN_PARAM_TABPOS = &H400
 Public Const HHWIN_PARAM_TB_FLAGS = &H100
 Public Const HHWIN_PROP_AUTO_SYNC = &H100
 Public Const HHWIN_PROP_CHANGE_TITLE = &H2000
 Public Const HHWIN_PROP_MENU = &H10000
 Public Const HHWIN_PROP_NAV_ONLY_WIN = &H4000
 Public Const HHWIN_PROP_NO_TOOLBAR = &H8000
 Public Const HHWIN_PROP_NODEF_EXSTYLES = &H10
 Public Const HHWIN_PROP_NODEF_STYLES = &H8
 Public Const HHWIN_PROP_NOTB_TEXT = &H40
 Public Const HHWIN_PROP_NOTITLEBAR = &H4
 Public Const HHWIN_PROP_ONTOP = &H2
 Public Const HHWIN_PROP_POST_QUIT = &H80
 Public Const HHWIN_PROP_TAB_ADVSEARCH = &H20000
 Public Const HHWIN_PROP_TAB_BOOKMARKS = &H1000
 Public Const HHWIN_PROP_TAB_HISTORY = &H800
 Public Const HHWIN_PROP_TAB_SEARCH = &H400
 Public Const HHWIN_PROP_TRACKING = &H200
 Public Const HHWIN_PROP_TRI_PANE = &H20
 Public Const HHWIN_PROP_USER_POS = &H40000
 Public Const IDTB_BACK = 204
 Public Const IDTB_BOOKMARKS = 217
 Public Const IDTB_BROWSE_BACK = 212
 Public Const IDTB_BROWSE_FWD = 211
 Public Const IDTB_CONTENTS = 213
 Public Const IDTB_CONTRACT = 201
 Public Const IDTB_CUSTOMIZE = 221
 Public Const IDTB_EXPAND = 200
 Public Const IDTB_FORWARD = 209
 Public Const IDTB_HISTORY = 216
 Public Const IDTB_HOME = 205
 Public Const IDTB_INDEX = 214
 Public Const IDTB_JUMP1 = 218
 Public Const IDTB_JUMP2 = 219
 Public Const IDTB_NOTES = 210
 Public Const IDTB_OPTIONS = 208
 Public Const IDTB_PRINT = 207
 Public Const IDTB_REFRESH = 203
 Public Const IDTB_SEARCH = 215
 Public Const IDTB_STOP = 202
 Public Const IDTB_SYNC = 206
 Public Const IDTB_TOC_NEXT = 223
 Public Const IDTB_TOC_PREV = 224
 Public Const IDTB_ZOOM = 222 
Types:
 Public Enum HelpContextID
 Public Type HH_AKLINK
 Public Type HH_FTS_QUERY
 Public Enum HH_TAB
 Public Enum HHACT
 Enum HHWIN_NAVTAB
 Public Enum HHWIN_NAVTYPE 
Methods:
 Public Function VisualizzaHelp ( ByRef parent As Form,  ByVal contextID As Long ) As Boolean 
Declarations:
 Public Declare Function HTMLHelp Lib "hhctrl.ocx" Alias "HtmlHelpA" ( ByVal hWnd As Long,  ByVal lpHelpFile As String,  ByVal wCommand As Long,  dwData As Any ) As Long
Private:

Documentation:

Module "GestioneJob"

Public:


Constants:
 Public Const ComandoJobEmergenza = "<Message Comando=""0""></Message>"
 Public Const ComandoJobShowForm = "<Message Comando=""3""></Message>" 
Types:
 Public Enum EnumComandoJobCS
 Public Enum EnumComandoJobVB
 Public Enum EnumSpecJobCS
 Public Enum EnumStatoJobCS
 Public Enum EnumStatoJobVB
 Public Type TipoJob 
Properties:
 Public CicloScaricoSiloCompleto As Boolean
 Public ComandoJobCS As EnumComandoJobCS
 Public ComandoJobVB As EnumComandoJobVB
 Public JobAttivo As TipoJob
 Public JobProssimo As TipoJob
 Public MemSelSiloJobMan As Boolean
 Public MemStepJob As Integer
 Public PacchettoDatixml As XmlJobs
 Public StatorRichiestaCambioSiloJob As Integer
 Public StepJob As Integer
 Public tmrAvvioJob As TemporizzatoreStandardType 
Methods:
 Public Sub ApplicaJob ( )
 Public Sub CambioDosJob ( )
 Public Sub CambioPredosJob ( )
 Public Sub CicloJob ( )
 Public Function EnumComandoJobCS_ToString ( varenum As EnumComandoJobCS ) As String
 Public Function EnumSpecJobCS_ToString ( varenum As EnumSpecJobCS ) As String
 Public Function EnumStatoJobVB_ToString ( varenum As EnumStatoJobVB ) As String
 Public Sub InitJob ( job As TipoJob )
 Public Sub PreStartJob ( )
 Public Sub StartJob ( )
 Public Sub StopEmergenzaJob ( )
 Public Sub StopJob ( )
 Public Sub StopPredJob ( )
 Public Sub UpdateCtrlDosPredosCP240 ( statojob As EnumStatoJobVB )
Private:

Documentation:

Module "GestioneLCPC"

Public:


Constants:
 Public Const LCPCmsg As String = "LCPC" 
Properties:
 Public FuoriTolleranza As Integer
 Public InclusioneLCPC As Boolean
 Public InclusioneWindQual As Boolean
 Public PortaComLCPC As Integer
 Public TempoMescolazUmida As String
 Public TempoMixSecca ( 1 ) As Double
 Public TempoMixTotale ( 1 ) As Double
 Public TempoMixUmida ( 1 ) As Double
 Public TempoTotaleCiclo As Long 
Methods:
 Public Sub AttivaTimerLCPC ( )
 Public Function Calcola_Kg_m ( NumPred As Integer ) As String
 Public Function Calcola_m_min ( NumPred As Integer ) As String
 Public Function CalcolaTh ( Ramsey As Integer,  SetPerc As Integer ) As String
 Public Function CambiaChar ( Stringa As String,  CharOLD As String,  CharNEW As String ) As String
 Function ControleCrc ( ByVal Taille %,  ByVal CRC_1 &,  ByVal CRC_2 &,  ByVal CRC_3 & ) As Boolean
 Public Function ConvertiTh2Kgm ( Ramsey As Integer ) As String
 Function CRC16 ( s As String ) As Long
 Public Function CreaCRC ( Pacchetto As String ) As String
 Public Function CreaPacchetto1sec ( ) As String
 Public Function CreaPacchetto5sec ( ) As String
 Public Function LCPC_ZERO ( s As String ) As String
 Public Sub ScriviLogWindQual ( Trama As String,  TipoTrama As String )
 Public Sub VisualizzaStatoLCPC ( stato As Boolean )
Private:


Properties:
 Private FlagAmman As Boolean
 Private gDebutTrame As Boolean
 Private gFlagTypeDeCRC As Integer
 Private Pacchetto5sec As String
 Private Pos_Pacchetto5sec As Integer
 Private TrameRecu As String
Documentation:

Module "GestioneLingue"

Public:


Constants:
 Public Const AlarmsSheet As String = "Alarms"
 Public Const AlarmTypesSheet As String = "AlarmTypes"
 Public Const MaintenanceSheet As String = "Maintenance"
 Public Const TranslationFileName As String = "Translations"
 Public Const TranslationsSheet As String = "Translations" 
Types:
 Public Enum Languages
 Public Enum PlusLanguages
 Public Type SiwarexErrorCode
 Public Type SiwarexErrorType 
Properties:
 Public Avvisopred As String
 Public ControllareRiprovare As String
 Public DatoNonValido As String
 Public InsNumeroCicli As String
 Public InsRicettaDos As String
 Public LinguaSelezionata As Languages
 Public MotPCLNoOk As String
 Public msgConnessoNo As String
 Public msgConnessoSi As String
 Public NoAria As String
 Public NomePortinaErrato As String
 Public NoOperazione As String
 Public SiwarexError ( 0 To 2 ) As SiwarexErrorType
 Public strSiNo As String
 Public TranslationsLoaded As Boolean
 Public VerificatoErrore As String 
Methods:
 Public Sub CaricaTraduzioni ( )
 Public Function ConvertPlusLanguages ( plusSelectedLanguage As PlusLanguages )
 Public Function GetColumnTranslation ( ) As Integer
 Public Function GetInstallTranslationsFileName ( ) As String
 Public Function GetUserTranslationsFileName ( ) As String
 Public Function LoadXLSString ( numero As Long ) As String
 Public Sub ReadTranslations ( )
 Public Function SiwarexGetError ( typeNum As Integer,  Code As Integer,  ByRef errorCode As SiwarexErrorCode ) As Boolean
 Public Function WriteTranslations ( NomeFoglio As String,  row As Long,  newText As String ) As Boolean
Private:


Methods:
 Private Sub AlarmToSql ( )
 Private Sub AlarmTypeToSql ( )
Documentation:

Module "GestioneLivelliSiliFillerVaglio"


CP240.AniPushButtonDeflettore(16) = 2 CP240.OPCData.items(PLCTAG_SelezioneF3).value = True Case 2 priorità F2 CP240.AniPushButtonDeflettore(16) = 1 CP240.OPCData.items(PLCTAG_SelezioneF3).value = False End Select Exit Sub ERRORE: LogInserisci True, "LVL-008", CStr(Err.Number) + " [" + Err.description + "]" End Sub
Public:


Properties:
 Public CameraEspansioneFillerRecupero As Boolean
 Public FCMaxSiloFiller2 As Boolean
 Public FCMaxSiloFiller3 As Boolean
 Public FCMedSiloFiller2 As Boolean
 Public FCMinSiloFiller2 As Boolean
 Public FCMinSiloFiller3 As Boolean
 Public FineRitardoConteggioF ( 0 To 2 ) As Boolean
 Public InclusioneEvacuazioneFillerRecuperoDMR As Boolean
 Public InclusioneEvacuazioneSiloFiller As Boolean
 Public LivelliContinuiCameraEspansioneFillerRecupero As Boolean
 Public LivelliContinuiCameraEspansioneFillerRecuperoMaxPercAllarme As Long
 Public LivelliFillerContinui As Boolean
 Public LivelloFillerApporto As Boolean
 Public LivelloFillerApporto2 As Boolean
 Public LivelloFillerRecupero As Boolean
 Public LivelloMax2CameraEspansioneFillerRecupero As Boolean
 Public LivelloMax3CameraEspansioneFillerRecupero As Boolean
 Public LivelloMaxCameraEspansioneFillerRecupero As Boolean
 Public LivelloMaxF1 As Boolean
 Public LivelloMaxF2 As Boolean
 Public LivelloMaxSiloFiller ( 1 To 3 ) As Boolean
 Public LivelloMaxSiloFillerAn As Integer
 Public LivelloMaxSiloFillerRecupero As Boolean
 Public LivelloMed2CameraEspansioneFillerRecupero As Boolean
 Public LivelloMedCameraEspansioneFillerRecupero As Boolean
 Public LivelloMin2CameraEspansioneFillerRecupero As Boolean
 Public LivelloMinCameraEspansioneFillerRecupero As Boolean
 Public LivelloMinSiloFiller ( 1 To 3 ) As Boolean
 Public LivelloMinSiloFillerAn As Integer
 Public LivelloMinSiloFillerRecupero As Boolean
 Public LivelloRiscalaMaxFiller ( 0 To 3 ) As Integer
 Public LivelloRiscalaMaxTramoggia ( 0 To 19 ) As Integer
 Public LivelloRiscalaMinFiller ( 0 To 3 ) As Integer
 Public LivelloRiscalaMinTramoggia ( 0 To 19 ) As Integer
 Public LivelloSiloFillerContinuo ( 1 To 3 ) As Integer
 Public LivelloTramoggia ( 0 To 19 ) As Integer
 Public PesaturaAvvenutaF ( 0 To 2 ) As Boolean
 Public SelezioneF3 As Boolean
 Public ValoreLivelloContCameraEspFilRec_CE As Long
 Public ValoreLivelloContCameraEspFilRec_DX As Long
 Public ValoreLivelloContCameraEspFilRec_SX As Long
 Public ValoreLivelloSiloFiller ( 0 To 3 ) As Long 
Methods:
 Public Sub APBScambioFillerRecuperoInApporto_Change ( comando As Boolean )
 Public Sub APBScambioTuboTroppoPienoF1F2_Change ( comando As Boolean )
 Public Function CambioRicettaSenzaF2toF2 ( ) As Boolean
 Public Function CambioRicettaSenzaF3toF3 ( ) As Boolean
 Public Function CocleaFillerApporto2DaAccendere ( accendi As Boolean ) As Boolean
 Public Function CocleaFillerApportoDaAccendere ( accendi As Boolean ) As Boolean
 Public Function CocleaFillerRecuperoDaAccendere ( accendi As Boolean ) As Boolean
 Public Sub ComandoPesataFiller_change ( filler As Integer )
 Public Sub LivelliDigitaliSiloFiller ( )
 Public Sub LivelloFillerApporto_change ( )
 Public Sub LivelloFillerApporto2_change ( )
 Public Sub LivelloFillerRecupero_change ( )
 Public Sub LivelloTramoggia_change ( tramoggia As Integer )
 Public Sub ValoreLivelloSiloFiller_change ( silo As Integer )
Private:

Documentation:

Module "GestioneLog"

Public:


Methods:
 Public Function LogFunction ( nomeFunzione As String,  Inizio As Boolean,  Optional timerInizioEsterno As Long ) As Long
 Public Sub LogInserisci ( Errore As Boolean,  funzione As String,  ByVal Descrizione As String )
Private:


Constants:
 Private Const LogExt As String = ".log"
 Private Const NomeFileLog As String = "Cyb500N" 
Properties:
 Private TimerInizio As Long
Documentation:

Module "GestioneMessaggistica"

Public:


Types:
 Public Enum Messaggistica 
Properties:
 Public CSharpInCommunication As Boolean 
Methods:
 Public Sub ComunicazioneConManutenzioni ( )
 Public Sub GetMessage ( messageReceived As String )
 Sub GetSingleMessage ( msgcode As Integer,  message As String )
 Public Sub InitConnection ( )
 Public Sub InviaMessaggioFineJobXml ( )
 Public Sub InviaMessaggioJobEmergenzaXml ( )
 Public Sub InviaMessaggioQuantitaJobXml ( Quantita As Double,  tipo As EnumComandoJobVB )
 Public Sub LeggiMessaggioJobXML ( messaggio As String )
 Public Function PlusForceStopFinish ( ) As Boolean
 Public Sub SendMessagetoPlus ( item As String,  Value As String )
 Public Sub SetActiveUser ( ByVal newActiveUser As UsersEnum )
 Public Sub StopMessaging ( )
Private:


Properties:
 Private OraStartComunicazioneManut As Long 
Methods:
 Private Sub PlusForceStop ( )
 Private Sub SplitMessage ( message As String )
Documentation:

Module "GestioneMotori"

Public:


Constants:
 Public Const MAXMOTORI As Integer = MotoreUltimo - 1
 Public Const MAXNEWMOTORS As Integer = 100 
Types:
 Public Enum AvviamentoMotoriRidottoEnum
 Public Enum FuelType
 Public Type MotorePausaLavoro
 Public Type MotoreType
 Public Enum MotoriEnum
 Public Enum MotorManagementEnum
 Public Enum MotorSequenceEnum
 Public Enum StatusMotori
 Public Type TamburoType 
Properties:
 Public AbilitaDeflettoreMulino As Boolean
 Public ArrestoMotoriEmergenza As Boolean
 Public AssorbimentoMixer As Integer
 Public ComandoValvolaTSF As Boolean
 Public connessionestatoOK As Boolean
 Public DustfixEnable As Boolean
 Public EvacuazFiltroErrore As Boolean
 Public ForzaturaPCL As Boolean
 Public FrmMotoriVisibile As Boolean
 Public GruppoAvviamentoSelezionato ( 0 To AvviamentoMax - 1 ) As Boolean
 Public InclusioneTramoggiaTamponeF1 As Boolean
 Public InclusioneTramoggiaTamponeF2 As Boolean
 Public ListaMotori ( 1 To MAXNEWMOTORS ) As MotoreType
 Public ListaTamburi ( 0 To 1 ) As TamburoType
 Public MixerDustfix As Boolean
 Public MotoreForzato As Integer
 Public MotorManagement As MotorManagementEnum
 Public MotorManagementPlcAutomatic As Boolean
 Public MotorManagementPlcCountDownLavoroSirena As Integer
 Public MotorManagementPlcCountDownMaxNv As Integer
 Public MotorManagementPlcCountDownMotoreAvviamento As Integer
 Public MotorManagementPlcCountDownMotoreSpegnimento As Integer
 Public MotorManagementPlcCountDownPausaSirena As Integer
 Public MotorManagementPlcForcing As Boolean
 Public MotorManagementPlcMotoreAvviamentoSpegnimento As Integer
 Public MotorManagementPlcOutSirena As Boolean
 Public MotorManagementPlcSemiAutomatic As Boolean
 Public MotorPrenotaAvvCaldo As Boolean
 Public MotorSequence As MotorSequenceEnum
 Public NastroRapJollyVersoFreddo As Boolean
 Public NessunRidottoSelezionato As Boolean
 Public NumeroCocleePreseparatore As Integer
 Public NumeroCocleeRecupero As Integer
 Public OrdineAvviamentoMotori ( 1 To MAXNEWMOTORS ) As Integer
 Public OrdineSpegnimentoMotori ( 1 To MAXNEWMOTORS ) As Integer
 Public PompaDustfix As Boolean
 Public primotrasferimentoparametri As Boolean
 Public ScattoTermicaCocleaPesataF1 As Boolean
 Public ScattoTermicaCocleaPesataF2 As Boolean
 Public SelezioneFormTipoAvvMotori As VbMsgBoxResult
 Public SequenzaInCorso As Boolean
 Public SirenaInCorso As Boolean
 Public SpegnimentoCaldoInCorso As Boolean
 Public tempoAttesaMotOn As Long
 Public TermicaDustfix As Boolean
 Public TimeoutSequenzaInCorso As Long
 Public TmrTimeoutSequenzaInCorso As Long
 Public VaglioEscluso As Boolean
 Public VaglioIncluso As Boolean
 Public ValvolaTSFAperta As Boolean
 Public ValvolaTSFErrore As Boolean 
Methods:
 Public Sub AbilitaPulsFormInversione ( )
 Public Sub AccendiVaglioCambioRicetta ( )
 Public Sub AggiornaGraficaValvolaTSF_Change ( )
 Public Sub AvvioStopAutomaticoMotori ( )
 Public Function CambioRicettaNVtoV ( ) As Boolean
 Public Sub ChkAvvioMotoriFillerizzazione ( motore As Integer,  comando As Boolean )
 Public Sub ControlloAsservimenti ( )
 Public Sub ControlloMixerDosaggioStart ( )
 Public Sub ControlloPuliziaFiltro ( )
 Public Sub DimensionaFiamma ( tamburo As Integer )
 Public Sub FineAttesaStopAutomaticoMotori ( )
 Public Sub GestionePulsantiTipoFunzMot ( Stato As Boolean )
 Public Sub GestioneVaglio ( )
 Public Sub GraficaDustFix ( )
 Public Sub InizioAttesaStopAutomaticoMotori ( )
 Public Function MotoreAcceso ( motore As Integer ) As Boolean
 Public Sub MotoreAggiornaGrafica ( motore As Integer )
 Public Function MotoreCocleaPreseparatriceAcceso ( ) As Boolean
 Public Function MotoreCocleaPreseparatriceErrore ( ) As Boolean
 Public Function MotoreCocleaRecuperoAcceso ( ) As Boolean
 Public Function MotoreCocleaRecuperoErrore ( ) As Boolean
 Public Sub MotoreRitorno_change ( motore As Integer )
 Public Sub MotoreRitornoReale_change ( motore As Integer )
 Public Sub MotoreRitornoTermica ( motore As Integer )
 Public Sub MotoreSicurezza_change ( motore As Integer )
 Public Sub MotoreUscita_change ( motore As Integer,  Optional CambioStato_per_PausaLavoro As Boolean )
 Public Function MotoriInAutomatico ( ) As Boolean
 Public Sub MotoriInAutomatico_change ( )
 Public Sub MotorManagementPlc_change ( )
 Public Sub MotorManagementPlcCountDown_change ( motoreChanged As Boolean )
 Public Sub MotorManagementPlcSirena_change ( )
 Public Sub MotorManagementPlcTroppoPienoNV_change ( )
 Public Sub NMSetMotoreForzato ( ByVal motore As Integer )
 Public Sub NMSetMotoreUscita ( ByVal motore As Integer,  valore As Boolean )
 Public Sub NMSetMotoreUscitaInv ( ByVal motore As Integer,  valore As Boolean )
 Public Sub PulsanteManualePremuto ( )
 Public Sub RimettiAutomaticoMotori ( )
 Public Sub SetMotoreAllarme ( motore As Integer,  valore As Integer )
 Public Sub SetMotoreBlocco ( motore As Integer,  valore As Boolean )
 Public Sub SetMotoreForzatoAcceso ( motore As Integer,  valore As Boolean )
 Public Sub SetMotoreForzatoDarwin ( motore As Integer,  valore As Boolean )
 Public Sub SetMotoreForzatoSpento ( motore As Integer,  valore As Boolean )
 Public Sub SetMotoreRitorno ( motore As Integer,  valore As Boolean )
 Public Sub SetMotoreRitornoIndietro ( motore As Integer,  valore As Boolean )
 Public Sub SetMotoreRitornoReale ( motore As Integer,  valore As Boolean )
 Public Sub SetMotoreUscita ( ByVal motore As Integer,  valore As Boolean,  Optional CambioStato_per_PausaLavoro As Boolean )
 Public Sub SetMotorManagement ( newMotorManagement As MotorManagementEnum )
 Public Sub UpdateManagement ( newMotorManagement As MotorManagementEnum )
 Public Function VerificaMotore ( ByRef motore As MotoreType,  criterioAllarme As String ) As Boolean
 Public Function VerificaMotorePred ( ByRef motore As MotorePredosatoreType,  criterioAllarme As String ) As Boolean
 Public Sub VerificaMotoriAccesi ( )
Private:

Documentation:

Module "GestioneOreLavoro"

Public:


Methods:
 Public Sub AzzeraOreLavoroMotori ( motore As Integer,  totale As Boolean )
 Public Sub CalcolaOreLavoroMotori ( )
 Public Sub LeggeFileOreLavoro ( )
Private:


Constants:
 Private Const FileOreLavoro = "OreMotori.ini"
 Private Const SEZIONE As String = "Motore" 
Methods:
 Private Sub ScriveFileOreLavoro ( motore As Integer )
Documentation:

Module "GestionePredNastriC"

Public:


Constants:
 Public Const FileUmiditaPredosatore = "Umidita-Predosatore.ini"
 Public Const FileUmiditaPredosatoreRic = "Umidita-PredosatoreRic.ini" 
Types:
 Public Enum NastriPredosatori
 Public Type TolleranzaNastro 
Properties:
 Public AbilitaInversioneCollettore As Boolean
 Public AbilitaInversioneLanciatore As Boolean
 Public AbilitaInversioneRiciclato As Boolean
 Public AutomaticoPredosatori As Boolean
 Public impulsoResetTotNastri As TemporizzatoreStandardType
 Public InvertiNumerazionePred ( 0 To MaxNastri - 1 ) As Boolean
 Public NumeroPredosatoriNastroC ( 0 To MaxNastri - 1 ) As Integer
 Public OraAllarmePredosatori As Long
 Public PesoBilanciaInerti As Single
 Public PesoBilanciaInertiSecco As Single
 Public PesoBilanciaRiciclato As Single
 Public PesoBilanciaRiciclatoParDrum As Integer
 Public PesoBilanciaRiciclatoSecco As Single
 Public PidPonderaleNastroRic As PidType
 Public PonderaleNastroRicAttvo As Boolean
 Public PortataMaxRamseyInerti As Integer
 Public PortataMaxRamseyRic As Integer
 Public PredosatoreRiciclatoVuoto As Boolean
 Public PredosatoreVergineVuoto As Boolean
 Public PredosatoriAutomaticoOn As Boolean
 Public ShowColdRecyScreen As Boolean
 Public ShowHotRecyScreen As Boolean
 Public TempoPermanenzaAllarmePredosatori As Integer
 Public TermicaPredosatori As Boolean
 Public TolleranzaNastroInerti As TolleranzaNastro
 Public TolleranzaNastroRAP As TolleranzaNastro
 Public TotaleUmiditaPredosatore As Double
 Public TotaleUmiditaPredRic As Double
 Public TotaleUmiditaPredRicParDrum As Double
 Public TotalizzazioneNastroAggr As Double
 Public TotalizzazioneNastroRAP As Double
 Public TotalizzazioneNastroRAPParDrum As Double
 Public uscitaAnal As Double
 Public UscitaInversione As Boolean
 Public UscitaInversioneRiciclato As Boolean 
Methods:
 Public Sub AggiornaProssimaRicettaPredos ( )
 Public Sub AvviamentoGestionePredosatori ( )
 Public Sub AvvioPredAutomatico ( )
 Public Function ControllaRicettaPredVuota ( )
 Public Function ControlloPredAutomatico ( nastro As Byte ) As Boolean
 Public Sub DatiSetPredosaggi ( )
 Public Sub GestioneConsumi ( )
 Public Sub GestioneStopPredosatori ( )
 Public Sub LeggeFileUmiditaPredosatore ( )
 Public Sub LeggeFileUmiditaPredosatoreRic ( )
 Public Sub NastroRicRegolazionePonderale ( )
 Public Sub PassaInManualePredosatori ( )
 Public Sub PesoNastroInerti ( )
 Public Sub PesoNastroInerti_change ( )
 Public Sub PesoNastroRiciclato ( )
 Public Sub PesoNastroRiciclato_change ( )
 Public Sub PesoNastroRiciclatoParDrum ( )
 Public Sub PesoNastroRiciclatoParDrum_change ( )
 Public Function PredosatoreSetCalcolato ( ByRef Pred As PredosatoreType,  portataTeorica As Double ) As Integer
 Public Function PredosatoriRicConBilancia ( ) As Boolean
 Public Function PredosatoriRiciclatiAccesi ( ) As Boolean
 Public Function PredosatoriVerginiAccesi ( ) As Boolean
 Public Sub PreparazioneAvvPred ( )
 Public Function PrimoPredosatoreDelNastro ( nastro As NastriPredosatori ) As Integer
 Public Sub PulsanteStopPred ( )
 Public Sub ResetTotalizzatoriNastri ( nastro As Integer )
 Public Sub RichiamoRicettaPredos ( )
 Public Sub RinfrescaNomeRicPreDosaggio ( )
 Public Sub RinfrescaOrigineDatiPredosaggio ( NomeRicPredSel As String,  Optional AggiornaCP240 As Boolean )
 Public Function SelezioneRicettaPredosaggioCambiata ( ) As Boolean
 Public Sub StartPredosatori_change ( )
 Public Function ValoreUscitaAnalogicaPred ( riciclato As Boolean,  ValoreSet As Integer,  ValoreSetReale As Integer ) As Double
 Public Sub VisualizzaPortateNastri ( )
Private:


Properties:
 Private GestioneConsumi_Timer As Double
Documentation:

Module "GestionePredosatori"

Public:


Constants:
 Public Const MAXCURVEPREDOSATORE As Integer = 3
 Public Const MAXPREDOSATORI = 16
 Public Const MAXPREDOSATORIRICICLATO = 8
 Public Const MAXPUNTICURVAPREDOSATORE As Integer = 5 
Types:
 Public Enum BilanciaNastro
 Public Enum CambioSetPredosatoreType
 Public Type CurvaPredosatoreType
 Public Type FeederVibratorWorkingCycle_TYPE
 Public Type GraficoPredosatoreType
 Public Type MotorePredosatoreType
 Public Type PidType
 Public Type PredosatoreType
 Public Type SetPredosatoreType
 Public Enum StatoPredosatoreType 
Properties:
 Public abilitaRinfrescoDati_pred As Boolean
 Public AllarmiPredosatori As Boolean
 Public AlmenoUnoAccesoPredRiciclatoCaldo As Boolean
 Public AlmenoUnoAccesoPredRiciclatoFreddo As Boolean
 Public AlmenoUnoAccesoPredVergini As Boolean
 Public AlmenoUnoPredosatoreAcceso As Boolean
 Public ArrestoImmPred As Boolean
 Public AttesaFineRicetta As Boolean
 Public attesastartplc As Boolean
 Public AvvioPredosatoriSenzaBruciatore As Boolean
 Public ColdFeederVibratorWorkingCycle As FeederVibratorWorkingCycle_TYPE
 Public ConfigPortataNastroInerti As BilanciaNastro
 Public ConfigPortataNastroRiciclato As BilanciaNastro
 Public ConfigPortataNastroRiciclatoParDrum As BilanciaNastro
 Public FrmStatoPredosatoriVisibile As Boolean
 Public ListaPredosatori ( 0 To MAXPREDOSATORI - 1 ) As PredosatoreType
 Public ListaPredosatoriRic ( 0 To MAXPREDOSATORIRICICLATO - 1 ) As PredosatoreType
 Public MemAlmenoUnoAccesoPredRiciclatoCaldo As Boolean
 Public MemAlmenoUnoAccesoPredRiciclatoFreddo As Boolean
 Public MemAlmenoUnoAccesoPredVergini As Boolean
 Public NumeroPredosatoriInseriti As Integer
 Public NumeroPredosatoriRicInseriti As Integer
 Public NumeroPredSiwarex1 As Integer
 Public NumeroPredSiwarex2 As Integer
 Public NumPredRicCaldoProssimoSet As Integer
 Public NumPredRicFreddoProssimoSet As Integer
 Public NumPredVergProssimoSet As Integer
 Public PredosatoriCambioSet As CambioSetPredosatoreType
 Public PredosatoriImmediati As Boolean
 Public RecyColdFeederBlowerWorkingCycle As FeederVibratorWorkingCycle_TYPE
 Public RecyColdFeederVibratorWorkingCycle As FeederVibratorWorkingCycle_TYPE
 Public RitardoStartGriglieVibranti As Integer
 Public RitardoStartVibratorePredVuoto As Integer
 Public RitardoStopGriglieVibranti As Integer
 Public RitardoStopVibratorePredVuoto As Integer
 Public StartPredosatori As Boolean
 Public StartRicPred As Boolean
 Public VisualizzaSetCalcolatoPredosatori As Boolean
 Public Vpred As Long
 Public VRic As Long 
Methods:
 Public Sub CalcolaNumeroPredosatoreSiwarex ( )
 Public Function CalcolaSetNastri ( Index As Integer ) As Double
 Public Function ChkCoherenceMaterial ( IdPredosaggio )
 Public Sub ChkResetColorMateriali ( )
 Public Function ControlloCondizioniStartPreDosaggio ( ) As Boolean
 Public Sub GestioneStoricoPredosaggio ( )
 Public Sub GestioneStoricoPredosaggioAggiungi ( )
 Public Function PIDcontroller ( ByRef pid As PidType,  ByVal uscitaTeorica As Double,  ByVal ValoreTeorico As Double,  ByRef uscitaReale As Double,  ByVal valoreReale As Double ) As Double
 Public Sub PredosatoreCambiaSet ( riciclato As Boolean,  ByVal predosatore As Integer,  valore As Integer,  cambioManuale As Boolean )
 Public Sub PredosatoreInizializza ( )
 Public Sub PredosatoreInVolumetrico ( riciclato As Boolean,  predosatore As Integer,  attivo As Boolean )
 Public Sub PredosatoreManuale ( riciclato As Boolean,  predosatore As Integer,  start As Boolean,  forza As Boolean )
 Public Sub PredosatoreMinimoVuoto_change ( ByVal predosatore As Integer )
 Public Function PredosatoreOttieniMaterialeLogId ( ByRef Pred As PredosatoreType ) As Long
 Public Function PredosatoreOttieniNome ( ByRef Pred As PredosatoreType ) As String
 Public Function PredosatoreOttieniPortata ( ByRef Pred As PredosatoreType ) As Integer
 Public Function PredosatoreOttieniSet ( riciclato As Boolean,  ByVal predosatore As Integer ) As Integer
 Public Sub PredosatoreRiciclatoMinimoVuoto_change ( ByVal predosatore As Integer )
 Public Sub PredosatoreRiciclatoRitorno_change ( ByVal predosatore As Integer )
 Public Sub PredosatoreRicUscita_change ( ByVal predosatore As Integer )
 Public Sub PredosatoreRitorno_change ( ByVal predosatore As Integer )
 Public Sub PredosatoreUscita_change ( ByVal predosatore As Integer )
 Public Sub PredosatoreVerificaSet ( ByRef Pred As PredosatoreType,  forza As Boolean )
 Public Function PredosatoriAccesi ( riciclato As Boolean,  nastro As Integer ) As Boolean
 Public Sub PredosatoriArrestoImmediato ( riciclato As Boolean,  nastro As Integer )
 Public Function PredosatoriCalcoloUmiditaTotale ( tutti As Boolean ) As Double
 Public Function PredosatoriCalcoloUmiditaTotaleTmp ( Umidita ( ) As Double,  tutti As Boolean ) As Double
 Public Sub PredosatoriInManuale ( )
 Public Sub PredosatoriInStartAutomatico ( start As Boolean )
 Public Sub PredosatoriRicalcolaSet ( )
 Public Function PredosatoriRiciclatoCalcoloUmiditaTotale ( Index As Integer ) As Double
 Public Function PredosatoriRiciclatoCalcoloUmiditaTotaleTmp ( Umidita ( ) As Double,  Index As Integer ) As Double
 Public Sub PredosatoriSet_timer ( )
 Public Sub RitardoSoffioPredVuoto ( )
 Public Sub RitardoVibratorePredVuoto ( )
 Public Sub SelectFeederRecipeByCS ( IdRecipe As Long )
 Public Sub SetPredosatoreRicUscita ( ByVal predosatore As Integer,  valore As Boolean )
 Public Sub SetPredosatoreUscita ( ByVal predosatore As Integer,  valore As Boolean )
 Public Sub SetRiduzioneProduzione ( nuovaRiduzione As Integer )
 Public Sub StartPreDosaggio ( )
 Public Sub TermicaPredosatori_change ( )
 Public Sub VisualizzaPredosatoriImpostati ( )
 Public Sub VisualizzaPredosatoriRicImpostati ( )
 Public Sub VisualizzaRiduzioneProduzione ( )
Private:


Constants:
 Private Const SECONDIXCAMBIO As Integer = 3 
Properties:
 Private feederRecipeListAlreadyDone As Boolean
 Private LampeggioLampada As Boolean
 Private LampeggioLampadaTm As Long
 Private StoricoPredosaggioGroupID As Long
 Private StoricoPredosaggioTm As Long 
Methods:
 Private Sub AvvisoPredosatoreVuoto ( ByRef Pred As PredosatoreType )
 Private Sub DisposizionePredNC1 ( i As Integer )
 Private Sub DisposizionePredNC2 ( i As Integer )
 Private Sub DisposizionePredNC3 ( i As Integer )
 Private Sub DisposizionePredNCRic1 ( i As Integer )
 Private Sub DisposizionePredNCRic2 ( i As Integer )
 Private Sub DisposizionePredNRicJolly ( i As Integer,  position As Integer )
 Private Sub GestioneStoricoPredosaggioAggiungiPred ( ByRef rs As adodb. Recordset )
 Private Sub GestioneStoricoPredosaggioAggiungiTorre ( ByRef rs As adodb. Recordset )
 Private Sub PredosatoreAcceso ( ByVal predosatore As Integer,  ByVal acceso As Boolean )
 Private Sub PredosatoreAutomatico ( Pred As PredosatoreType,  start As Boolean )
 Private Sub PredosatoreCambiaStato ( ByRef Pred As PredosatoreType,  nuovoStato As StatoPredosatoreType )
 Private Sub PredosatoreInserisciSet ( ByRef Pred As PredosatoreType,  valore As Integer,  cambioManuale As Boolean )
 Private Sub PredosatoreProssimoSet ( ByRef Pred As PredosatoreType,  forzaTempi As Boolean )
 Private Sub PredosatoreRegolazionePonderale ( ByRef Pred As PredosatoreType )
 Private Sub PredosatoreRiciclatoAcceso ( ByVal predosatore As Integer,  ByVal acceso As Boolean )
 Private Function PredosatoreRitardato ( ByRef Pred As PredosatoreType ) As Boolean
 Private Sub PredosatoreUscitaAnalogica ( ByRef Pred As PredosatoreType,  ValoreSet As Integer )
 Private Sub PredosatoreVolumetricoPonderale ( ByRef Pred As PredosatoreType,  attivo As Boolean )
 Private Sub PredosatoriVerificaAllarme ( )
 Private Sub VisualizzaMinMaxPonderale ( ByRef Pred As PredosatoreType )
Documentation:

Module "GestioneRiciclato"

Public:


Properties:
 Public AbilitaDeflettoreAnello As Boolean
 Public AbilitaDeflettoreAnelloElevatoreRic As Boolean
 Public AbilitaModulatoreDeflettoreAnello As Boolean
 Public AbilitaNastroDeflettoreAnello As Boolean
 Public AspFumiRAP_PARA_TempoApertura As Integer
 Public AspiratoreFresatoFreddo As Boolean
 Public AspiratoreFresatoFreddo_OLD As Boolean
 Public AttesaRitornoRifrantumazione As Integer
 Public ComandoRifrantumazione As Boolean
 Public DeflettoreByPassTamburoParalleloFCNastro As Boolean
 Public DeflettoreByPassTamburoParalleloFCTamburo As Boolean
 Public DeflettoreByPassTamburoParalleloVersoNastro As Boolean
 Public DeflettoreMulinoEXT As Integer
 Public DeflettoreRiciclatoComandoElevatore As Boolean
 Public DeflettoreRiciclatoFcAnello As Boolean
 Public DeflettoreRiciclatoFcElevatore As Boolean
 Public InclusioneRifrantumazione As Boolean
 Public LivelloAltoTramoggiaRic As Boolean
 Public LivelloBassoTramoggiaRic As Boolean
 Public ManualeAspFresatoFreddo As Boolean
 Public ManualeDeflettoreByPassTamburoParallelo As Boolean
 Public ModulatoreDeflettoreAnelloInApertura As Boolean
 Public ModulatoreDeflettoreAnelloInChiusura As Boolean
 Public NastriRiciclatoCaldoTimeout As Long
 Public NastriRiciclatoFreddoTimeout As Long
 Public NastroDeflettoreAnelloAcceso As Boolean
 Public NastroDeflettoreAnelloAccesoOld As Boolean
 Public NastroDeflettoreAnelloSpento0 As Integer
 Public NettoRAPBilancia As Double
 Public NettoRAPSiwaBilancia As Double
 Public OrarioPredAutoChange As Long
 Public OraStartAspirazioneFumiRAP As Long
 Public OraStartDurataAspirazioneFumiRAP As Long
 Public OraStartRifrantumazione As Long
 Public OraStartRitardoAspirazioneFumiRAP As Long
 Public OraStopPredosatoreRic ( 8 ) As Long
 Public PosizioneModulatoreDeflettoreAnello As Integer
 Public RiciclatoInTramoggia As Boolean
 Public RitardoAllarmeVaglio As Long
 Public RitornoAspFresatoFreddo As Boolean
 Public RitornoRifrantumazione As Boolean
 Public TempoSpegnimentoNastriCollettori As Long
 Public TempoSpegnimentoNastriRiciclatoCaldo As Long
 Public TermicaRifrantumazione As Boolean
 Public VaglioRiciclatoNastro As Boolean
 Public VaglioRiciclatoPesata As Boolean
 Public ValoreRicInEssicatore As Boolean
 Public ValoreRicInTramoggia As Boolean 
Methods:
 Public Sub AggiornaDeflettoreRiciclato ( )
 Public Sub AggiornaDeflettoreRiciclatoAnelloElevRic ( )
 Public Sub AspiraFumiFresatoFreddo_change ( comando As Boolean )
 Public Sub AspiraFumiFresatoFreddoContinuo ( )
 Public Sub AvviaElevatoreRiciclato ( )
 Public Sub CheckDeflettoreRiciclato ( )
 Public Sub ControlloPosizioneDeflVaglio ( )
 Public Sub DatiSetPredRiciclato ( )
 Public Sub DatiSetPredRiciclatoParDrum ( )
 Public Sub GestioneAspFresatoFreddo ( )
 Public Sub GestioneBilanciaRAPSiwa ( )
 Public Sub GestioneDeflettoreMulino ( )
 Public Sub GestioneRiciclatoInTramoggia ( )
 Public Sub GestioneRifrantumazioneRiciclato ( )
 Public Sub GestioneSicurezzaBilanciaRAP ( )
 Public Sub LivelloTramoggiaRic_change ( )
 Public Sub ModulatoreDeflettoreAnelloApre ( comando As Boolean )
 Public Sub ModulatoreDeflettoreAnelloChiude ( comando As Boolean )
 Public Sub PosizioneModulatoreDeflettoreAnello_change ( )
 Public Sub RAPInScarico_Change ( )
 Public Sub RAPSiwaInScarico_Change ( )
 Public Sub SetDeflettoreRiciclato ( nuovoComando As Boolean )
 Public Sub TermicaRifrantumazione_change ( )
 Public Sub VerificaNastroDeflettoreAnello ( )
 Public Sub VisualizzaNastroDeflettoreAnello ( )
Private:

Documentation:

Module "GestioneSiloGenerale"


If (DestinazioneSilo <> 0) Then 20151124 Call CelleSiloScriviTXT(NumeroModuloSilo) End If End If
Exit Sub Errore: LogInserisci True, "SIL-012", CStr(Err.Number) + " [" + Err.description + "]" End Sub 20151124 NUOVA GESTIONE SILI DEPOSITO

Public:


Constants:
 Public Const MAXNUMSILI As Integer = 12
 Public Const Semaforo_benna_index = 200
 Public Const Semaforo_sili_index = 201
 Public Const SILI_Diretto_PC = 11
 Public Const SILI_Diretto_PLC = 0
 Public Const SILI_MAXPLC = 21
 Public Const SILI_Rifiuti_PC = 12
 Public Const SILI_Rifiuti_PLC = 21 
Types:
 Public Type DatoSiloMsgPlusType
 Public Type DeodoranteSilo
 Public Type Semaforo_Type
 Public Type SiloType 
Properties:
 Public AbilitaBilanciaCamion As Boolean
 Public AbilitaCelleCaricoSilo As Boolean
 Public AbilitaFiltroBilanciaCamion As Boolean
 Public AbilitaLetturaSiliDeposito As Boolean
 Public AbilitaResetCelle As Boolean
 Public AbilitaTemperaturaSilo As Boolean
 Public AbilitaVisPesoSili As Boolean
 Public AbilitazioneSemaforoBenna As Boolean
 Public AbilitazioneSemaforoSili As Boolean
 Public AbilitazioneSpruzzaturaBennaTemporizzata As Boolean
 Public BennaFineCorsaInf As Boolean
 Public BennaFineCorsaInfAsse2 As Boolean
 Public BennaPronta As Boolean
 Public BennaSu As Boolean
 Public BennaVisualizzata As Integer
 Public BinarioOkScaricoDir As Boolean
 Public CamionPresente As Boolean
 Public CelleSiloConfigurazioneSilo As String
 Public CelleSiloConsensoCarico_IN ( 3 ) As Boolean
 Public CelleSiloConsensoScarico_OUT ( 3 ) As Boolean
 Public CelleSiloDetrarreTara ( 5 ) As Double
 Public CelleSiloNavettaInScarico As Boolean
 Public CelleSiloNomeFile As String
 Public CelleSiloStabilizzazioneBilancia As Double
 Public CelleSiloTaraBilancia As Double
 Public CelleSiloTolleranzaBilancia As Double
 Public CelleSiloUltimoScaricoAperto As Integer
 Public CelleSiloUltimoStabile ( 5 ) As Double
 Public CelleSiloValoreLetto ( 5 ) As Double
 Public ConfigSilo As String
 Public ConfigurazioneTemperatureSilo As String
 Public DatoSiloMsgPlus As DatoSiloMsgPlusType
 Public Deodorante As DeodoranteSilo
 Public DestinazioneSilo As Integer
 Public DestinazioneSiloPrenotata As Integer
 Public DopoPrimoTrasferimentoSiliDeposito As Boolean
 Public EventoCaricoSilo As Boolean
 Public EventoTelescarico As Boolean
 Public FondoScalaBilanciaCamion As Double
 Public FondoScalaPesoSilo As Double
 Public FrmSiloGeneraleVisibile As Boolean
 Public IdClienteScaricoSilo As Integer
 Public IdTargaCamionScaricoSilo As Integer
 Public InclusioneBenna As Boolean
 Public InclusioneBennaApribile As Boolean
 Public InclusioneTempiAnticipo As Boolean
 Public InvertiQuoteXGraficoBennaS7 As Boolean
 Public InvertiQuoteYGraficoBennaS7 As Boolean
 Public LetturaTemperaturaSilo As Boolean
 Public ListaSili ( 1 To MAXNUMSILI ) As SiloType
 Public MaxPirometroSilo ( 0 To 5 ) As Integer
 Public MaxTara As Double
 Public MemDestinazioneSiloPrenotata As Integer
 Public MemIdDosaggioLogScarico As Double
 Public NavettaInScarico As Boolean
 Public NavettaPosizioneCarico As Boolean
 Public NumCampioniBilanciaCamion As Integer
 Public NumeroPirometriSilo As Integer
 Public NumeroSili As Integer
 Public NumeroSiloLetturaTemperatura As Integer
 Public NumeroVisPesoSili As Integer
 Public PesoImpastoPerSilo_InAttesa As Long
 Public PesoImpastoPerSilo_InViaggio As Long
 Public PresenzaSiloDiretto As Boolean
 Public PresenzaSiloDirettoConPeso As Boolean
 Public PresenzaSiloRifiuti As Boolean
 Public PresenzaSiloRifiutiConPeso As Boolean
 Public RinfrescoLetturaSiliDeposito As Boolean
 Public ScompartoScaricoSiloNoCelle As Integer
 Public SemaforoBenna As Semaforo_Type
 Public SemaforoSili As Semaforo_Type
 Public SiliDepositoTrasfPar As Boolean
 Public SiliParOk As Boolean
 Public SiloCar_Tele As Integer
 Public SiloSottoDeflettori1D2 As Boolean
 Public SirenaSiloAttiva As Boolean
 Public TempiCelleSilo ( 1 To MAXNUMSILI ) As Integer
 Public TempoCampioniBilanciaCamion As Long
 Public TempoColpettiTelesc As Double
 Public VerificareBenna As Boolean
 Public VisualizzaBenna As Boolean
 Public VisualizzaCamionPerSiloDiretto As Boolean 
Methods:
 Public Sub AggiornaAnalogicaPesaCamion_change ( )
 Public Sub AggiornaImgSemaforo ( verde As Boolean,  attesa As Boolean,  semaforo As Boolean )
 Public Sub AggiornaPesoSilo ( DestinazioneSilo As Integer )
 Public Sub AttivazioneSilo ( silo As Integer,  siloAttivo As Boolean,  ritornoSilo As Boolean )
 Public Function AzzeraSeNegativo ( valore As Variant ) As Variant
 Public Function CalcolaNumeroModuliSilo ( Stringa ) As Integer
 Public Sub CaricoSilo_change ( silo As Integer )
 Public Sub CelleSiloInizializza ( )
 Public Sub CelleSiloLeggiTXT ( NumeroModuloSilo As Integer )
 Public Sub CelleSiloLeggiTXTCamion ( )
 Public Sub CelleSiloScriviTXT ( NumeroModuloSilo As Integer )
 Public Sub CelleSiloScriviTXTCamion ( )
 Public Sub CelleSiloValoreLetto_change ( silo As Integer )
 Public Function DestinazioneSiloAppartieneModuloSilo ( destinazione As Integer,  NumeroModulo As Integer ) As Boolean
 Public Function GetDescrFromIdDosaggioLOG ( IdDosaggioAct As Double ) As String
 Public Function GetIdDosaggioLogFromIdDosaggio ( IdDosaggioAct As Double ) As Integer
 Public Function GetIdDosaggioLOGScarico ( IdDosaggioAct As Integer ) As Integer
 Public Function GetSiloFromConfigSilo ( Index As Integer ) As String
 Public Function GetSiloHexCode ( silo As String ) As String
 Public Function GetSiloIndex ( silo As String ) As Integer
 Public Function GetSiloString ( silo As Integer ) As String
 Public Sub LetturaTemperaturaSilo_change ( )
 Public Sub LivelloAltoScomparto_change ( indice As Integer )
 Public Sub MessaggioSiloToPlus ( DatoSilo As DatoSiloMsgPlusType,  Optional NumeroTelescarico As Integer )
 Public Sub NavettaPosizioneCarico_change ( )
 Public Sub PesoCamion_change ( )
 Public Function PlcToSiloVB ( indice As Integer ) As Integer
 Public Sub PortinaScaricoSilo_Change ( NumeroSiloScaricato As Integer )
 Public Sub PosizionaSiliCP240 ( )
 Public Sub PosizioneDeodorante ( )
 Public Sub RegistraScaricoSiloDB ( )
 Public Function RicavaDestinazioniDaModuloSilo ( NumeroModulo As Integer,  StringaConfigurazione As String ) As String
 Public Function RicavaModuloSiloDaDestinazione ( destinazione As Integer ) As Integer
 Public Sub ScaricoSiloSenzaCelleCarico ( Peso As String )
 Public Function ScompartiCompatta ( ByVal scomparto As Integer ) As Integer
 Public Function ScompartiCompattaSalta ( ByVal scomparto As Integer ) As Integer
 Public Function ScompartiSiliPC_a_PLC ( ByVal scomparto As Integer ) As Integer
 Public Function ScompartiSiliPLC_a_PC ( ByVal scomparto As Integer ) As Integer
 Public Sub SegnalazioneBennaSu ( BennaSu As Boolean )
 Public Sub SegnalazioneScaricoBennaNavetta ( InScarico As Boolean )
 Public Function ShowConfermaCambioSilo ( ) As Boolean
 Public Function SiloConfig2Combo ( silo As String ) As String
 Public Sub SiloGenerale ( )
 Public Sub SiloLeggiTXTSenzaCelle ( scomparto As Integer )
 Public Sub SiloScriviTXTSenzaCelle ( scomparto As Integer )
 Public Function SiloVBToPlc ( indice As Integer ) As Integer
 Public Sub TelescarichiSilo_Change ( silo As Integer )
 Public Sub TelescaricoSilo_change ( scomparto As Integer )
 Public Sub ValoreTempSilo_change ( silo As Integer,  temperatura As Long )
 Public Function VerificaEsistenzaSilo ( silo As Integer ) As Boolean
 Public Sub VerificaSirenaLivelloAlto ( indice As Integer )
 Public Sub VisualizzaSiloAttivo ( usaFrmSilo As Boolean )
 Public Sub VisualizzaSiloPieno ( silo As Integer )
Private:

Documentation:

 Public Sub RegistraScaricoSiloDB ( )
.DatoPlusIdRicetta = ListaSili(CelleSiloUltimoScaricoAperto).idMateriale .DatoPlusIdRicetta = 0 Else .DatoPlusRicetta = CP240.LblNomeRicDos(1).caption If (CP240.LblNomeRicDos(2).caption <> "") Then 20150921 .DatoPlusIdRicetta = CLng(CP240.LblNomeRicDos(2).caption) Else 20150921 .DatoPlusIdRicetta = 0 20150921 End If 20150921 End If

.DatoPlusPesoSilo = BilanciaPesaCamion.Peso per prendere i decimali

Formato stringa: Numero Silo-Valore Temperatura-ID Ricetta-Nome Ricetta-Peso silo messaggio = "" messaggio = messaggio + .DatoPlusNumeroSilo + separatore messaggio = messaggio + CStr(.DatoPlusTemperatura) + separatore messaggio = messaggio + CStr(.DatoPlusIdRicetta) + separatore messaggio = messaggio + .DatoPlusRicetta + separatore messaggio = messaggio + CStr(.DatoPlusPesoSilo) + separatore messaggio = messaggio + CStr(.DatoPlusPesoSilo)

End With

Call SendMessagetoPlus(PlusSendShowSILODISCHARGEMANAGER, messaggio)

Exit Sub Errore: LogInserisci True, "SIL-006", CStr(Err.Number) + " [" + Err.description + "]" End Sub



module| index| back| top
Module "GestioneSiloS7"

Public:


Types:
 Public Enum SiloStateType 
Properties:
 Public InclusioneSilo2S7 As Boolean
 Public InclusioneSiloS7 As Boolean
 Public MemWidthshAreaGrPosNav As Double
 Public QuotaMaxGraficoSiloS7AsseX As Double
 Public QuotaMaxGraficoSiloS7AsseY As Double
 Public QuotaMinGraficoSiloS7AsseX As Double
 Public QuotaMinGraficoSiloS7AsseY As Double
 Public Silo2S7BennaPiena As Boolean
 Public Silo2S7BwLocked As Boolean
 Public Silo2S7FcAperto As Boolean
 Public Silo2S7FwLocked As Boolean
 Public Silo2S7InPosition As Boolean
 Public Silo2S7PosisetRampaDOWN As Double
 Public Silo2S7PosisetRampaUP As Double
 Public Silo2S7PosisetTolleranza As Double
 Public Silo2S7PosisetVeloxMax As Double
 Public Silo2S7PosisetVeloxMin As Double
 Public Silo2S7Posizione As Double
 Public Silo2S7PosizioneSilo ( 0 To 18 ) As Double
 Public Silo2S7PosizioneSiloD As Double
 Public Silo2S7PosizioneSiloR As Double
 Public Silo2S7RapportoImpulsiUnitaMisura As Double
 Public Silo2S7RitPosiPT As Long
 Public Silo2S7SyncroOn As Boolean
 Public Silo2S7Target As Double
 Public Silo2S7TempoScaricoPT As Long
 Public Silo2S7TempoSpruzzaAntiadesivo As Long
 Public Silo2S7VelInverterReale As Double
 Public Silo2S7VelInverterTeo As Double
 Public Silo2S7VelManualeJog As Double
 Public Silo2S7VelocitaCalc As Double
 Public Silo2S7ZerosetMoveSpeed As Double
 Public Silo2S7ZerosetSearchSpeed As Double
 Public Silo2S7ZerosetZeroSpeed As Double
 Public SiloS7AckAllarmi As Boolean
 Public SiloS7BennaPiena As Boolean
 Public SiloS7BwLocked As Boolean
 Public SiloS7FcAperto As Boolean
 Public SiloS7FwLocked As Boolean
 Public SiloS7InPosition As Boolean
 Public SiloS7PosisetRampaDOWN As Double
 Public SiloS7PosisetRampaUP As Double
 Public SiloS7PosisetTolleranza As Double
 Public SiloS7PosisetVeloxMax As Double
 Public SiloS7PosisetVeloxMin As Double
 Public SiloS7Posizione As Double
 Public SiloS7Posizione1AntiadesivoAux As Double
 Public SiloS7Posizione1AntiadesivoMain As Double
 Public SiloS7Posizione2AntiadesivoAux As Double
 Public SiloS7Posizione2AntiadesivoMain As Double
 Public SiloS7PosizioneSilo ( 0 To 18 ) As Double
 Public SiloS7PosizioneSiloD As Double
 Public SiloS7PosizioneSiloR As Double
 Public SiloS7QuotaMinima As Double
 Public SiloS7RapportoImpulsiUnitaMisura As Double
 Public SiloS7RitardoPosizionaSottoMixer As Integer
 Public SiloS7RitPosiPT As Long
 Public SiloS7SyncroOn As Boolean
 Public SiloS7Target As Double
 Public SiloS7TempoScaricoPT As Long
 Public SiloS7TempoSpruzzaAntiadesivo As Long
 Public SiloS7VelInverterReale As Double
 Public SiloS7VelInverterTeo As Double
 Public SiloS7VelManualeJog As Double
 Public SiloS7VelocitaCalc As Double
 Public SiloS7ZerosetMoveSpeed As Double
 Public SiloS7ZerosetSearchSpeed As Double
 Public SiloS7ZerosetZeroSpeed As Double
 Public SiloStatus As SiloStateType
 Public SiloStatusLock As Boolean
 Public SiloStatusMem As Integer
 Public SiloStatusWarningMem As Boolean 
Methods:
 Public Sub AbilitaOggettiSiloS7 ( full As Boolean )
 Public Sub CalcoloQuotePosGraficaSiloS7 ( )
 Public Function DefinisciTAG_Silo ( ) As Integer
 Public Function Linearizza ( valore As Double,  K1min As Double,  K2max As Double,  LoLim As Double,  HiLim As Double ) As Double
 Public Sub ResetCmdSilo ( )
 Public Sub ScriviDestinazioneSilo ( destinazione As Integer )
 Public Sub SetSiloS7Start ( )
 Public Sub SetStatoSiloS7AutoMan ( )
 Public Sub SetStatoSiloS7Jog ( )
 Public Sub SetStatoSiloS7Stop ( )
 Public Sub SiloS7GestioneAllarmi ( ByRef IdDescrizione As Integer,  ByRef IndirizzoPLC As String )
 Public Function SiloS7GetPosizioneSilo ( asse As Integer,  silo As String ) As Double
 Public Sub SiloS7IconStatusUpdate ( )
 Public Sub SiloS7InviaParametri ( )
 Public Sub SiloS7Leggi ( forza As Boolean )
 Public Sub SiloS7Scrivi ( )
 Public Sub SiloS7ScriviPosizioni ( )
 Public Sub SiloS7ShowPosition ( )
 Public Sub SiloS7WarnigEvent ( )
Private:


Properties:
 Private SiloS7Leggi_Fatta As Boolean 
Methods:
 Private Function SiloImmagineStato ( siyncroOn As Boolean,  fcAperto As Boolean,  piena As Boolean ) As String
 Private Sub SiloS7Position_changed ( )
 Private Sub SiloS7Speed_changed ( )
 Private Sub SiloS7Stato_changed ( )
Documentation:

Module "GestioneSiwarex"

Public:


Types:
 Public Type SiwarexConfigurationType
 Public Enum SiwarexEnum
 Public Type SiwarexLetturaDI 
Properties:
 Public AbilitaAspirazFumiRAP As Boolean
 Public AbilitaRAPSiwa As Boolean
 Public CodiceComandoSiwarex As Integer
 Public FrmSiwarexParaVisibile As Boolean
 Public NumeroSiwarex As Integer
 Public Siwarex ( 0 To SivarexMax - 1 ) As SiwarexConfigurationType
 Public SiwarexPESA_Kg_Velox_MIN As Integer
 Public SiwarexPESA_Velox_MAX_AO As Integer
 Public SiwarexPESA_Velox_MIN_AO As Integer
 Public SiwarexStatoDI ( 0 To SivarexMax - 1 ) As SiwarexLetturaDI
 Public StepDR03 As Integer
 Public StepDR30 As Integer
 Public StepDR33 As Integer
 Public StepScriviDR3 As Integer
 Public StepScriviDR5 As Integer 
Methods:
 Public Function AssociaSiwarexPredosatori ( )
 Public Sub AttivaComandoSiwarex ( siwarexIndex As SiwarexEnum )
 Public Function DefinisciTAG_LOG_COMANDI_SIWA5 ( ) As Integer
 Public Sub FileToSiwa ( siwarexIndex As SiwarexEnum )
 Public Sub INVIA_DatiRapSiwa ( Optional AvvioProgramma As Boolean )
 Public Sub LeggiDatiDaSiwarex ( step As Integer,  bilancia As SiwarexEnum )
 Public Function PredosatoriSiwarex ( ) As Boolean
 Public Sub SiwarexInviaParametriPlc ( siwarexIndex As SiwarexEnum,  NumDR As Integer )
 Public Sub SiwarexLeggiDaFile ( siwarexIndex As SiwarexEnum )
 Public Sub SiwarexLeggiTutteDaFile ( )
 Public Sub SiwarexScriviSuFile ( siwarexIndex As SiwarexEnum )
 Public Sub SiwaToFile ( siwarexIndex As SiwarexEnum )
Private:


Constants:
 Private Const FileSiwarex As String = "Siwarex.ini"
 Private Const SEZIONE As String = "Siwarex"
Documentation:

Module "GestioneTrend"

Public:


Types:
 Public Type trend
 Public Type TrendProfilo
 Public Enum TrendType 
Properties:
 Public TrendLista ( 0 To NumTrend - 1 ) As trend
 Public TrendListaProfili ( 0 To NumTrend - 1 ) As TrendProfilo
 Public TrendNumeroProfiliDaParametri As Long
 Public TrendPortataOrariaMixerCicliEseguiti As Date
 Public TrendSaltaCampionamenti As Boolean 
Methods:
 Public Sub TrendCampionamento ( )
 Public Function TrendCampionamentoInserisciEvento ( evento As TrendType,  time As Date,  valore As Double ) As Boolean
 Public Sub TrendInizializza ( )
 Public Function TrendMaxDataCampionamento ( ) As Date
 Public Function TrendProfiloElimina ( ) As Boolean
 Public Function TrendProfiloInserisci ( ByVal indice As TrendType ) As Boolean
 Public Sub TrendSetRunTimeCs ( pen As Integer,  add As Boolean )
 Public Sub TrendVerificaData ( )
Private:


Properties:
 Private CsSampleCount As Long 
Methods:
 Private Function TrendCampionamentoInserisci ( pi As Integer,  time As Date,  Value As Double ) As Boolean
Documentation:

Module "GestioneViatop"

Public:


Properties:
 Public AutomaticoViatop As Boolean
 Public CicloneMinViatop As Boolean
 Public ComandoPesataViatop As Boolean
 Public ComandoScaricoBilanciaViatop As Boolean
 Public ComandoScaricoCicloneViatop As Boolean
 Public ComandoVentolaViatop As Boolean
 Public InclusioneViatop As Boolean
 Public LivelloMinViatop As Boolean
 Public NettoViatop As Double
 Public NettoViatopBuffer ( 0 To 1 ) As Double
 Public PermanenzaScaricoBilanciaViatop As Integer
 Public PermanenzaScaricoCicloneViatop As Integer
 Public ScaricoBilanciaViatopChiuso As Boolean
 Public ScaricoCicloneViatopChiuso As Boolean 
Methods:
 Public Sub BilanciaViatopPeso_change ( )
 Public Sub CicloneMinViatop_Change ( )
 Public Sub ComandoPesataViatop_Change ( )
 Public Sub ComandoScaricoBilanciaViatop_Change ( )
 Public Sub ComandoScaricoCicloneViatop_Change ( )
 Public Sub ComandoVentolaViatop_Change ( )
 Public Sub GestioneSicurezzaViatop ( )
 Public Sub ScaricoBilanciaViatopChiuso_change ( )
 Public Sub ScaricoCicloneViatopChiuso_Change ( )
 Public Sub SegnalazioneLivelloMinViatop ( attivo As Boolean )
 Public Sub ValoreLivelloMinViatop_change ( )
Private:

Documentation:

Module "ImpastiManuali"

Public:


Types:
 Public Type ScManualeComponente 
Properties:
 Public CodiceCompScManuale As Integer
 Public FronteScCicloneViatopManuale As Boolean
 Public FronteScMescMemManuali As Boolean
 Public MemFronteEmergenzaDosaggio As Boolean
 Public MemPesataManualeAggregatiAttivata As Boolean
 Public MemPesataManualeBitumeAttivata As Boolean
 Public MemPesataManualeFillerAttivata As Boolean
 Public MemPesataManualeRiciclatoAttivata As Boolean
 Public MemPesataManualeViatopAttivata As Boolean
 Public MemPesataManualeViatopScarMixer1Attivata As Boolean
 Public MemPesataManualeViatopScarMixer2Attivata As Boolean
 Public PesoAggregatiManuale As Double
 Public PesoBitumeManuale As Double
 Public PesoFillerManuale As Double
 Public PesoRiciclatoManuale As Double
 Public PesoTotaleAggregatiManuale As Double
 Public PesoTotaleBitumeManuale As Double
 Public PesoTotaleFillerManuale As Double
 Public PesoTotaleRiciclatoManuale As Double
 Public PesoTotaleViatopManuale As Double
 Public PesoTotaleViatopScarMixer1Manuale As Double
 Public PesoTotaleViatopScarMixer2Manuale As Double
 Public PesoViatopManuale As Double
 Public PesoViatopScarMixer1Manuale As Double
 Public PesoViatopScarMixer2Manuale As Double
 Public ScManualeAcqua As ScManualeComponente
 Public ScManualeAddBac As ScManualeComponente
 Public ScManualeAddMesc As ScManualeComponente
 Public ScManualeAddSacchi As ScManualeComponente
 Public ScManualeAggregati ( CompAggregato1 To CompNonVagliato ) As ScManualeComponente
 Public ScManualeBitume ( CompLegante1 To CompLegante3 ) As ScManualeComponente
 Public ScManualeFiller ( CompFiller1 To CompFiller3 ) As ScManualeComponente
 Public ScManualeRiciclato ( CompRAP To CompRAPSiwa ) As ScManualeComponente
 Public ScManualeViatop As ScManualeComponente
 Public ScManualeViatopScarMixer1 As ScManualeComponente
 Public ScManualeViatopScarMixer2 As ScManualeComponente
 Public TotaleKgMescImpastoMan As Double 
Methods:
 Public Sub AbilitaPulsantiPortineMan ( stato As Boolean )
 Public Sub MemorizzaManualiDB ( )
 Public Sub MemPesiAggManEmergenzaDosaggio ( )
 Public Sub MemPesiBitManEmergenzaDosaggio ( )
 Public Sub MemPesiFillManEmergenzaDosaggio ( )
 Public Sub MemPesiViatopManEmergenzaDosaggio ( )
 Public Sub ResettaTimerAggregatiMan ( )
 Public Sub ResettaTimerBitumeMan ( )
 Public Sub ResettaTimerFillerMan ( )
 Public Sub ResettaTimerRiciclatoMan ( )
 Public Sub ResettaTimerViatopMan ( )
 Public Sub ResettaTimerViatopScarMixer1Man ( )
 Public Sub ResettaTimerViatopScarMixer2Man ( )
 Public Sub ResetVariabiliImpaManuali ( )
Private:

Documentation:

Class "MD5"

Public:


Methods:
 Public Function DigestFileToHexStr ( FileName As String ) As String
 Public Function DigestStrToHexStr ( SourceString As String ) As String
 Public Function GetValues ( ) As String
 Function LongLeftRotate ( value As Long,  bits As Long ) As Long
 Public Sub MD5Final ( )
 Public Sub MD5Init ( )
 Public Sub MD5Update ( InputLen As Long,  InputBuffer ( ) As Byte )
Private:


Constants:
 Private Const MAXINT_4 = 2147483647
 Private Const OFFSET_4 = 4294967296 #
 Private Const S11 = 7
 Private Const S12 = 12
 Private Const S13 = 17
 Private Const S14 = 22
 Private Const S21 = 5
 Private Const S22 = 9
 Private Const S23 = 14
 Private Const S24 = 20
 Private Const S31 = 4
 Private Const S32 = 11
 Private Const S33 = 16
 Private Const S34 = 23
 Private Const S41 = 6
 Private Const S42 = 10
 Private Const S43 = 15
 Private Const S44 = 21 
Properties:
 Private ByteBuffer ( 63 ) As Byte
 Private ByteCounter As Long
 Private State ( 4 ) As Long 
Methods:
 Private Sub Decode ( Length As Integer,  OutputBuffer ( ) As Long,  InputBuffer ( ) As Byte )
 Private Function FF ( a As Long,  b As Long,  c As Long,  d As Long,  x As Long,  s As Long,  ac As Long ) As Long
 Private Function GG ( a As Long,  b As Long,  c As Long,  d As Long,  x As Long,  s As Long,  ac As Long ) As Long
 Private Function HH ( a As Long,  b As Long,  c As Long,  d As Long,  x As Long,  s As Long,  ac As Long ) As Long
 Private Function II ( a As Long,  b As Long,  c As Long,  d As Long,  x As Long,  s As Long,  ac As Long ) As Long
 Private Function LongOverflowAdd ( Val1 As Long,  Val2 As Long ) As Long
 Private Function LongOverflowAdd4 ( Val1 As Long,  Val2 As Long,  val3 As Long,  val4 As Long ) As Long
 Private Function LongToString ( Num As Long ) As String
 Private Function LongToUnsigned ( value As Long ) As Double
 Private Sub MD5Transform ( Buffer ( ) As Byte )
 Private Function StringToArray ( InString As String ) As Byte ( )
 Private Function UnsignedToLong ( value As Double ) As Long
Documentation:

Form "MessageBox"

Public:


Properties:
 Public buttonPressed As Integer 
Methods:
 Public Sub ShowMe ( prompt As String,  buttons As Integer,  icons As Integer,  left As Integer,  top As Integer,  modal As Boolean )
 Public Sub WaitingBox ( inAttesa As Boolean )
Private:


Methods:
 Private Sub CmdClose_Click ( Index As Integer )
 Private Sub Form_Load ( )
 Private Sub TmrWaiting_Timer ( )
Documentation:

Module "ModPID"

Public:


Properties:
 Global dblIntegrale As Double
 Global dblPrevErr As Double
 Global dblPrevVal As Double 
Methods:
 Public Sub RegolatorePID_1 ( ByRef blnResetPID As Boolean,  ByVal dblKp As Double,  ByVal dblKi As Double,  ByVal dblKd As Double,  ByVal dblRef As Double,  ByVal dblRealVal As Double,  ByVal dblTc As Double,  ByRef dblPID As Double,  ByRef blnErrore As Boolean )
 Public Sub RegolatorePID_2 ( ByRef blnResetPID As Boolean,  ByVal dblKp As Double,  ByVal dblTi As Double,  ByVal dblTd As Double,  ByVal dblRef As Double,  ByVal dblRealVal As Double,  ByVal dblTc As Double,  ByRef dblPID As Double,  ByRef blnErrore As Boolean )
 Public Sub RegolatorePID_3 ( ByRef blnResetPID As Boolean,  ByVal dblKp As Double,  ByVal dblKi As Double,  ByVal dblKd As Double,  ByVal dblRef As Double,  ByVal dblRealVal As Double,  ByVal dblTc As Double,  ByRef dblPID As Double,  ByRef blnErrore As Boolean )
Private:


Methods:
 Private Sub Limitatore ( ByRef dblPID As Double )
Documentation:

Module "ModuleShowForm"


Disabilita la visualizzazione della Task-Bar. Public Sub ShowTaskBar(Visible As Boolean) Dim tbarhWnd As Long tbarhWnd = FindWindow("Shell_TrayWnd", "") If Visible Then ShowWindow tbarhWnd, SW_SHOW Else ShowWindow tbarhWnd, SW_HIDE End If End Sub
Public:


Methods:
 Public Function ShowMsgBox ( prompt As String,  buttons As Integer,  icons As Integer,  left As Integer,  top As Integer,  modal As Boolean ) As Integer 
Declarations:
 Public Declare Function IsWindowVisible Lib "User32" ( ByVal hWnd As Long ) As Boolean
 Public Declare Function ShowWindow Lib "User32" ( ByVal hWnd As Long,  ByVal nCmdShow As Long ) As Long
Private:


Constants:
 Private Const SW_HIDE = 0
 Private Const SW_SHOW = 5
Documentation:

Module "NetWork"

Public:


Constants:
 Public Const NUMANALOGIN As Integer = 56
 Public Const NUMANALOGOUT As Integer = 32
 Public Const OpcServerName = "Softing.OPC.S7.DA"
 Public Const PLCTAG_BILANCIA_0 = PLCTAG_SIWA0_CMD_INPUT
 Public Const PLCTAG_BILANCIA_1 = PLCTAG_SIWA1_CMD_INPUT
 Public Const SetIP = "127.0.0.1" 
Types:
 Public Enum AnalogEnum
 Public Type AnalogType
 Public Enum PlcTagEnum
 Public Enum QualityEnum 
Properties:
 Public AnalogIO ( NUMANALOGIN + NUMANALOGOUT ) As AnalogType
 Public MancanzaComunicazione As Boolean
 Public MaxValoreTempSottoMesc As Long
 Public ParallelDrum As Boolean
 Public PlcDisabilitaConnessione As Boolean
 Public PlcParametriOk As Boolean
 Public PlcSimulation As Boolean
 Public PlusCommunicationBroken As Boolean
 Public PlusWatchDogTimeout As Long
 Public PlusWatchDogTimeoutAlreadyDone As Boolean
 Public PlusWatchDogTimeoutTimer As Long
 Public TemperaturaTorre As Long 
Methods:
 Public Sub CheckContenutoSili ( )
 Public Function ConversioneUnita0_20mA ( valore As Integer ) As String
 Public Function ConversioneUnita10V ( valore As Integer ) As String
 Public Function ConversioneUnita4_20mA ( valore As Integer ) As String
 Public Function ConversioneUnitaPT100 ( valore As Integer ) As String
 Public Function GetQuality ( quality As Long ) As QualityEnum
 Function GetQualityAsString ( quality As Long )
 Public Sub InizializzaConnessione ( )
 Public Sub InviaParaPesaCamion ( )
 Public Function IsPlcConnected ( ByRef opcDC As OPCDataControl ) As Boolean
 Public Function LoadOPCTags ( ByVal plc As String,  ByRef OPCDataCtrl As OPCDataControl )
 Public Sub Main ( )
 Public Sub PlcCommunicationError ( )
 Public Sub PlcEffettuaConnessione ( )
 Public Sub PlcInAnalogici ( )
 Public Sub PlcInDigitali ( )
 Public Sub PlcOutAnalogici ( )
 Public Sub PlcOutDigitali ( )
 Public Sub SetPlusCommunicationBroken ( isBroken As Boolean,  Optional firstTime As Boolean )
 Public Function VideataPrincipale ( )
Private:


Constants:
 Private Const OPCTagFile As String = "OPCTags.xls" 
Properties:
 Private plcInAnalogici_Fatta As Boolean
 Private plcInAnalogici_Gestfumitamb_Fatta
 Private plcInAnalogici_Gestveltamb_Fatta
 Private PlcInDigitali_Fatta As Boolean
 Private PlusWatchDog As Boolean
 Private PlusWatchDogTimer As Long
 Private TimerVideataPrincipale As Long
Documentation:

Class "Parameter"

Public:


Types:
 Public Enum ParamTypeEnum 
Events:
 Public Event OnValueChanged ( ByVal Value As Variant )
Private:


Properties:
 Private m_code As String
 Private m_Default As Variant
 Private m_Description As String
 Private m_MaxValue As Variant
 Private m_MinValue As Variant
 Private m_ToolTipDescription As String
 Private m_Type As ParamTypeEnum
 Private m_value As Variant 
Methods:
 Private Sub Class_Initialize ( )
 Private Sub Class_Terminate ( )
 Private Sub ValueChanged ( ByVal val As Variant )
Documentation:

Module "ParaTab"

Public:


Constants:
 Public Const DISPLAY_WIDTH_TWIPS As Integer = 28800 
Properties:
 Public ParameterPlus As Configuration 
Methods:
 Sub ParallelDrumManagement ( )
 Public Sub ParametriApply ( )
 Public Sub ParametriReadFile ( )
 Public Sub SendParametersFromPLC ( )
Private:


Properties:
 Private sendParFromPlcDone As Boolean
Documentation:

Module "ParaTabAdd"

Public:


Methods:
 Public Sub ParaTabAdd_Apply ( )
 Public Function ParaTabAdd_ReadFile ( ) As Boolean
Private:


Constants:
 Private Const SEZIONE As String = "Addittivi"
Documentation:

Module "ParaTabAmp"

Public:


Methods:
 Public Sub ParaTabAmp_Apply ( )
 Public Function ParaTabAmp_ReadFile ( ) As Boolean
Private:


Constants:
 Private Const SEZIONE As String = "Motori" 
Methods:
 Private Sub VerificaValoriParAmperometri ( )
Documentation:

Module "ParaTabAquablack"


TODO
Dim i As Integer Dim rs As ADODB.Recordset Dim fld As ADODB.Field

On Error GoTo Errore

If Not CP240.OPCDataAquablack.IsConnected Or CP240.OPCDataAquablack.items.Count = 0 Then Exit Sub End If

Set rs = FrmParametri.AdodcParaAquablack.Recordset.Clone

i = AQUABTAG_AN_H2OPressure_AnalogIN_MAX

With rs

.MoveFirst

Do While Not .EOF

Debug.Print .Fields("italiano").value; .Fields("Valore").value Debug.Print CP240.OPCDataAquablack.Items(i).ItemID

If Right(CP240.OPCDataAquablack.items(i).ItemID, 4) = "REAL" Then in caso di tag REAL va convertito in double, perche in Excel il separatore decimale e la virgola CP240.OPCDataAquablack.items(i).Value = CDbl(.Fields("Valore").Value) Else CP240.OPCDataAquablack.items(i).Value = val(.Fields("Valore").Value) End If

i = i + 1

.MoveNext Loop

End With

CP240.OPCDataAquablack.Update

rs.Close Set rs = Nothing

ScriviTagAquablackOnce = True

Exit Sub

Errore:

If Not rs Is Nothing Then If rs.State = adStateOpen Then rs.Close End If

LogInserisci True, "AQ003", CStr(Err.Number) + " [" + Err.description + "]"

End Sub

Verifica se i dati sono modificati Public Function ParaTabAquablack_IsModified() As Boolean

ParaTabAquablack_IsModified = ParaTabAquablackColumn.modificato

End Function

Public:


Types:
 Public Type ParaTabAquablackColumnType 
Properties:
 Public DgAquablackOldValue ( ) As Variant
 Public ParaTabAquablackColumn As ParaTabAquablackColumnType
 Public ScriviTagAquablackOnce As Boolean 
Methods:
 Public Sub ParaTabAquablack_Apply ( )
 Public Sub ParaTabAquablack_ReadFile ( )
Private:


Constants:
 Private Const SEZIONE As String = "Addittivi"
Documentation:

Module "ParaTabBruc"


20151209 If ListaTamburi(0).AbilitazioneConsumoCombustibile Then
Dim rs As New adodb.Recordset Dim IdAppoggio As String

With rs Set .ActiveConnection = DBcon .Source = "SELECT [IdMaterialeLOG],[Nome] FROM [CYB500].[dbo].[MaterialiLOG] WHERE [Categoria]=4;" .LockType = adLockOptimistic .CursorLocation = adUseClient .CursorType = adOpenStatic .Open , DBcon

If Not .BOF Then 20151217

.MoveFirst

IdAppoggio = FileGetValue(nomeFile, SEZIONE, "IdCombustibileLOG", CStr(.Fields("IdMaterialeLOG").Value))

If IdAppoggio <> "" Then Do Until .EOF If CInt(IdAppoggio) = .Fields("IdMaterialeLOG").Value Then Exit Do .MoveNext .Seek

Loop If .EOF Then nessuna corrispondenza .MoveFirst ListaTamburi(0).IdCombustibileLOG = .Fields("IdMaterialeLOG").Value Else materiale trovato ListaTamburi(0).IdCombustibileLOG = IdAppoggio End If Else se il parametro e nullo assegno il primo combustibile della lista .MoveFirst ListaTamburi(0).IdCombustibileLOG = .Fields("IdMaterialeLOG").Value End If

CP240.adoDBMatCombust.text = .Fields("Nome").Value

End If

.Close

End With End If

End Sub

Public Sub ScriviParametriBruciatorePID()

Continua a leggere e scrivere su file .ini e non su XML (versione Caronte)

Dim nomeFile As String

nomeFile = UserDataPath + FileBruciatore

Call FileSetValue(nomeFile, SEZIONE, "FattoreDiCorrezioneKp", CStr(FattoreDiCorrezioneKp)) Call FileSetValue(nomeFile, SEZIONE, "TInterventoCampionamento", CStr(TInterventoCampionamento)) Call FileSetValue(nomeFile, SEZIONE, "FattoreDiCorrezioneKd", CStr(FattoreDiCorrezioneKd)) Call FileSetValue(nomeFile, SEZIONE, "FattoreDiCorrezioneKi", CStr(FattoreDiCorrezioneKi))

End Sub

Public:


Properties:
 Public AumentoAspirazioneFiltro As Integer
 Public FaseSpegnimentoBruciatore As Boolean
 Public ModoRegolazAspirazFiltroConDeprimometroFiltroIN As Boolean
 Public ModoRegolazAspirazFiltroConDeprimometroTamburo As Boolean
 Public OraSicurezzaTemperaturaFiltroSw As Long
 Public OraStopBruciatore As Long
 Public PermanenzaAggiuntivaAumentoAspirazione As Integer
 Public SicurezzaTemperaturaFiltroSw As Boolean
 Public SuperamentoSogliaAllarmeTemperaturaFiltro As Boolean 
Methods:
 Public Sub ParaTabBruc_Apply ( )
 Public Function ParaTabBruc_ReadFile ( ) As Boolean
Private:


Constants:
 Private Const FileBruciatore As String = "Bruciatore.ini"
 Private Const SEZIONE As String = "Bruciatore"
 Private Const SEZIONE_FILTRO As String = "Filtro"
 Private Const SEZIONE2 As String = "Bruciatore2" 
Methods:
 Private Function String2Fuel ( fuel As String ) As FuelType
Documentation:

Module "ParaTabCist"

Public:


Methods:
 Public Sub LeggiFileCisternaSingola ( cisterna As Integer,  Paragraph As String )
 Public Sub LeggiFileCisterne ( )
 Public Sub ParaTabCist_Apply ( )
 Public Function ParaTabCist_ReadFile ( ) As Boolean
 Public Function ParaTabCist_WriteFile ( ) As Boolean
Private:


Constants:
 Private Const FileCisterne As String = "Cisterne.ini"
 Private Const SEZIONE As String = "Cisterne"
Documentation:

Module "ParaTabComandi"

Public:


Methods:
 Public Sub CaricaTestiComandi ( )
 Public Sub ParaTabComandi_Apply ( )
 Public Function ParaTabComandi_ReadFile ( ) As Boolean
Private:


Constants:
 Private Const SEZIONE As String = "Comandi"
Documentation:

Module "ParaTabDebug"

Public:

Private:

Documentation:

Module "ParaTabDos"

Public:


Methods:
 Public Sub LeggeFileParBilCamion ( )
 Public Sub LeggeFileParDosVar ( )
 Public Sub ParaTabDos_Apply ( )
 Public Function ParaTabDos_ReadFile ( ) As Boolean
 Public Sub ScriveFileParBilCamion ( )
Private:


Constants:
 Private Const FileParametriBilCamion = "PesaCamion.ini"
 Private Const FileParametriVari = "VarParameters.ini"
 Private Const SEZIONE As String = "Dosaggio" 
Methods:
 Private Sub ScriveFileParDosVar ( )
Documentation:

Module "ParaTabGeneral"

Public:


Methods:
 Public Sub ParaTabGeneral_Apply ( )
 Public Function ParaTabGeneral_ReadFile ( ) As Boolean
Private:


Constants:
 Private Const SEZIONE As String = "Generali" 
Properties:
 Private oldLangSelected As Integer
Documentation:

Module "ParaTabLeg"

Public:


Methods:
 Public Sub ParaTabLeg_Apply ( )
 Public Function ParaTabLeg_ReadFile ( ) As Boolean
Private:


Constants:
 Private Const SEZIONE_PLUS As String = "Bitume"
Documentation:

Module "ParaTabMotor"

Public:


Methods:
 Public Sub CaricaTestiMotori ( )
 Public Sub ParaTabMotor_Apply ( )
 Public Function ParaTabMotor_ReadFile ( ) As Boolean
Private:


Constants:
 Private Const SEZIONE As String = "Motori"
Documentation:

Module "ParaTabPred"

Public:


Methods:
 Public Sub CaricaDatiGrafPredosatore ( ByRef Pred As PredosatoreType )
 Public Sub LeggiUmiditaPredSQL ( )
 Public Sub ParaTabPred_Apply ( )
 Public Function ParaTabPred_ReadFile ( ) As Boolean
 Public Sub PlcGriglieVibranti ( )
Private:


Constants:
 Private Const SEZIONE As String = "Predosatori" 
Methods:
 Private Sub LeggiConfigurazionePredosatore ( Pred As PredosatoreType )
 Private Sub ParaTabPred_ToDB ( )
Documentation:

Module "ParaTabSchiumato"

Public:


Types:
 Public Enum PlcSchiumatoEnum
 Public Type PlcSchiumatoType 
Properties:
 Public FrmSchiumaturaVisibile As Boolean
 Public OraAllarme_FC_Valv3Vie_Norm_Soft As Long
 Public PlcSchiumato As PlcSchiumatoType
 Public Schiumato_FC_Valv3Vie_Norm As Boolean
 Public Schiumato_FC_Valv3Vie_Soft As Boolean
 Public SchiumatoOraStartSchiumatura As Long 
Methods:
 Public Sub ParaTabSchiumato_Apply ( )
 Public Function ParaTabSchiumato_ReadFile ( ) As Boolean
 Public Sub PLCSchiumato_Timer ( )
 Public Function PLCSchiumatoAbilitaCiclo ( )
 Public Function PlcSchiumatoAllarme ( ByVal ID As Integer,  ByVal allarme As Long ) As Boolean
 Public Function PlcSchiumatoAllarmeAccetta ( ) As Boolean
 Public Function PLCSchiumatoAutomatico ( ) As Boolean
 Public Function PLCSchiumatoCircuitoAcqua ( ) As Boolean
 Public Function PLCSchiumatoCircuitoBitume ( ) As Boolean
 Public Function PLCSchiumatoCircuitoBitumeSoft ( ) As Boolean
 Public Function PLCSchiumatoCircuitoRampa ( ) As Boolean
 Public Function PlcSchiumatoConnessione ( connetti As Boolean ) As Boolean
 Public Function PlcSchiumatoConnesso ( ) As Boolean
 Public Function PlcSchiumatoControllaB_Hard_sec ( TempoMin As Long,  TempoMax As Long ) As Double
 Public Function PLCSchiumatoDosaggioBitumeHard ( ) As Boolean
 Public Function PLCSchiumatoDosaggioBitumeSoft ( ) As Boolean
 Public Sub PLCSchiumatoFineScaricoBitume ( )
 Public Function PLCSchiumatoGestionePompaSoft ( ) As Boolean
 Public Function PLCSchiumatoInversionePompaBitume ( ) As Boolean
 Public Function PLCSchiumatoInversionePompaBitumeSoft ( ) As Boolean
 Public Sub PlcSchiumatoInviaParametri ( )
 Public Function PLCSchiumatoLetturaDB ( ) As Boolean
 Public Function PLCSchiumatoManualePompaAcqua ( start As Boolean ) As Boolean
 Public Function PLCSchiumatoManualePompaBitume ( start As Boolean ) As Boolean
 Public Function PLCSchiumatoManualePompaBitumeSoft ( start As Boolean ) As Boolean
 Public Function PLCSchiumatoManualeValvAcqua ( start As Boolean ) As Boolean
 Public Function PLCSchiumatoManualeValvBitume ( start As Boolean ) As Boolean
 Public Function PLCSchiumatoManualeValvBitumeSoft ( start As Boolean ) As Boolean
 Public Function PLCSchiumatoManualeValvImmissBitume ( start As Boolean ) As Boolean
 Public Function PLCSchiumatoManualeValvImmissBitumeSoft ( start As Boolean ) As Boolean
 Public Function PLCSchiumatoManualeValvImmissH20 ( start As Boolean ) As Boolean
 Public Function PLCSchiumatoManualeValvImmissSolvente ( start As Boolean ) As Boolean
 Public Function PLCSchiumatoOnError ( ) As Boolean
 Public Function PLCSchiumatoPercentoBitumeHard ( ) As Boolean
 Public Function PLCSchiumatoPercentoBitumeSoft ( ) As Boolean
 Public Function PLCSchiumatoPesoAggregati ( ByVal Peso As Double ) As Boolean
 Public Function PLCSchiumatoPompaAcqua ( ) As Boolean
 Public Function PLCSchiumatoPompaBitume ( ) As Boolean
 Public Function PLCSchiumatoPompaBitumeSoft ( ) As Boolean
 Public Function PLCSchiumatoRitardoBitumeHard ( ) As Boolean
 Public Function PLCSchiumatoRitardoBitumeSoft ( ) As Boolean
 Public Function PLCSchiumatoScaricoAggregati ( ByVal scarico As Boolean ) As Boolean
 Public Function PLCSchiumatoSetAbilitaCiclo ( )
 Public Function PLCSchiumatoSetAutomaticoCiclo ( automatico As Boolean ) As Boolean
 Public Function PLCSchiumatoSetAutomaticoMotori ( automatico As Boolean ) As Boolean
 Public Function PLCSchiumatoSetBitumeHard ( ) As Boolean
 Public Function PLCSchiumatoSetBitumeSoft ( ) As Boolean
 Public Sub PLCSchiumatoSetFineScaricoBitume ( Fine As Boolean )
 Public Function PLCSchiumatoSetPercentoBitumeHard ( percento As Double ) As Boolean
 Public Function PLCSchiumatoSetPercentoBitumeSoft ( percento As Double ) As Boolean
 Public Function PLCSchiumatoSetRicetta ( setBitumeHard As Double,  setBitumeSoft As Double,  ritardoBitumeHard As Integer,  ritardoBitumeSoft As Integer,  tolleranzaBitumeHard As Double,  tolleranzaBitumeSoft As Double ) As Boolean
 Public Function PLCSchiumatoSetRitardoBitumeHard ( secondi As Integer ) As Boolean
 Public Function PLCSchiumatoSetRitardoBitumeSoft ( secondi As Integer ) As Boolean
 Public Function PLCSchiumatoSetTolleranzaBitumeHard ( Tolleranza As Double ) As Boolean
 Public Function PLCSchiumatoSetTolleranzaBitumeSoft ( Tolleranza As Double ) As Boolean
 Public Function PLCSchiumatoValv3VieBitume_Norm_Soft ( FC_Norm As Boolean,  FC_Soft As Boolean )
 Public Function PLCSchiumatoValvAcqua ( ) As Boolean
 Public Function PLCSchiumatoValvBitume ( ) As Boolean
 Public Function PLCSchiumatoValvBitumeSoft ( ) As Boolean
 Public Function PLCSchiumatoValvImmissAcqua ( ) As Boolean
 Public Function PLCSchiumatoValvImmissBitume ( ) As Boolean
 Public Function PLCSchiumatoValvImmissBitumeSoft ( ) As Boolean
 Public Function PLCSchiumatoValvImmissSolvente ( ) As Boolean
 Public Function PLCSchiumatoVersoPompaBitume ( ) As Boolean
 Public Function PLCSchiumatoVersoPompaBitumeSoft ( ) As Boolean
Private:


Constants:
 Private Const SEZIONE As String = "Schiumato" 
Properties:
 Private DosaggioInCorsoBitume As Boolean
 Private DosaggioInCorsoBSoft As Boolean
 Private FineScaricoBitume As Boolean 
Methods:
 Private Sub PlcSchiumatoColoraPulsante ( )
 Private Sub PLCSchiumatoTempoTrascorsoRitardoBitumeHard ( )
Documentation:

Module "ParaTabSilo"

Public:


Methods:
 Public Sub ParaTabSilo_Apply ( )
 Public Function ParaTabSilo_ReadFile ( ) As Boolean
 Public Sub ReadPositioneSiloFromXml ( )
 Public Sub WritePositioneSiloToXml ( )
Private:


Constants:
 Private Const FileSili As String = "Sili.ini"
 Private Const SEZIONE As String = "Sili"
Documentation:

Module "ParaTabTrend"

Public:


Methods:
 Public Sub ParaTabTrend_Apply ( )
 Public Function ParaTabTrend_ReadFile ( ) As Boolean
Private:


Constants:
 Private Const SEZIONE As String = "Trend"
Documentation:

Module "ParaTabVarie"

Public:


Methods:
 Public Sub ParaTabVarie_Apply ( )
 Public Function ParaTabVarie_ReadFile ( ) As Boolean
Private:


Constants:
 Private Const SEZIONE_PLUS As String = "RiscalaturaValori"
 Private Const SEZIONE_PLUS1 As String = "CorrezioneMisure"
Documentation:

Module "Registro"

Public:


Constants:
 Public Const HKEY_LOCAL_MACHINE As Long = &H80000002 
Methods:
 Public Function RegistroApri ( path As String ) As Long
 Public Function RegistroChiudi ( hKey As Long ) As Boolean
 Public Function RegistroCrea ( path As String ) As Long
 Public Function RegistroLeggiNumero ( hKey As Long,  chiave As String ) As Long
 Public Function RegistroLeggiStringa ( hKey As Long,  chiave As String ) As String
 Public Function RegistroScriviNumero ( hKey As Long,  chiave As String,  valore As Long ) As Boolean
 Public Function RegistroScriviStringa ( hKey As Long,  chiave As String,  valore As String ) As Boolean
Private:


Constants:
 Private Const KEY_ALL_ACCESS As Long = ( ( STANDARD_RIGHTS_ALL Or KEY_QUERY_VALUE Or KEY_SET_VALUE Or KEY_CREATE_SUB_KEY Or KEY_ENUMERATE_SUB_KEYS Or KEY_NOTIFY Or KEY_CREATE_LINK )
 Private Const KEY_CREATE_LINK As Long = &H20
 Private Const KEY_CREATE_SUB_KEY As Long = &H4
 Private Const KEY_ENUMERATE_SUB_KEYS As Long = &H8
 Private Const KEY_NOTIFY As Long = &H10
 Private Const KEY_QUERY_VALUE As Long = &H1
 Private Const KEY_SET_VALUE As Long = &H2
 Private Const REG_CREATED_NEW_KEY = &H1
 Private Const REG_DWORD As Long = 4
 Private Const REG_OPTION_NON_VOLATILE As Long = 0
 Private Const REG_SZ As Long = 1
 Private Const STANDARD_RIGHTS_ALL As Long = &H1F0000
 Private Const SYNCHRONIZE As Long = &H100000 
Declarations:
 Private Declare Function RegCloseKey Lib "ADVAPI32.dll" ( ByVal hKey As Long ) As Long
 Private Declare Function RegCreateKeyEx Lib "ADVAPI32.dll" Alias "RegCreateKeyExA" ( ByVal hKey As Long,  ByVal lpSubKey As String,  ByVal Reserved As Long,  ByVal lpClass As String,  ByVal dwOptions As Long,  ByVal SamDesired As Long,  lpSecurityAttributes As Any,  phkResult As Long,  lpdwDisposition As Long ) As Long
 Private Declare Function RegOpenKeyEx Lib "ADVAPI32.dll" Alias "RegOpenKeyExA" ( ByVal hKey As Long,  ByVal lpSubKey As String,  ByVal Reserved As Long,  ByVal SamDesired As Long,  phkResult As Long ) As Long
 Private Declare Function RegQueryValueEx Lib "ADVAPI32.dll" Alias "RegQueryValueExA" ( ByVal hKey As Long,  ByVal lpValueName As String,  ByVal lpReserved As Long,  lpType As Long,  ByVal lpData As String,  lpcbData As Long ) As Long
 Private Declare Function RegQueryValueExNum Lib "ADVAPI32.dll" Alias "RegQueryValueExA" ( ByVal hKey As Long,  ByVal lpValueName As String,  ByVal lpReserved As Long,  lpType As Long,  lpData As Any,  lpcbData As Long ) As Long
 Private Declare Function RegSetValueEx Lib "ADVAPI32.dll" Alias "RegSetValueExA" ( ByVal hKey As Long,  ByVal lpValueName As String,  ByVal Reserved As Long,  ByVal dwType As Long,  ByVal lpData As String,  ByVal cbData As Long ) As Long
 Private Declare Function RegSetValueExNum Lib "ADVAPI32.dll" Alias "RegSetValueExA" ( ByVal hKey As Long,  ByVal lpValueName As String,  ByVal Reserved As Long,  ByVal dwType As Long,  lpData As Any,  ByVal cbData As Long ) As Long
Documentation:

Module "Security"

Public:

Private:

Documentation:

Module "Stampante"

Public:


Types:
 Public Type DOCINFO 
Properties:
 Dim BUF13BINARY As String
 Dim buffer ( ) As Long
 Dim CHAR As String
 Dim GETPRINTER As Long
 Public lhPrinter As Long
 Dim M As Integer
 Dim n As Integer
 Dim pbSizeNeeded As Long
 Dim PRINTERFOUND As Long
 Dim PRINTERINFO As PRINTER_INFO_2
 Public PRINTERREADY As Integer
 Dim prnPrinter As Printer
 Public UltimoBatchPrinter As Boolean 
Methods:
 Public Function GetDefaultPrinter ( ) As Printer
 Public Function IsPrinterReady ( ByRef PrinterName As String ) As Boolean
 Public Function StringFromPointer ( lpString As Long,  lMaxLength As Long ) As String 
Declarations:
 Public Declare Function ClosePrinter Lib "winspool.drv" ( ByVal hPrinter As Long ) As Long
 Public Declare Sub CopyMemory Lib "Kernel32" Alias "RtlMoveMemory" ( Destination As Any,  Source As Any,  ByVal Length As Long )
 Public Declare Function EndDocPrinter Lib "winspool.drv" ( ByVal hPrinter As Long ) As Long
 Public Declare Function EndPagePrinter Lib "winspool.drv" ( ByVal hPrinter As Long ) As Long
 Public Declare Function GetPrinterApi Lib "winspool.drv" Alias "GetPrinterA" ( ByVal hPrinter As Long,  ByVal Level As Long,  buffer As Long,  ByVal pbSize As Long,  pbSizeNeeded As Long ) As Long
 Public Declare Function GetProfileString Lib "kernel32.dll" Alias "GetProfileStringA" ( ByVal lpAppName As String,  ByVal lpKeyName As String,  ByVal lpDefault As String,  ByVal lpReturnedString As String,  ByVal nSize As Long ) As Long
 Public Declare Function OpenPrinter Lib "winspool.drv" Alias "OpenPrinterW" ( ByVal pPrinterName As Long,  ByRef phPrinter As Long,  Optional ByVal pDefault As Long ) As Long
 Public Declare Function StartDocPrinter Lib "winspool.drv" Alias "StartDocPrinterA" ( ByVal hPrinter As Long,  ByVal Level As Long,  pDocInfo As DOCINFO ) As Long
 Public Declare Function StartPagePrinter Lib "winspool.drv" ( ByVal hPrinter As Long ) As Long
 Public Declare Function WritePrinter Lib "winspool.drv" ( ByVal hPrinter As Long,  pBuf As Any,  ByVal cdBuf As Long,  pcWritten As Long ) As Long
Private:


Types:
 Private Type PRINTER_INFO_2
Documentation:

Module "Stampe"

Public:


Properties:
 Public InclusioneStampaOgniDosaggio As Boolean
 Public separatorPrinterString As String
 Public StampanteContinua As Printer
 Public StampanteDefault As Printer
 Public StampaOgniDosaggioGiorno As String
 Public StampaOgniDosaggioNomeStampante As String
 Public StampaOgniDosaggioNumeroColonne As Integer
 Public StampaOgniDosaggioRicetta As String 
Methods:
 Public Sub StampaOgniDosaggio ( ByRef rstStoricoImpasto As adodb. Recordset )
 Public Sub StampaOgniDosaggioEnd ( )
 Public Sub StampaOgniDosaggioInviaStampa ( nomedoc As String,  stingastampa As String )
Private:


Methods:
 Private Sub StampaOgniDosaggioComponiRiga ( ByRef Contatore As Integer,  ByRef caption As String,  captionValue As String,  ByRef body As String,  bodyValue As String,  Caratteri As Integer,  Optional last As Boolean )
 Private Function StampaOgniDosaggioFormatta ( Contatore As Integer,  valore As String,  Caratteri As Integer,  last As Boolean ) As String
 Private Sub StampaOgniDosaggioNuovo ( ByRef rstStoricoImpasto As adodb. Recordset )
 Private Sub StampaOgniDosaggioStampa ( ricetta As String,  giorno As String,  caption As String,  ByVal separator As String,  Riga As String )
Documentation:

Class "XmlJobs"

Public:


Methods:
 Public Function GetValue ( ByVal Section As String,  ByVal paramCode As String ) As Variant
 Public Function ParameterExists ( ByVal Section As String,  ByVal paramCode As String ) As Boolean
 Public Function ParameterGetValue ( ByVal paramCode As String,  ByVal attribCode ) As Variant
 Public Function Reload ( )
 Public Function SectionExists ( ByVal Section As String ) As Boolean
Private:


Properties:
 Private m_xmlDocName As String
 Private xmlDoc As New MSXML2. DOMDocument60 
Methods:
 Private Sub Class_Initialize ( )
 Private Sub Class_Terminate ( )
 Private Function GetAttribute ( ByRef parameterNode As IXMLDOMNode,  ByVal Code As String ) As IXMLDOMAttribute
 Private Function SelectParameterSection ( ByVal paramSection As String ) As IXMLDOMNode
Documentation:

Class "XmlManager"


****************************************************************************** SelectParameterSection(ByVal paramSection As String, ByVal paramCode As String) As IXMLDOMNode Restituisce il nodo XML relativo al parametro paramCode della sezione paramSection PARAMETRI: - paramSection: sezione di appartenenza del parametro - paramCode: codice del parametro VALORE DI RITORNO - IXMLDOMNode se trovato, Nothing altrimenti ****************************************************************************** Private Function SelectParameterSection(ByVal paramSection As String, ByVal paramCode As String) As IXMLDOMNode Set SelectParameterSection = xmlDoc.SelectSingleNode("//Section[@Code=" & paramSection & "]/" & paramCode) End Function
Public:


Methods:
 Public Function GetValue ( ByVal Section As String,  ByVal Paragraph As String,  ByVal SubParagraph As String,  ByVal paramCode As String ) As String
 Public Function ParameterExists ( ByVal Section As String,  ByVal Paragraph As String,  ByVal SubParagraph As String,  ByVal Param As String ) As Boolean
 Public Function Reload ( )
 Public Function SetValue ( ByVal Section As String,  ByVal Paragraph As String,  ByVal SubParagraph As String,  ByVal paramCode As String,  ByVal Value As Variant ) As Boolean
Private:


Properties:
 Private m_xmlFileName As String
 Private xmlDoc As New MSXML2. DOMDocument60 
Methods:
 Private Sub Class_Initialize ( )
 Private Sub Class_Terminate ( )
 Private Function GetAttribute ( ByRef parameterNode As IXMLDOMNode,  ByVal Code As String ) As IXMLDOMAttribute
 Private Function SelectParameterParagraph ( ByVal paramSection As String,  ByVal paramParagraph As String,  ByVal paramSubParagraph As String,  ByVal paramCode As String ) As IXMLDOMNode
Documentation:

 Public Function GetValue ( ByVal Section As String,  ByVal Paragraph As String,  ByVal SubParagraph As String,  ByVal paramCode As String ) As String
Public Function SectionExists(ByVal Section As String) As Boolean SectionExists = Not (xmlDoc.SelectSingleNode("//Section[@Code=" & Section & "]") Is Nothing) End Function

Public Function ParameterGetValue(ByVal Section As String, ByVal paramCode As String, ByVal attribCode) As Variant Dim xmlNode As IXMLDOMNode Dim xmlAttrib As IXMLDOMAttribute

Set xmlNode = SelectParameterSection(Section, paramCode)

per XML strutturato ad attributi Set xmlAttrib = GetAttribute(xmlNode, attribCode) If (xmlAttrib Is Nothing) Then LogInserisci True, "XmlManager.ParameterGetValue", "xmlAttrib is Nothing" Exit Function End If

ParameterGetValue = xmlAttrib.text

End Function

Public Function ParameterSetValue(ByVal Section As String, ByVal Code As String, ByVal Value As Variant) Dim xmlNode As IXMLDOMNode Dim xmlAttrib As IXMLDOMAttribute

Set xmlNode = SelectParameterSection(Section, Code)

per XML strutturato ad attributi Set xmlAttrib = GetAttribute(xmlNode, "Value") If (xmlAttrib Is Nothing) Then LogInserisci True, "XmlManager.ParameterSetValue", "xmlAttrib is Nothing" Exit Function End If

xmlAttrib.text = Value

Riscrive il file XML: TODO si puó pensare di ignorare la invocare un metodo Save xmlDoc.Save (m_xmlFileName) End Function

Section - -ERROR: Can not find parameter 'Section'.
'Public Function SectionExists(ByVal Section As String) As Boolean
'    SectionExists = Not (xmlDoc.SelectSingleNode("//Section[@Code='" & Section & "']") Is Nothing)
'End Function
'
'
'Public Function ParameterGetValue(ByVal Section As String, ByVal paramCode As String, ByVal attribCode) As Variant
'    Dim xmlNode As IXMLDOMNode
'    Dim xmlAttrib As IXMLDOMAttribute
'
'    Set xmlNode = SelectParameterSection(Section, paramCode)
'
'    ' per XML strutturato ad 'attributi'
'    Set xmlAttrib = GetAttribute(xmlNode, attribCode)
'    If (xmlAttrib Is Nothing) Then
'        LogInserisci True, "XmlManager.ParameterGetValue", "xmlAttrib is Nothing"
'        Exit Function
'    End If
'
'    ParameterGetValue = xmlAttrib.text
'
'End Function
'
'Public Function ParameterSetValue(ByVal Section As String, ByVal Code As String, ByVal Value As Variant)
'    Dim xmlNode As IXMLDOMNode
'    Dim xmlAttrib As IXMLDOMAttribute
'
'    Set xmlNode = SelectParameterSection(Section, Code)
'
'    ' per XML strutturato ad 'attributi'
'    Set xmlAttrib = GetAttribute(xmlNode, "Value")
'    If (xmlAttrib Is Nothing) Then
'        LogInserisci True, "XmlManager.ParameterSetValue", "xmlAttrib is Nothing"
'        Exit Function
'    End If
'
'    xmlAttrib.text = Value
'
'    ' Riscrive il file XML: TODO si puó pensare di ignorare la invocare un metodo Save
'    xmlDoc.Save (m_xmlFileName)
'End Function
Paragraph - -ERROR: Can not find parameter 'Paragraph'.
'Public Function SectionExists(ByVal Section As String) As Boolean
'    SectionExists = Not (xmlDoc.SelectSingleNode("//Section[@Code='" & Section & "']") Is Nothing)
'End Function
'
'
'Public Function ParameterGetValue(ByVal Section As String, ByVal paramCode As String, ByVal attribCode) As Variant
'    Dim xmlNode As IXMLDOMNode
'    Dim xmlAttrib As IXMLDOMAttribute
'
'    Set xmlNode = SelectParameterSection(Section, paramCode)
'
'    ' per XML strutturato ad 'attributi'
'    Set xmlAttrib = GetAttribute(xmlNode, attribCode)
'    If (xmlAttrib Is Nothing) Then
'        LogInserisci True, "XmlManager.ParameterGetValue", "xmlAttrib is Nothing"
'        Exit Function
'    End If
'
'    ParameterGetValue = xmlAttrib.text
'
'End Function
'
'Public Function ParameterSetValue(ByVal Section As String, ByVal Code As String, ByVal Value As Variant)
'    Dim xmlNode As IXMLDOMNode
'    Dim xmlAttrib As IXMLDOMAttribute
'
'    Set xmlNode = SelectParameterSection(Section, Code)
'
'    ' per XML strutturato ad 'attributi'
'    Set xmlAttrib = GetAttribute(xmlNode, "Value")
'    If (xmlAttrib Is Nothing) Then
'        LogInserisci True, "XmlManager.ParameterSetValue", "xmlAttrib is Nothing"
'        Exit Function
'    End If
'
'    xmlAttrib.text = Value
'
'    ' Riscrive il file XML: TODO si puó pensare di ignorare la invocare un metodo Save
'    xmlDoc.Save (m_xmlFileName)
'End Function
SubParagraph - -ERROR: Can not find parameter 'SubParagraph'.
'Public Function SectionExists(ByVal Section As String) As Boolean
'    SectionExists = Not (xmlDoc.SelectSingleNode("//Section[@Code='" & Section & "']") Is Nothing)
'End Function
'
'
'Public Function ParameterGetValue(ByVal Section As String, ByVal paramCode As String, ByVal attribCode) As Variant
'    Dim xmlNode As IXMLDOMNode
'    Dim xmlAttrib As IXMLDOMAttribute
'
'    Set xmlNode = SelectParameterSection(Section, paramCode)
'
'    ' per XML strutturato ad 'attributi'
'    Set xmlAttrib = GetAttribute(xmlNode, attribCode)
'    If (xmlAttrib Is Nothing) Then
'        LogInserisci True, "XmlManager.ParameterGetValue", "xmlAttrib is Nothing"
'        Exit Function
'    End If
'
'    ParameterGetValue = xmlAttrib.text
'
'End Function
'
'Public Function ParameterSetValue(ByVal Section As String, ByVal Code As String, ByVal Value As Variant)
'    Dim xmlNode As IXMLDOMNode
'    Dim xmlAttrib As IXMLDOMAttribute
'
'    Set xmlNode = SelectParameterSection(Section, Code)
'
'    ' per XML strutturato ad 'attributi'
'    Set xmlAttrib = GetAttribute(xmlNode, "Value")
'    If (xmlAttrib Is Nothing) Then
'        LogInserisci True, "XmlManager.ParameterSetValue", "xmlAttrib is Nothing"
'        Exit Function
'    End If
'
'    xmlAttrib.text = Value
'
'    ' Riscrive il file XML: TODO si puó pensare di ignorare la invocare un metodo Save
'    xmlDoc.Save (m_xmlFileName)
'End Function
paramCode - -ERROR: Can not find parameter 'paramCode'.
'Public Function SectionExists(ByVal Section As String) As Boolean
'    SectionExists = Not (xmlDoc.SelectSingleNode("//Section[@Code='" & Section & "']") Is Nothing)
'End Function
'
'
'Public Function ParameterGetValue(ByVal Section As String, ByVal paramCode As String, ByVal attribCode) As Variant
'    Dim xmlNode As IXMLDOMNode
'    Dim xmlAttrib As IXMLDOMAttribute
'
'    Set xmlNode = SelectParameterSection(Section, paramCode)
'
'    ' per XML strutturato ad 'attributi'
'    Set xmlAttrib = GetAttribute(xmlNode, attribCode)
'    If (xmlAttrib Is Nothing) Then
'        LogInserisci True, "XmlManager.ParameterGetValue", "xmlAttrib is Nothing"
'        Exit Function
'    End If
'
'    ParameterGetValue = xmlAttrib.text
'
'End Function
'
'Public Function ParameterSetValue(ByVal Section As String, ByVal Code As String, ByVal Value As Variant)
'    Dim xmlNode As IXMLDOMNode
'    Dim xmlAttrib As IXMLDOMAttribute
'
'    Set xmlNode = SelectParameterSection(Section, Code)
'
'    ' per XML strutturato ad 'attributi'
'    Set xmlAttrib = GetAttribute(xmlNode, "Value")
'    If (xmlAttrib Is Nothing) Then
'        LogInserisci True, "XmlManager.ParameterSetValue", "xmlAttrib is Nothing"
'        Exit Function
'    End If
'
'    xmlAttrib.text = Value
'
'    ' Riscrive il file XML: TODO si puó pensare di ignorare la invocare un metodo Save
'    xmlDoc.Save (m_xmlFileName)
'End Function
Returns String -


module| index| back| top
 Public Function ParameterExists ( ByVal Section As String,  ByVal Paragraph As String,  ByVal SubParagraph As String,  ByVal Param As String ) As Boolean
Public Function ParameterExists(ByVal Section As String, ByVal paramCode As String) As Boolean ParameterExists = (Not SelectParameterSection(Section, paramCode) Is Nothing) End Function

Section - -ERROR: Can not find parameter 'Section'.
'Public Function ParameterExists(ByVal Section As String, ByVal paramCode As String) As Boolean
'    ParameterExists = (Not SelectParameterSection(Section, paramCode) Is Nothing)
'End Function
Paragraph - -ERROR: Can not find parameter 'Paragraph'.
'Public Function ParameterExists(ByVal Section As String, ByVal paramCode As String) As Boolean
'    ParameterExists = (Not SelectParameterSection(Section, paramCode) Is Nothing)
'End Function
SubParagraph - -ERROR: Can not find parameter 'SubParagraph'.
'Public Function ParameterExists(ByVal Section As String, ByVal paramCode As String) As Boolean
'    ParameterExists = (Not SelectParameterSection(Section, paramCode) Is Nothing)
'End Function
Param - -ERROR: Can not find parameter 'Param'.
'Public Function ParameterExists(ByVal Section As String, ByVal paramCode As String) As Boolean
'    ParameterExists = (Not SelectParameterSection(Section, paramCode) Is Nothing)
'End Function
Returns Boolean -




Build on lunedì 5 giugno 2017 
